<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>L0kiTown v1.0</title>
      <link href="/2020/05/13/L0kiTown-v1.0/"/>
      <url>/2020/05/13/L0kiTown-v1.0/</url>
      
        <content type="html"><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>I’ve always wanted to integrate a learning center, and finally managed to do it. The 1.0 version includes a penetration testing lab, penetration testing tools, a penetration testing target range, a network disk, and a resource sharing center. You can access it <a href="https://demo.l0ki.net/">here</a>.</p><h2 id="User-Guide"><a href="#User-Guide" class="headerlink" title="User Guide"></a>User Guide</h2><h3 id="KODBOX"><a href="#KODBOX" class="headerlink" title="KODBOX"></a>KODBOX</h3><p>The KODBOX module is for network disk and document collaboration, etc., and registration is required.<br><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200602205103699.png" alt="image-20200602205103699"></p><h3 id="Pentest-Lab"><a href="#Pentest-Lab" class="headerlink" title="Pentest Lab"></a>Pentest Lab</h3><p>The Pentest Lab module is for penetration testing labs, which is not open to the public for now and is only used for my personal learning.</p><h3 id="Share-Center"><a href="#Share-Center" class="headerlink" title="Share Center"></a>Share Center</h3><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200602205213381.png" alt="image-20200602205213381"><br>The Share Center module is a sharing center, which includes a penetration testing target range, penetration testing tools, and a resource sharing center.</p><h4 id="Pentest-Ranges"><a href="#Pentest-Ranges" class="headerlink" title="Pentest Ranges"></a>Pentest Ranges</h4><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200604143044397.png" alt="image-20200604143044397"><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200604143107832.png" alt="image-20200604143107832"><br>This is a penetration testing target range. This module integrates all usable target ranges and is for learning purposes only.</p><h4 id="Pentest-Tools"><a href="#Pentest-Tools" class="headerlink" title="Pentest Tools"></a>Pentest Tools</h4><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200604143117977.png" alt="image-20200604143117977"><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200604143135098.png" alt="image-20200604143135098"><br>This is a penetration testing toolbox. This module integrates exploitable penetration testing tools. Among them, PocBox is produced by the MIST security team and can be used in conjunction with the DoraBox target range.</p><h4 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h4><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200604143157969.png" alt="image-20200604143157969"><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200604143210690.png" alt="image-20200604143210690"><br>This is a resource center. This module integrates downloadable PDF resources for learning, such as mini-program development, blue team system construction, etc.</p><h3 id="Contact-Me"><a href="#Contact-Me" class="headerlink" title="Contact Me"></a>Contact Me</h3><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200602205841633.png" alt="image-20200602205841633"><br>This module is my blog and can be used for learning and reference.</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>L0kiTown was initially intended for my personal use. If it helps others in their learning, I will continue to upgrade and optimize it. If you have any suggestions, please feel free to leave a comment.</p><h3 id="To-be-developed"><a href="#To-be-developed" class="headerlink" title="To be developed"></a>To be developed</h3><ul><li>Blog wiki, <a href="https://www.mi1k7ea.com/tags/">reference</a></li><li>Toolbox production</li><li>Introduction of local penetration tool jump links</li><li>ifream online code writing</li><li>Markdown parsing code</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Notes on Gathering Information [1]</title>
      <link href="/2019/09/23/Notes-on-Gathering-Information/"/>
      <url>/2019/09/23/Notes-on-Gathering-Information/</url>
      
        <content type="html"><![CDATA[<h1 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h1><ul><li><p>HTTrack:网站克隆</p></li><li><p>Google指令——利用谷歌搜索实践</p></li><li><p>The Harvester:挖掘并利用邮箱地址</p></li><li><p>Whois</p></li><li><p>Netcraft</p></li><li><p>host 工具</p></li><li><p>从DNS中提取信息</p></li><li><p>从电子邮件服务器中提取信息</p></li><li><p>MetaGooFil</p></li><li><p>社会工程学</p></li><li><p>筛选提炼信息：找到可攻击目标</p></li></ul><h1 id="对信息收集的认识误区"><a href="#对信息收集的认识误区" class="headerlink" title="对信息收集的认识误区"></a>对信息收集的认识误区</h1><p>信息收集是渗透测试的中最不受重视的一个环节</p><blockquote><p>这样的认识很明显是打错特所的，正相反，这是最重要的一步，但也是最容易被忽略的一步，那么它的影响程度到底有多大呢？<br>可以毫不夸张的说，在收集目标信息上所花费的时间越多，后续阶段的成功率也就越高。</p></blockquote><h1 id="信息收集浅谈"><a href="#信息收集浅谈" class="headerlink" title="信息收集浅谈"></a>信息收集浅谈</h1><p>信息收集主要分为主动和被动</p><p>主动收集：与目标系统的直接交互，目标系统可能会记录下我们的IP地址及活动</p><p>被动收集：利用Google获取海量信息，不会与目标交互，不会被记录活动</p><p>信息收集的目的在于尽可能多的收集与目标相关的信息。并且收集信息的时候要尽可能将数据集中保存起来。</p><h3 id="HTTrack"><a href="#HTTrack" class="headerlink" title="HTTrack"></a>HTTrack</h3><p>当浏览或者探测某个网站的时间越多，那么我们的活动就越有可能被跟踪(哪怕只是随意的浏览网站)，只要是属于目标的资源，任何时候与之交互都有可能留下痕迹。</p><p>利用HTTrack我们可以从某个网站的本地副本中提取额外或者隐藏的信息<br>HTTrack可以将整个网页逐页下载下来，通过它可以建立完全的脱机副本。<br>Kali命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install webhttrack</span><br></pre></td></tr></table></figure><h3 id="关注点"><a href="#关注点" class="headerlink" title="关注点"></a>关注点</h3><p>物理地址和位置、电话号码、电子邮箱地址、运营时间、商业关系、员工姓名、与社会化媒体的联系、以及其他公开的花絮趣闻等等</p><p>综上所述，我们要彻查目标网站，对目标有一个全面的了解：是什么(这是一家什么样的公司)、做什么(具体做什么业务)、公司设在哪里。</p><p>在有了这些基本信息之后，我们可以进入被动侦察(即，被动收集)阶段。</p><h3 id="被动侦察"><a href="#被动侦察" class="headerlink" title="被动侦察"></a>被动侦察</h3><p>首先要做的事利用各大搜索引擎对目标进行地毯式的搜索</p><p>不过 仅仅利用好谷歌，我们就可以完成整个渗透测试工作<br>(推荐看Google Hacking  作者:Jonny)</p><p>不得不提一点，在我们被动侦擦过程中，如果我们点击搜索结果的任何一条链接，都会与目标建立系统的联系，也就回到了主动侦察的模式。。。。。</p><h3 id="Google指令——搜索实践"><a href="#Google指令——搜索实践" class="headerlink" title="Google指令——搜索实践"></a>Google指令——搜索实践</h3><p>指令格式：<br>1)你想要用的指令<br>2)半角冒号<br>3)指令中要用到的具体内容</p><p>Eg:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site:domain term(搜索某网站我们想知道的信息)</span><br></pre></td></tr></table></figure><p>allintitle:网页标题必须包含所有的关键字才会出现在搜索结果里<br>intitle:只需包含任意一个关键字即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">allintitle:index of(查看web服务器上的所有可用的索引目录列表)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inurl:admin(这条命令用于发现目标网站的管理或者设者页面)</span><br></pre></td></tr></table></figure><blockquote><p>使用Google快照会减少在目标服务器上留下痕迹，而且有机会浏览到原网站已移除的网页和文件。只要是谷歌爬虫抓取过的页面，都会在网页快照中保存一个精简的副本。</p></blockquote><p>cache:让谷歌只显示网页快照里的信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cache:domain</span><br></pre></td></tr></table></figure><p>filetype:搜索特定文件的扩展名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filetype:pdf</span><br></pre></td></tr></table></figure><p>命令结合使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site:domain filetype:xxx(搜索某网站所有xxx格式的文件)</span><br></pre></td></tr></table></figure><h3 id="利用社交资源"><a href="#利用社交资源" class="headerlink" title="利用社交资源"></a>利用社交资源</h3><p>当我们彻查完目标网页，并借助谷歌服务我们之后，其他社交媒体也会发挥作用。</p><p>一些论坛，或者新闻中心等等可能会出现关于目标的言论，如技术问题。</p><p>简言之，公共论坛算是分享信息并寻求技术支持的宝地。</p><h3 id="The-Harvester"><a href="#The-Harvester" class="headerlink" title="The Harvester"></a>The Harvester</h3><p>….</p>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kali Updating Sources</title>
      <link href="/2019/09/09/Kali-Updating-Sources/"/>
      <url>/2019/09/09/Kali-Updating-Sources/</url>
      
        <content type="html"><![CDATA[<p>kali更新源：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/apt/sources.list</span><br><span class="line"></span><br><span class="line"># kali官方源</span><br><span class="line">deb http://http.kali.org/ moto main non-free contrib </span><br><span class="line">deb-src http://http.kali.org/ moto main non-free contrib</span><br><span class="line"></span><br><span class="line">deb http://security.kali.org/ moto/updates main contrib non-free </span><br><span class="line">deb-src http://security.kali.org/ moto/updates main contrib non-free</span><br><span class="line"></span><br><span class="line">#中科大kali源 </span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali kali main non-free contrib </span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/kali kali main non-free contrib </span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali-security kali/updates main contrib non-free</span><br><span class="line"></span><br><span class="line">#新加坡kali源 </span><br><span class="line">deb http://mirror.nus.edu.sg/kali/kali/ kali main non-free contrib </span><br><span class="line">deb-src http://mirror.nus.edu.sg/kali/kali/ kali main non-free contrib </span><br><span class="line">deb http://security.kali.org/kali-security kali/updates main contrib non-free </span><br><span class="line">deb http://mirror.nus.edu.sg/kali/kali-security kali/updates main contrib non-free </span><br><span class="line">deb-src http://mirror.nus.edu.sg/kali/kali-security kali/updates main contrib non-free</span><br><span class="line"></span><br><span class="line">#阿里云kali源 </span><br><span class="line">deb http://mirrors.aliyun.com/kali kali main non-free contrib </span><br><span class="line">deb-src http://mirrors.aliyun.com/kali kali main non-free contrib </span><br><span class="line">deb http://mirrors.aliyun.com/kali-security kali/updates main contrib non-free</span><br><span class="line"></span><br><span class="line">#163 Kali源 </span><br><span class="line">deb http://mirrors.163.com/debian wheezy main non-free contrib </span><br><span class="line">deb-src http://mirrors.163.com/debian wheezy main non-free contrib </span><br><span class="line">deb http://mirrors.163.com/debian wheezy-proposed-updates main non-free contrib </span><br><span class="line">deb-src http://mirrors.163.com/debian wheezy-proposed-updates main non-free contrib </span><br><span class="line">deb-src http://mirrors.163.com/debian-security wheezy/updates main non-free contrib </span><br><span class="line">deb http://mirrors.163.com/debian-security wheezy/updates main non-free contrib </span><br><span class="line">#auto </span><br><span class="line">deb http://http.kali.org/kali kali-rolling main non-free contrib</span><br><span class="line"></span><br><span class="line">#中科大 </span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib </span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br><span class="line"></span><br><span class="line">#浙大 </span><br><span class="line">deb http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free </span><br><span class="line">deb-src http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line"></span><br><span class="line">#东软大学 </span><br><span class="line">deb http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib </span><br><span class="line">deb-src http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib</span><br><span class="line"></span><br><span class="line">#重庆大学 </span><br><span class="line">deb http://http.kali.org/kali kali-rolling main non-free contrib </span><br><span class="line">deb-src http://http.kali.org/kali kali-rolling main non-free contrib</span><br><span class="line"></span><br><span class="line">#官方源 </span><br><span class="line">#deb http://http.kali.org/kali kali-rolling main non-free contrib </span><br><span class="line">#deb-src http://http.kali.org/kali kali-rolling main non-free contrib</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">推荐：</span><br><span class="line"></span><br><span class="line"># kali官方源</span><br><span class="line">deb http://http.kali.org/ kali-rolling main non-free contrib </span><br><span class="line">deb-src http://http.kali.org/ kali-rolling main non-free contrib</span><br><span class="line"></span><br><span class="line">#中科大源</span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib </span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br></pre></td></tr></table></figure><p>更新安装软件列表和软件;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get update &amp; apt-get upgrade</span><br></pre></td></tr></table></figure><p>升级软件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get dist-upgrade</span><br></pre></td></tr></table></figure><p>清理：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get clean</span><br></pre></td></tr></table></figure><p>重启</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Learning Code Auditing [1]</title>
      <link href="/2019/07/25/Learning-Code-Auditing-1/"/>
      <url>/2019/07/25/Learning-Code-Auditing-1/</url>
      
        <content type="html"><![CDATA[<h1 id="一、常见的代码审计工具"><a href="#一、常见的代码审计工具" class="headerlink" title="一、常见的代码审计工具"></a>一、常见的代码审计工具</h1><p>1、Fortify SCA</p><p>Fortify SCA是一个静态的、白盒的软件源代码安全测试工具，它通过内置的五大主要分析引擎：数据流、语义、结</p><p>2、Checkmarx CxSuite</p><p>Checkmarx CxSuite的扫描结果可以以静态报表形式展示，也可以通过可以对软件安全漏洞和质量缺陷在代码的运</p><p>3、360代码卫士</p><p>360代码卫士是360企业安全集团基于多年源代码安全实践经验推出的新一代源代码安全检测解决方案，包括源代码</p><p>4、PHP代码审计工具——RIPS</p><p>参考：<a href="https://www.jianshu.com/p/cd1cb66e4d7d">https://www.jianshu.com/p/cd1cb66e4d7d</a></p><p>5、SEAY代码审计（常用）</p><p>参考：<a href="https://www.oschina.net/p/seay">https://www.oschina.net/p/seay</a></p><p>6、SONARQUBE</p><p>参考：<a href="https://www.cnblogs.com/qiumingcheng/p/7253917.html">https://www.cnblogs.com/qiumingcheng/p/7253917.html</a></p><p>7、COBRA</p><p>参考：<a href="https://zhuanlan.zhihu.com/p/32363880">https://zhuanlan.zhihu.com/p/32363880</a></p><p>8、KIWI</p><p>参考：<a href="https://github.com/alpha1e0/kiwi">https://github.com/alpha1e0/kiwi</a></p><h1 id="二、代码审计中常见的危险函数和字符串"><a href="#二、代码审计中常见的危险函数和字符串" class="headerlink" title="二、代码审计中常见的危险函数和字符串"></a>二、代码审计中常见的危险函数和字符串</h1><h2 id="0x01-整体"><a href="#0x01-整体" class="headerlink" title="0x01 整体"></a>0x01 整体</h2><p>学习代码审计的目标是能够独立完成对一个CMS的代码安全监测。其通用的思路有：</p><p>● 通读全文代码，从功能函数代码开始阅读，例如include文件夹下的common_fun.php，或者有类似关键字的文</p><p>● 看配置文件，带有config关键字的文件，找到mysql.class.php文件的connect()函数，查看在数据库连接时是</p><p>● 继续跟读首页文件,index.php,了解程序运作时调用了哪些函数和文件</p><p>以index.php文件作为标线，一层一层去扩展阅读所包含的文件，了解其功能，之后进入其功能文件夹的首页</p><h2 id="0x02-各种洞洞"><a href="#0x02-各种洞洞" class="headerlink" title="0x02 各种洞洞"></a>0x02 各种洞洞</h2><p>A.文件操作漏洞</p><p>● 能不用文件名参数就不用 尽量不要让用户可控</p><p>● 平行用户的权限 管理员的权限 操作权限</p><p>● 禁止传入参数类似于这种 .. ,&#x2F;,\ 检查传入的参数,做出限制,停止程序往下执行</p><p>1.文件包含漏洞：</p><p>(1) 本地文件包含：</p><p>● 一般存在于模块加载，模板加载，cache调用</p><p>● 包括函数：include()&#x2F;include_once()，require()&#x2F;require_once()寻找可控变量</p><p>(2) 远程文件包含：</p><p>● 前提条件：allow_url_include &#x3D; on</p><p>● 出现频率不如本地包含</p><p>(3) 文件包含截断：</p><p>● %00截断(php版本小于5.3)</p><p>● 问号截断(问号后面相当于请求的参数，伪截断)</p><p>● 英文(.) 反斜杠(&#x2F;) 截断</p><p>2.文件读取(下载)漏洞：</p><p>搜索关键函数:</p><blockquote><p>file_get_contents(),highlight_file(),fopen(),read file(),fread(),fgetss(), fgets(),parse_ini_file(),show_source(),file()等</p></blockquote><p>3.文件上传漏洞：</p><p>搜索关键函数:</p><p>move_uploaded_file() 接着看调用这个函数的代码是否存在为限制上传格式或者可以绕过。</p><p>(1) 未过滤或本地过滤：服务器端未过滤，直接上传PHP格式的文件即可利用。</p><p>(2) 黑名单扩展名过滤：</p><p>● 限制不够全面：IIS默认支持解析.asp,.cdx, .asa,.cer等。</p><p>● 扩展名可绕过：</p><p>不被允许的文件格式.php，但是我们可以上传文件名为1.php(注意后面有一个空格)</p><p>(3) 文件头 content-type验证绕过：</p><p>● getimagesize()函数：验证文件头只要为GIF89a，就会返回真。</p><p>● 限制$_FILES[“file”][“type”]的值 就是人为限制content-type为可控变量。</p><p>(4) 防范：</p><p>● 使用in_array()或 利用三等于&#x3D;&#x3D;&#x3D;对比扩展名。</p><p>● 保存上传文件是重命名，规则采用时间戳拼接随机数：md5(time() + rand(1,1000))。</p><p>4.文件删除漏洞：</p><p>搜索关键函数：</p><p>● unlink()利用回溯变量的方式</p><p>● 老版本下的session_destroy()，可以删除文件，现已基本被修复。</p><p>Metinfo的任意文件删除漏洞：</p><p>$action &#x3D; delete即可删除.sql的文件，如果文件不是sql直接删除提交的文件名</p><p><a href="http://target.com/recovery.php?&action=delete&filename=../../index.php">http://target.com/recovery.php?&amp;action=delete&amp;filename=../../index.php</a></p><p>B.代码执行漏洞</p><p>1.代码执行函数：</p><p>搜索关键函数：</p><blockquote><p>eval(), assert(), preg_replace(), call_user_func(), call_user_func_array(), arra</p></blockquote><p>(1) preg_replace()函数：</p><blockquote><p>mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit &#x3D; -1 [, int &amp;$count ]] )</p></blockquote><p>当$pattern处存在e修饰符时，$replacement 会被当做php代码执行。</p><p>(2)mixed call_user_func( callable $callbank [ , mixed $parameter [ , mixed $…)：</p><p>第一个参数为回调函数，第二个参数是回调函数的参数</p><p>(3)eval()和assert()：</p><p>当assert()的参数为字符串时 可执行PHP代码</p><p>【区分】：</p><p>eval(“ phpinfo(); “);【√】 eval(“ phpinfo() “);【X】</p><p>assert(“ phpinfo(); “);【√】 assert(“ phpinfo() “);【√】</p><p>2.动态函数执行：</p><p>动态函数后门：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$_GET[&#x27;a&#x27;]($_GET[&#x27;b&#x27;]);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>3.命令执行函数：</p><p>搜索关键函数：</p><blockquote><p>system(), exec(), shell_exec(), passthru() ,pcntl_exec(), popen(),proc_open()</p></blockquote><p>(1) popen和proc_open()：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">popen( &#x27;whoami &gt;&gt; /Users/bingdaojueai/Desktop/1.txt&#x27;, &#x27;r&#x27; ); ?&gt;</span><br></pre></td></tr></table></figure><p>所在路径就会出现一个1.txt 里面的内容为命令执行后的结果</p><p>(2) 反引号命令执行：</p><p>echo whoami; 直接就可以执行命令</p><p>双引号和单引号的区别：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">$a = 1</span><br><span class="line"></span><br><span class="line">echo &quot; $a &quot; output：1</span><br><span class="line"></span><br><span class="line">echo &#x27; $a &#x27; output：$a</span><br></pre></td></tr></table></figure><p>双引号时，可以直接解析变量，造成代码执行漏洞，过狗绕过。</p><p>C.变量覆盖漏洞</p><p>1.函数使用不当：</p><p>● int extract( array &amp;$var_array , int $extract_type &#x3D; EXTR_OVERWRITE , string $prefix &#x3D; null )</p><p>● void parse_str( string $str , array &amp;$arr )</p><p>● bool import_request_variables( string $type , string $prefix )</p><p>2.$$变量覆盖：</p><p>D.逻辑漏洞</p><p>需要思考的问题：</p><p>● 程序是否可以重复安装</p><p>● 修改密码是否存在越权修改其他用户密码</p><p>● 找回密码验证码是否可以暴力破解</p><p>● cookie是否可以预测 验证存在绕过</p><p>1.等于与存在判断绕过：</p><p>(1) in_array(): 比较之前会自动转换类型</p><p>(2)is_numeric():当传入参数为hex时 直接通过并返回true 并且MYSQL可以直接使用hex编码代替字符串明文可以二次注入 并且可能造成XSS漏洞</p><p>(3)双等于&#x3D;&#x3D;和三等于&#x3D;&#x3D;&#x3D;：</p><p>● 双等于会在变量比较时，进行类转换，与in_array()是一样的问题。</p><p>● 三等于是type和value的双重比较，相比之下更加安全。</p><p>2.账户体系中的越权问题：</p><p>● 水平越权：A用户能够以B用户的身份，进行B用户的全部权限操作。前提A用户和B用户拥有相同的权限。</p><p>● 垂直越权：A用户能够以C用户的身份，进行C用户的全部权限操作，前提C用户比A用户拥有更高的权限。</p><p>(1) 未exit&#x2F;return&#x2F;die：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(file_exists(&#x27;install.lock))&#123;</span><br><span class="line"></span><br><span class="line">header(&quot;Location:http://xxx.com&quot;);</span><br><span class="line"></span><br><span class="line">//exit();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo &quot;test&quot;;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>test 依旧会被输出，替换成安装流程，PHP依旧会进行。</p><p>(2) 支付漏洞：</p><p>● 客户端修改单价</p><p>● 客户端修改总价和购买数量</p><p>● 服务端未校验严格</p><p>重复发包利用时间差：</p><p>#!php</p><?phpif (check_money($price)){//Do something//花费几秒$money = $money - $price;}?><p>可能导致漏洞函数： str_replace()</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$a = addslashes($_GET[&#x27;a&#x27;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$b = addslashes($_GET[&#x27;b&#x27;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot;$a&lt;br&gt;$b&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">$c = str_replace($a,&#x27;&#x27;,$b);</span><br><span class="line"></span><br><span class="line">echo trim($c);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>E.会话认证漏洞</p><p>COOKIE验证：没有使用SESSION验证，将信息直接保存在COOKIE中</p><p>a 找到传入sql语句的参数的传递过程 回溯变量到最原始的函数 看它保存在cookie的算法是否可逆<br>b 和MD5比起 sha1更安全 解密sha1的网站更少<br>c 限制一个用户只能同时在一个IP上登录审计代码时，查看登录处代码</p><p>F.二次漏洞</p><p>1.类型：</p><p>● 不是逻辑问题，是可信问题。</p><p>● 业务逻辑复杂度，与二次漏洞触发率 成正比。</p><p>● 购物车 &#x2F; 订单 &#x2F; 引用数据 &#x2F; 文章编辑 &#x2F; 草稿 &#x3D;&#x3D;&gt; SQL注入 &#x2F; XSS</p><p>2.技巧：</p><p>(1) 钻GPC等转义的空子：</p><p>● 不受GPC保护的$_SERVER变量：PHP5以后，$_SERVER取到的header不再受GPC影响，就算开启特殊字符也</p><p>编码问题转换：</p><p>a GBK的宽字节注入：%df ‘ 单引号自动被转义成(%5c)，同时%df与%5c连在一起组合成運字单引号依然</p><p>mb_convert_encoding()：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;/&gt; &lt;?php</span><br><span class="line"></span><br><span class="line">$sql = &quot;WHERE id=&#x27;&quot;.urldecode(&quot;-1%df%5c&#x27; == &quot;).&quot;&#x27;&quot;; print_r(mb_convert_encoding($sql,&quot;UTF-8&quot;,&quot;GBK&quot;)); ?&gt;</span><br></pre></td></tr></table></figure><p>(2)字符串问题：</p><p>● 利用报错，找到敏感信息</p><h2 id="字符串截断："><a href="#字符串截断：" class="headerlink" title="字符串截断："></a>字符串截断：</h2><p>%00空字符截断：【PHP版本小于5.3】</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">include($_GET[&#x27;file&#x27;].&#x27;.php&#x27;);</span><br><span class="line"></span><br><span class="line">//1.php?file=2.txt%00</span><br><span class="line"></span><br><span class="line">//2.txt里面是 &lt;?php phpinfo()?&gt;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="iconv函数字符编码转换截断：【对PHP版本有要求】"><a href="#iconv函数字符编码转换截断：【对PHP版本有要求】" class="headerlink" title="iconv函数字符编码转换截断：【对PHP版本有要求】"></a>iconv函数字符编码转换截断：【对PHP版本有要求】</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">chr(128)—chr(255)可以截断字符</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$a = &#x27;1&#x27;.chr(130).&#x27;2’;</span><br><span class="line"></span><br><span class="line">echo $a.&quot;&lt;br&gt;&quot;; //12</span><br><span class="line"></span><br><span class="line">echo iconv(&quot;UTF-8&quot;, &quot;GBK&quot;, $a); //1</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h2 id="php-输入输出流："><a href="#php-输入输出流：" class="headerlink" title="php:&#x2F;&#x2F; 输入输出流："></a>php:&#x2F;&#x2F; 输入输出流：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">include($_GET[‘file&#x27;]);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>1.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode(内容被base64编码)&#x2F; resource&#x3D;example.txt(远程文件)</p><h2 id="php代码解析标签："><a href="#php代码解析标签：" class="headerlink" title="php代码解析标签："></a>php代码解析标签：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a &lt;script language=&quot;php&quot;&gt;…&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">b &lt;?…?&gt;：php3.0.4版本后可用</span><br><span class="line"></span><br><span class="line">c &lt;%…%&gt;：asp标签，需要asp_tags=on，默认是 oﬀ </span><br></pre></td></tr></table></figure><p>正则表达式：</p><p>a 没有使用^ 和 $ 限定匹配开始位置：</p><p>b 特殊字符未转义：</p><p>报错注入：</p><p>windows findfirstfile<br>利用：<br>若要搜索12345.txt文件，可使用1&lt;&lt;来代替或者12&lt;&lt;，不可以单独使用一个”&lt;</p>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Setting Up an Intranet Server Using Docker</title>
      <link href="/2019/05/14/Setting-Up-an-Intranet-Server-Using-Docker/"/>
      <url>/2019/05/14/Setting-Up-an-Intranet-Server-Using-Docker/</url>
      
        <content type="html"><![CDATA[<h3 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h3><h4 id="几条重要的命令"><a href="#几条重要的命令" class="headerlink" title="几条重要的命令"></a>几条重要的命令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">启动           systemctl start docker</span><br><span class="line">守护进程重启sudo systemctl daemon-reload</span><br><span class="line">列出容器        docker ps </span><br><span class="line">显示所有的容器，包括未运行的  docker ps -a</span><br><span class="line">重启docker服务  systemctl restart  docker</span><br><span class="line">重启docker服务  sudo service docker restart</span><br><span class="line">关闭docker      service docker stop   </span><br><span class="line">关闭docker      systemctl stop docker</span><br></pre></td></tr></table></figure><h3 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h3><h4 id="通过桥接模式，搭建可通过外网访问的内网服务器"><a href="#通过桥接模式，搭建可通过外网访问的内网服务器" class="headerlink" title="通过桥接模式，搭建可通过外网访问的内网服务器"></a>通过桥接模式，搭建可通过外网访问的内网服务器</h4><p><strong>步骤</strong></p><ol><li>在 kali 中安装 docker </li><li>docker pull 下载镜像</li><li>配置静态ip<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ifconfig 查看当前网卡</span><br><span class="line">service networking stop 停止当前网卡网络服务</span><br><span class="line">vi /etc/network/interfaces 对网卡配置进行修改</span><br><span class="line">进去之后，你会发现这个界面内容</span><br><span class="line">································</span><br><span class="line"># The loopback network interface</span><br><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line">auto eth0 网卡</span><br><span class="line">#iface eth0 inet dhcp</span><br><span class="line">iface eth0 inet static  启用静态ip</span><br><span class="line">address 192.168.31.108  设置ip地址</span><br><span class="line">netmask 255.255.255.0   子网掩码</span><br><span class="line">gateway 192.168.31.1    网关</span><br><span class="line">·······························</span><br><span class="line">ESC :wq!</span><br><span class="line">service networking restart 重启网络服务</span><br></pre></td></tr></table></figure>4.虚拟机本地访问127.0.0.1测试<br>5.改防火墙权限<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get install ufw</span><br><span class="line">关闭  ufw disable</span><br><span class="line">开启  ufw enable</span><br></pre></td></tr></table></figure>6.连接ssh，down源码<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ssh hostname@ip -p xxxx 端口指向</span><br><span class="line">进入www目录（举例）</span><br><span class="line">cd /var/www/html</span><br><span class="line">打包html</span><br><span class="line">tar -cvf html.tar html </span><br><span class="line">移动html.tar到html</span><br><span class="line">mv html.tar html</span><br><span class="line">删除</span><br><span class="line">rm -f  强行删除某个文件</span><br><span class="line">rm -r  向下递归，不管有多少级目录，一并删除</span><br><span class="line">rm -rf 将会删除目录以及其下所有文件、文件夹</span><br><span class="line">访问ip/html.tar即可下载</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Introduction to Penetration Testing</title>
      <link href="/2019/05/14/Introduction-to-Penetration-Testing/"/>
      <url>/2019/05/14/Introduction-to-Penetration-Testing/</url>
      
        <content type="html"><![CDATA[<h2 id="什么是渗透测试"><a href="#什么是渗透测试" class="headerlink" title="什么是渗透测试"></a>什么是渗透测试</h2><h3 id="基于百度搜索引擎得到的结果："><a href="#基于百度搜索引擎得到的结果：" class="headerlink" title="基于百度搜索引擎得到的结果："></a>基于百度搜索引擎得到的结果：</h3><p>渗透测试（Penetration Test）是一种黑盒安全测试方法，安全专家通过模拟真实黑客的技术手段对目标进行漏洞检测，突破系统的安全防护手段，深入评估漏洞所可能造成的实际影响。</p><h2 id="渗透测试与入侵的区别"><a href="#渗透测试与入侵的区别" class="headerlink" title="渗透测试与入侵的区别"></a>渗透测试与入侵的区别</h2><h3 id="渗透测试："><a href="#渗透测试：" class="headerlink" title="渗透测试："></a>渗透测试：</h3><p>以安全为基本原则，通过攻击者以及防御者的角度去分析目标所存在的安全隐患以及脆弱性，以保护系统安全为最终目标。</p><h3 id="入侵："><a href="#入侵：" class="headerlink" title="入侵："></a>入侵：</h3><p>通过各种方法，甚至破坏性的操作，来获取系统权限以及各种敏感信息。</p><h3 id="一般的渗透测试流程：-基于Freebuf"><a href="#一般的渗透测试流程：-基于Freebuf" class="headerlink" title="一般的渗透测试流程：(基于Freebuf)"></a>一般的渗透测试流程：(基于Freebuf)</h3><p>1.明确目标</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">确定范围：测试目标的范围、ip、域名、内外网、测试账户。</span><br><span class="line"></span><br><span class="line">确定规则：能渗透到什么程度，所需要的时间、能否修改上传、能否提权、等等。</span><br><span class="line"></span><br><span class="line">确定需求：web应用的漏洞、业务逻辑漏洞、人员权限管理漏洞、等等。</span><br></pre></td></tr></table></figure><p>2.信息收集</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">方式：主动扫描，开放搜索等。</span><br><span class="line"></span><br><span class="line">开放搜索：利用搜索引擎获得：后台、未授权页面、敏感url、等等。</span><br><span class="line"></span><br><span class="line">基础信息：IP、网段、域名、端口。</span><br><span class="line"></span><br><span class="line">应用信息：各端口的应用。例如web应用、邮件应用、等等。</span><br><span class="line"></span><br><span class="line">系统信息：操作系统版本</span><br><span class="line"></span><br><span class="line">版本信息：所有这些探测到的东西的版本。</span><br><span class="line"></span><br><span class="line">服务信息：中间件的各类信息，插件信息。</span><br><span class="line"></span><br><span class="line">人员信息：域名注册人员信息，web应用中发帖人的id，管理员姓名等。</span><br><span class="line"></span><br><span class="line">防护信息：试着看能否探测到防护设备。</span><br></pre></td></tr></table></figure><p>3.漏洞探测</p><p>利用上一步中列出的各种系统，应用等使用相应的漏洞。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">方法：</span><br><span class="line"></span><br><span class="line">(1)   漏扫，awvs，IBM appscan等。</span><br><span class="line"></span><br><span class="line">(2)   结合漏洞去exploit-db等位置找利用。</span><br><span class="line"></span><br><span class="line">(3)   在网上寻找验证poc。</span><br><span class="line"></span><br><span class="line">内容：</span><br><span class="line"></span><br><span class="line">系统漏洞：系统没有及时打补丁</span><br><span class="line"></span><br><span class="line">WebSever漏洞：WebSever配置问题</span><br><span class="line"></span><br><span class="line">Web应用漏洞：Web应用开发问题</span><br><span class="line"></span><br><span class="line">其它端口服务漏洞：各种21/8080(st2)/7001/22/3389</span><br><span class="line"></span><br><span class="line">通信安全：明文传输，token在cookie中传送等。</span><br></pre></td></tr></table></figure><p>4.漏洞验证</p><p>将上一步中发现的有可能可以成功利用的全部漏洞都验证一遍。结合实际情况，搭建模拟环境进行试验。成功后再应用于目标中。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">自动化验证：结合自动化扫描工具提供的结果</span><br><span class="line"></span><br><span class="line">手工验证，根据公开资源进行验证</span><br><span class="line"></span><br><span class="line">试验验证：自己搭建模拟环境进行验证</span><br><span class="line"></span><br><span class="line">登陆猜解：有时可以尝试猜解一下登陆口的账号密码等信息</span><br><span class="line"></span><br><span class="line">业务漏洞验证：如发现业务漏洞，要进行验证</span><br></pre></td></tr></table></figure><p>公开资源的利用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">exploit-db/wooyun/</span><br><span class="line"></span><br><span class="line">google hacking</span><br><span class="line"></span><br><span class="line">渗透代码网站</span><br><span class="line"></span><br><span class="line">通用、缺省口令</span><br><span class="line"></span><br><span class="line">厂商的漏洞警告等等。</span><br></pre></td></tr></table></figure><p>5.信息分析<br>为下一步实施渗透做准备。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">精准打击：准备好上一步探测到的漏洞的exp，用来精准打击</span><br><span class="line"></span><br><span class="line">绕过防御机制：是否有防火墙等设备，如何绕过</span><br><span class="line"></span><br><span class="line">定制攻击路径：最佳工具路径，根据薄弱入口，高内网权限位置，最终目标</span><br><span class="line"></span><br><span class="line">绕过检测机制：是否有检测机制，流量监控，杀毒软件，恶意代码检测等（免杀）</span><br><span class="line"></span><br><span class="line">攻击代码：经过试验得来的代码，包括不限于xss代码，sql注入语句等</span><br></pre></td></tr></table></figure><p>6.获取所需<br>实施攻击：根据前几步的结果，进行攻击</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">获取内部信息：基础设施（网络连接，vpn，路由，拓扑等）</span><br><span class="line"></span><br><span class="line">进一步渗透：内网入侵，敏感目标</span><br><span class="line"></span><br><span class="line">持续性存在：一般我们对客户做渗透不需要。rookit，后门，添加管理账号，驻扎手法等</span><br><span class="line"></span><br><span class="line">清理痕迹：清理相关日志（访问，操作），上传文件等</span><br></pre></td></tr></table></figure><p>7.信息整理</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">整理渗透工具：整理渗透过程中用到的代码，poc，exp等</span><br><span class="line"></span><br><span class="line">整理收集信息：整理渗透过程中收集到的一切信息</span><br><span class="line"></span><br><span class="line">整理漏洞信息：整理渗透过程中遇到的各种漏洞，各种脆弱位置信息</span><br></pre></td></tr></table></figure><p>8.形成报告</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">按需整理：按照之前第一步跟客户确定好的范围，需求来整理资料，并将资料形成报告</span><br><span class="line"></span><br><span class="line">补充介绍：要对漏洞成因，验证过程和带来危害进行分析</span><br><span class="line"></span><br><span class="line">修补建议：当然要对所有产生的问题提出合理高效安全的解决办法</span><br></pre></td></tr></table></figure><h3 id="学习规划-基于CnHacker"><a href="#学习规划-基于CnHacker" class="headerlink" title="学习规划: (基于CnHacker)"></a>学习规划: (基于CnHacker)</h3><p>基础：Web安全相关概念</p><blockquote><p>熟悉基本概念（SQL注入、上传、XSS、CSRF、一句话木马等）.</p></blockquote><blockquote><p>通过关键字（SQL注入、上传、XSS、CSRF、一句话木马等）进行Google&#x2F;SecWiki；</p></blockquote><blockquote><p>阅读《精通脚本黑客》，虽然很旧也有错误，但是入门还是可以的；</p></blockquote><blockquote><p>看一些渗透笔记&#x2F;视频，了解渗透实战的整个过程，可以Google（渗透笔记、渗透过程、入侵过程等）；</p></blockquote><p>3周<br>熟悉渗透相关工具</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">熟悉AWVS、sqlmap、Burp、nessus、chopper、nmap、Appscan等相关工具的使用。</span><br><span class="line">了解该类工具的用途和使用场景，先用软件名字Google/SecWiki；</span><br><span class="line">下载无后们版的这些软件进行安装；</span><br><span class="line">学习并进行使用，具体教材可以在SecWiki上搜索，例如：Brup的教程、sqlmap；</span><br><span class="line">待常用的这几个软件都学会了可以安装音速启动做一个渗透工具箱；</span><br></pre></td></tr></table></figure><p>5周<br>渗透实战操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">掌握渗透的整个阶段并能够独立渗透小型站点。</span><br><span class="line">网上找渗透视频看并思考其中的思路和原理，关键字（渗透、SQL注入视频、文件上传入侵、数据库备份、dedecms漏洞利用等等）；</span><br><span class="line">自己找站点/搭建测试环境进行测试，记住请隐藏好你自己；</span><br><span class="line">思考渗透主要分为几个阶段，每个阶段需要做那些工作，例如这个：PTES渗透测试执行标准；</span><br><span class="line">研究SQL注入的种类、注入原理、手动注入技巧；</span><br><span class="line">研究文件上传的原理，如何进行截断、双重后缀欺骗(IIS、PHP)、解析漏洞利用（IIS、Nignix、Apache）等，参照：上传攻击框架；</span><br><span class="line">研究XSS形成的原理和种类，具体学习方法可以Google/SecWiki，可以参考：XSS；</span><br><span class="line">研究Windows/Linux提权的方法和具体使用，可以参考：提权；</span><br><span class="line">可以参考: 开源渗透测试脆弱系统；</span><br></pre></td></tr></table></figure><p>1周<br>关注安全圈动态</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">关注安全圈的最新漏洞、安全事件与技术文章。</span><br><span class="line">通过SecWiki浏览每日的安全技术文章/事件；</span><br><span class="line">通过Weibo/twitter关注安全圈的从业人员（遇到大牛的关注或者好友果断关注），天天抽时间刷一下；</span><br><span class="line">通过feedly/鲜果订阅国内外安全技术博客（不要仅限于国内，平时多注意积累），没有订阅源的可以看一下SecWiki的聚合栏目；</span><br><span class="line">养成习惯，每天主动提交安全技术文章链接到SecWiki进行积淀；</span><br><span class="line">多关注下最新漏洞列表，推荐几个：exploit-db、CVE中文库、Wooyun等，遇到公开的漏洞都去实践下。</span><br><span class="line">关注国内国际上的安全会议的议题或者录像，推荐SecWiki-Conference。</span><br></pre></td></tr></table></figure><p>3周<br>熟悉Windows&#x2F;Kali Linux</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">学习Windows/Kali Linux基本命令、常用工具；</span><br><span class="line">熟悉Windows下的常用的cmd命令，例如：ipconfig,nslookup,tracert,net,tasklist,taskkill等；</span><br><span class="line">熟悉Linux下的常用命令，例如：ifconfig,ls,cp,mv,vi,wget,service,sudo等；</span><br><span class="line">熟悉Kali Linux系统下的常用工具，可以参考SecWiki,《Web Penetration Testing with Kali Linux》、《Hacking with Kali》等；</span><br><span class="line">熟悉metasploit工具，可以参考SecWiki、《Metasploit渗透测试指南》。</span><br></pre></td></tr></table></figure><p>3周<br>服务器安全配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">学习服务器环境配置，并能通过思考发现配置存在的安全问题。</span><br><span class="line">Windows2003/2008环境下的IIS配置，特别注意配置安全和运行权限，可以参考：SecWiki-配置；</span><br><span class="line">Linux环境下的LAMP的安全配置，主要考虑运行权限、跨目录、文件夹权限等，可以参考：SecWiki-配置；</span><br><span class="line">远程系统加固，限制用户名和口令登陆，通过iptables限制端口；</span><br><span class="line">配置软件Waf加强系统安全，在服务器配置mod_security等系统，参见SecWiki-ModSecurity；</span><br><span class="line">通过Nessus软件对配置环境进行安全检测，发现未知安全威胁。</span><br></pre></td></tr></table></figure><p>4周<br>脚本编程学习</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">选择脚本语言Perl/Python/PHP/Go/Java中的一种，对常用库进行编程学习。</span><br><span class="line">搭建开发环境和选择IDE，PHP环境推荐Wamp和XAMPP，IDE强烈推荐Sublime，一些Sublime的技巧：SecWiki-Sublime；</span><br><span class="line">Python编程学习，学习内容包含：语法、正则、文件、网络、多线程等常用库，推荐《Python核心编程》，不要看完；</span><br><span class="line">用Python编写漏洞的exp，然后写一个简单的网络爬虫，可参见SecWiki-爬虫、视频；</span><br><span class="line">PHP基本语法学习并书写一个简单的博客系统，参见《PHP与MySQL程序设计（第4版）》、视频；</span><br><span class="line">熟悉MVC架构，并试着学习一个PHP框架或者Python框架（可选）；</span><br><span class="line">了解Bootstrap的布局或者CSS，可以参考：SecWiki-Bootstrap;</span><br></pre></td></tr></table></figure><p>3周 源码审计与漏洞分析</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">能独立分析脚本源码程序并发现安全问题。</span><br><span class="line">熟悉源码审计的动态和静态方法，并知道如何去分析程序，参见SecWiki-审计；</span><br><span class="line">从Wooyun上寻找开源程序的漏洞进行分析并试着自己分析；</span><br><span class="line">了解Web漏洞的形成原因，然后通过关键字进行查找分析，参见SecWiki-代码审计、高级PHP应用程序漏洞审核技术；</span><br><span class="line">研究Web漏洞形成原理和如何从源码层面避免该类漏洞，并整理成checklist。</span><br></pre></td></tr></table></figure><p>5周<br>安全体系设计与开发</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">能建立自己的安全体系，并能提出一些安全建议或者系统架构。</span><br><span class="line">开发一些实用的安全小工具并开源，体现个人实力；</span><br><span class="line">建立自己的安全体系，对公司安全有自己的一些认识和见解；</span><br><span class="line">提出或者加入大型安全系统的架构或者开发；</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCC 2019-MISC</title>
      <link href="/2019/05/14/ISCC2019-MISC/"/>
      <url>/2019/05/14/ISCC2019-MISC/</url>
      
        <content type="html"><![CDATA[<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>进制——&gt;ASCII——&gt;base64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;0126 062 0126 0163 0142 0103 0102 0153 0142 062 065 0154 0111 0121 0157 0113 0111 0105 0132 0163 0131 0127 0143 066 0111 0105 0154 0124 0121 060 0116 067 0124 0152 0102 0146 0115 0107 065 0154 0130 062 0116 0150 0142 0154 071 0172 0144 0104 0102 0167 0130 063 0153 0167 0144 0130 060 0113&#x27;</span></span><br><span class="line">tmp = <span class="built_in">str</span>.split( )</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tmp:</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(i, <span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(flag))</span><br></pre></td></tr></table></figure><h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>StegSolve——&gt;data analyze——&gt;字符颠倒<br><a href="https://i.loli.net/2019/05/06/5ccfd01f95d4e.png" title="倒立屋"><img src="https://i.loli.net/2019/05/06/5ccfd01f95d4e.png" alt="倒立屋" title="倒立屋"></a><br>将图片在Steg中数据分析调至最低位，会发现第一行有一串很像flag的字符，尝试提交报错，更改格式报错，再结合题目，倒立屋，尝试将字符串颠倒过来提交，即按从右往左的顺序，发现对了（这道题的flag有点东西）</p><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>提取——&gt;联想——&gt;比划<br>在附件中我们发现有{}，不难猜到肯定是flag，我们进行提取得到</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;WSXIUYHNBVTRFVBTRFVBQWERTYQAZSCEWSXCDEEFVTYHNMKJTGBNMJUYGRDXCVBMNBVCDRTGHUWSXCFEQWERTYTRFVBWSXNBVCXSWERFRFVGYHNWSXCDEMNBVCDRTGHU&#125;</span><br></pre></td></tr></table></figure><p>这么长一串，但是看起来又不像加密过的，回到原题“Keyes’ secret”，联想一下,key会不会是keyboard,再观察提取的字符，突然发现这些字母连起来在键盘上画出来是会是其他的字母形状，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">WSX----------------------I</span><br><span class="line">IUYHNBV---------------S</span><br><span class="line">TRFVB------------------C</span><br><span class="line">QAZSEC----------------K</span><br><span class="line">WSXCDE---------------E</span><br><span class="line">EFVT---------------------Y</span><br><span class="line">YHNMKJ----------------B</span><br><span class="line">TGBNMJU--------------O</span><br><span class="line">GRDXCVB--------------A</span><br><span class="line">MNBVCDRTGHU-----R</span><br><span class="line">WSXCFE----------------D</span><br><span class="line">NBVCXSWERF--------P</span><br><span class="line">RFVGYHN--------------H</span><br><span class="line">MNBVCDRTGHU-----R</span><br></pre></td></tr></table></figure><p>以上就是键盘中的秘密</p><h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><p>题目——&gt;winhex——&gt;AES+key解密<br>观察题目有三个比较敏感的字母AES，不难猜到这道题是AES解码，既然解码就要找到密文，故我们将GIF动图放到winhex中，发现最低端有一行特立独行的密文，<a href="https://i.loli.net/2019/05/06/5ccfd67f8f4a4.png" title="winhex"><img src="https://i.loli.net/2019/05/06/5ccfd67f8f4a4.png" alt="winhex" title="winhex"></a><br>进行解码，发现需要提供key,猜想这是什么比赛，哦,ISCC，尝试设置为ISCC，解码，<br><a href="https://i.loli.net/2019/05/06/5ccfd6b00c2cb.png" title="AES"><img src="https://i.loli.net/2019/05/06/5ccfd6b00c2cb.png" alt="AES" title="AES"></a>发现成功了，再次进行解码，得到flag</p><h3 id="5"><a href="#5" class="headerlink" title="5"></a>5</h3><p>binwalk——&gt;python3<br>用过很多信息隐藏提取的工具都没有用，经过尝试，发现binwalk可以将此图分离<br><a href="https://i.loli.net/2019/05/06/5cd035b040d11.png" title="binwalk"><img src="https://i.loli.net/2019/05/06/5cd035b040d11.png" alt="binwalk" title="binwalk"></a><br>得到10个碎片图<br>并且得到一张说明提示</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">纸机中居然是一堆黑色和白色的碎片，但是这些碎片之中到底会有什么样的宝藏呢？</span><br><span class="line"></span><br><span class="line">我去问了欧鹏·曦文同学，他说他有办法恢复拼图原貌，但是前提是要我把真正有用的东西给他。</span><br></pre></td></tr></table></figure><p>附脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">flag_pic = Image.new(<span class="string">&quot;RGBA&quot;</span>,(<span class="number">143</span>,<span class="number">50</span>),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> fn <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">11</span>):  <span class="comment">#循环出现文件名的后缀数字</span></span><br><span class="line"></span><br><span class="line">    fp=<span class="built_in">open</span>(<span class="string">r&#x27;/root/文档/CTF/fsj/fsj2/puzzle&#x27;</span>+<span class="built_in">str</span>(fn)+<span class="string">&#x27;.jpg&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)  <span class="comment">#此处为文件路径及文件名</span></span><br><span class="line"></span><br><span class="line">    all_data=<span class="built_in">bytearray</span>(fp.read())</span><br><span class="line"></span><br><span class="line">    data=all_data[-<span class="number">1250</span>:]                           <span class="comment">#读图片最后1250位</span></span><br><span class="line"></span><br><span class="line">    pic = Image.new(<span class="string">&quot;RGBA&quot;</span>,(<span class="number">50</span>,<span class="number">50</span>),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))   <span class="comment">#新建图像对象,RGBA通道,xy轴为50,颜色为white(255,255,255)</span></span><br><span class="line"></span><br><span class="line">    dex=<span class="number">0</span>                                           <span class="comment">#初始化标记位为0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">25</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">25</span>):                       <span class="comment">#两层循环,写入图片上半部分颜色</span></span><br><span class="line"></span><br><span class="line">            pic.putpixel((j,i),(<span class="number">255</span>-data[dex],<span class="number">255</span>-data[dex],<span class="number">255</span>-data[dex])) <span class="comment">#设置坐标(j,i) 颜色为(255-data[dex],255-data[dex],255-data[dex])</span></span><br><span class="line"></span><br><span class="line">            dex=dex+<span class="number">1</span>                                                       <span class="comment">#标记位+1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">25</span>):                       <span class="comment">#两层循环,写入图片下半部分颜色</span></span><br><span class="line"></span><br><span class="line">            pic.putpixel((j,i+<span class="number">25</span>),(<span class="number">255</span>-data[dex],<span class="number">255</span>-data[dex],<span class="number">255</span>-data[dex]))  <span class="comment">#设置坐标(j,i+25) RGB值同上</span></span><br><span class="line"></span><br><span class="line">            dex=dex+<span class="number">1</span>                                                       <span class="comment">#标记位+1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">50</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">13</span>,<span class="number">1</span>):</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> pic.getpixel((x,y)) &lt; pic.getpixel((x+<span class="number">13</span>,y)):    <span class="comment">#若x轴0~12的像素值 小于 13~25的值,则写入 0~12的像素值</span></span><br><span class="line"></span><br><span class="line">                flag_pic.putpixel((x+fn*<span class="number">13</span>,y),pic.getpixel((x,y)))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:                                               <span class="comment">#否则写入后 13~25的像素值</span></span><br><span class="line"></span><br><span class="line">                flag_pic.putpixel((x+fn*<span class="number">13</span>,y),pic.getpixel((x+<span class="number">13</span>,y)))</span><br><span class="line"></span><br><span class="line">flag_pic.show()</span><br></pre></td></tr></table></figure><p>得出<br><a href="https://i.loli.net/2019/05/06/5cd03841efaf8.png" title="欧鹏·曦文"><img src="https://i.loli.net/2019/05/06/5cd03841efaf8.png" alt="欧鹏·曦文" title="欧鹏·曦文"></a></p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Troubleshooting Docker Installation on Kali Linux</title>
      <link href="/2019/05/14/Troubleshooting-Docker-Installation-on-Kali-Linux/"/>
      <url>/2019/05/14/Troubleshooting-Docker-Installation-on-Kali-Linux/</url>
      
        <content type="html"><![CDATA[<p>Kali安装docker:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D</span><br><span class="line">echo &#x27;deb https://apt.dockerproject.org/repo debian-stretch main&#x27; &gt; /etc/apt/sources.list.d/docker.list</span><br><span class="line">apt-get install apt-transport-https ca-certificates</span><br><span class="line">apt-get update &amp;&amp; sudo apt-get install docker-engine</span><br><span class="line">systemctl start docker</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>使用加速器加快镜像的下载</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi  /etc/docker/daemon.json</span><br><span class="line">输入一下内容即可</span><br><span class="line">&#123;&quot;registry-mirrors&quot;:[&quot;https://registry.docker-cn.com&quot;]&#125;</span><br></pre></td></tr></table></figure><h3 id="Error"><a href="#Error" class="headerlink" title="Error:"></a>Error:</h3><p>如果用完docker未通过正确方式关闭，导致下次docker无法开启，那么解决方案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /var/lib/docker/</span><br><span class="line">vim /etc/docker/daemon.json</span><br><span class="line">add：</span><br><span class="line"> &#123; &quot;graph&quot;: &quot;/mnt/docker-data&quot;, &quot;storage-driver&quot;: &quot;overlay&quot; &#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Issues </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Detailed Discussion on information_schema</title>
      <link href="/2019/01/22/Detailed-Discussion-on-information_schema/"/>
      <url>/2019/01/22/Detailed-Discussion-on-information_schema/</url>
      
        <content type="html"><![CDATA[<p>information_schema数据库是MySQL系统自带的数据库，它提供了数据库元数据的访问方式。</p><h1 id="1：关于字符集和排序规则相关的系统表"><a href="#1：关于字符集和排序规则相关的系统表" class="headerlink" title="1：关于字符集和排序规则相关的系统表"></a>1：关于字符集和排序规则相关的系统表</h1><p>CHARACTER_SETS ：存储数据库相关字符集信息（memory存储引擎）</p><p>COLLATIONS ：字符集对应的排序规则</p><p>COLLATION_CHARACTER_SET_APPLICABILITY：就是一个字符集和连线校对的一个对应关系而已</p><p>下面我们说一下character sets和collations的区别：</p><p>字符集（character sets）存储字符串，是指人类语言中最小的表义符号。例如’A’、’B’等；</p><p>排序规则（collations）规则比较字符串，collations是指在同一字符集内字符之间的比较规则</p><p>每个字符序唯一对应一种字符集，但一个字符集可以对应多种字符序，其中有一个是默认字符序(Default Collation)</p><p> MySQL中的字符序名称遵从命名惯例：以字符序对应的字符集名称开头；以_ci(表示大小写不敏感)、_cs(表示大小写敏感)或_bin(表示按编码值比较)结尾。例如：在字符序“utf8_general_ci”下，字符“a”和“A”是等价的</p><p>看一下有关于字符集和校对相关的MySQL变量：</p><p>character_set_server：默认的内部操作字符集</p><p>character_set_client：客户端来源数据使用的字符集</p><p>character_set_connection：连接层字符集</p><p>character_set_results：查询结果字符集</p><p>character_set_database：当前选中数据库的默认字符集</p><p>character_set_system：系统元数据(字段名等)字符集</p><p>再看一下MySQL中的字符集转换过程：</p><p>（1）. MySQL Server收到请求时将请求数据从character_set_client转换为character_set_connection；</p><p>（2）. 进行内部操作前将请求数据从character_set_connection转换为内部操作字符集，其确定方法如下：</p><p>使用每个数据字段的CHARACTER SET设定值；</p><p>若上述值不存在，则使用对应数据表的DEFAULT CHARACTER SET设定值(MySQL扩展，非SQL标准)；</p><p>若上述值不存在，则使用对应数据库的DEFAULT CHARACTER SET设定值；</p><p>若上述值不存在，则使用character_set_server设定值。</p><p>（3）. 将操作结果从内部操作字符集转换为character_set_results。</p><h1 id="2：权限相关的一些表："><a href="#2：权限相关的一些表：" class="headerlink" title="2：权限相关的一些表："></a>2：权限相关的一些表：</h1><p>SCHEMA_PRIVILEGES：提供了数据库的相关权限，这个表是内存表是从mysql.db中拉去出来的。</p><p>TABLE_PRIVILEGES:提供的是表权限相关信息，信息是从 mysql.tables_priv 表中加载的</p><p>COLUMN_PRIVILEGES ：这个表可以清楚就能看到表授权的用户的对象，那张表那个库以及授予的是什么权限，如果授权的时候加上with grant option的话，我们可以看得到PRIVILEGE_TYPE这个值必须是YES。</p><p>USER_PRIVILEGES:提供的是表权限相关信息，信息是从 mysql.user 表中加载的</p><p>通过表我们可以很清晰看得到MySQL授权的层次，SCHEMA，TABLE，COLUMN级别，当然这些都是基于用户来授予的。可以看得到MySQL的授权也是相当的细密的，可以具体到列，这在某一些应用场景下还是很有用的，比如审计等。</p><h1 id="3：存储数据库系统的实体对象的一些表："><a href="#3：存储数据库系统的实体对象的一些表：" class="headerlink" title="3：存储数据库系统的实体对象的一些表："></a>3：存储数据库系统的实体对象的一些表：</h1><p>COLUMNS：存储表的字段信息，所有的存储引擎</p><p>INNODB_SYS_COLUMNS ：存放的是INNODB的元数据， 他是依赖于SYS_COLUMNS这个统计表而存在的。</p><p>ENGINES ：引擎类型，是否支持这个引擎，描述，是否支持事物，是否支持分布式事务，是否能够支持事物的回滚点</p><p>EVENTS ：记录MySQL中的事件，类似于定时作业</p><p>FILES ：这张表提供了有关在MySQL的表空间中的数据存储的文件的信息，文件存储的位置，这个表的数据是从InnoDB in-memory中拉取出来的，所以说这张表本身也是一个内存表，每次重启重新进行拉取。也就是我们下面要说的INNODB_SYS_DATAFILES这张表。还要注意一点的是这张表包含有临时表的信息，所以说和SYS_DATAFILES 这张表是不能够对等的，还是要从INNODB_SYS_DATAFILES看。如果undo表空间也配置是InnoDB 的话，那么也是会被记录下来的。</p><p>PARAMETERS ：参数表存储了一些存储过程和方法的参数，以及存储过程的返回值信息。存储和方法在ROUTINES里面存储。</p><p>PLUGINS ：基本上是MySQL的插件信息，是否是活动状态等信息。其实SHOW PLUGINS本身就是通过这张表来拉取道德数据</p><p>ROUTINES：关于存储过程和方法function的一些信息，不过这个信息是不包括用户自定义的，只是系统的一些信息。</p><p>SCHEMATA：这个表提供了实例下有多少个数据库，而且还有数据库默认的字符集</p><p>TRIGGERS :这个表记录的就是触发器的信息，包括所有的相关的信息。系统的和自己用户创建的触发器。</p><p>VIEWS :视图的信息，也是系统的和用户的基本视图信息。</p><p>这些表存储的都是一些数据库的实体对象，方便我们进行查询和管理，对于一个DBA来说，这些表能够大大方便我们的工作，更快更方便的了结和查询数据库的相关信息。</p><h1 id="4：约束外键等相关的一些表："><a href="#4：约束外键等相关的一些表：" class="headerlink" title="4：约束外键等相关的一些表："></a>4：约束外键等相关的一些表：</h1><p>REFERENTIAL_CONSTRAINTS：这个表提供的外键相关的信息，而且只提供外键相关信息</p><p>TABLE_CONSTRAINTS ：这个表提供的是 相关的约束信息</p><p>INNODB_SYS_FOREIGN_COLS ：这个表也是存储的INNODB关于外键的元数据信息和SYS_FOREIGN_COLS 存储的信息是一致的</p><p>INNODB_SYS_FOREIGN ：存储的INNODB关于外键的元数据信息和SYS_FOREIGN_COLS 存储的信息是一致的，只不过是单独对于INNODB来说的</p><p>KEY_COLUMN_USAGE：数据库中所有有约束的列都会存下下来，也会记录下约束的名字和类别</p><p>为什么要把外键和约束单列出来呢，因为感觉这是一块独立的东西，虽然我们的生产环境大部分都不会使用外键，因为这会降低性能，但是合理的利用约束还是一个不错的选择，比如唯一约束。</p><h1 id="5：关于管理的一些的一些表："><a href="#5：关于管理的一些的一些表：" class="headerlink" title="5：关于管理的一些的一些表："></a>5：关于管理的一些的一些表：</h1><p>GLOBAL_STATUS ，GLOBAL_VARIABLES，SESSION_STATUS，SESSION_VARIABLES：这四张表分别记录了系统的变量，状态（全局和会话的信息），作为DBA相信大家也都比较熟悉了，而且这几张表也是在系统重启的时候回重新加载的。也就是内存表。</p><p>PARTITIONS ：MySQL分区表相关的信息，通过这张表我们可以查询到分区的相关信息（数据库中已分区的表，以及分区表的分区和每个分区的数据信息）</p><p>PROCESSLIST：show processlist其实就是从这个表拉取数据，PROCESSLIST的数据是他的基础。由于是一个内存表，所以我们相当于在内存中查询一样，这些操作都是很快的。</p><p>INNODB_CMP_PER_INDEX，INNODB_CMP_PER_INDEX_RESET：这两个表存储的是关于压缩INNODB信息表的时候的相关信息,有关整个表和索引信息都有.我们知道对于一个INNODB压缩表来说,不管是数据还是二级索引都是会被压缩的,因为数据本身也可以看作是一个聚集索引。</p><p>INNODB_CMPMEM ，INNODB_CMPMEM_RESET：这两个表是存放关于MySQL INNODB的压缩页的buffer pool信息，但是要注意一点的就是,用这两个表来收集所有信息的表的时候,是会对性能造成严重的影响的,所以说默认是关闭状态的。如果要打开这个功能的话我们要设置innodb_cmp_per_index_enabled参数为ON状态。</p><p>INNODB_BUFFER_POOL_STATS ：表提供有关INNODB 的buffer pool相关信息，和show engine innodb status提供的信息是相同的。也是show engine innodb status的信息来源。</p><p>INNODB_BUFFER_PAGE_LRU，INNODB_BUFFER_PAGE :维护了INNODB LRU LIST的相关信息</p><p>INNODB_BUFFER_PAGE ：这个表就比较屌了，存的是buffer里面缓冲的页数据。查询这个表会对性能产生很严重的影响，千万不要再我们自己的生产库上面执行这个语句，除非你能接受服务短暂的停顿</p><p>INNODB_SYS_DATAFILES ：这张表就是记录的表的文件存储的位置和表空间的一个对应关系(INNODB)</p><p>INNODB_TEMP_TABLE_INFO ：这个表惠记录所有的INNODB的所有用户使用到的信息，但是只能记录在内存中和没有持久化的信息。</p><p>INNODB_METRICS ：提供INNODB的各种的性能指数，是对INFORMATION_SCHEMA的补充，收集的是MySQL的系统统计信息。这些统计信息都是可以手动配置打开还是关闭的。有以下参数都是可以控制的：innodb_monitor_enable, innodb_monitor_disable, innodb_monitor_reset, innodb_monitor_reset_all。</p><p>INNODB_SYS_VIRTUAL :表存储的是INNODB表的虚拟列的信息，当然这个还是比较简单的，在MySQL 5.7中，支持两种Generated Column，即Virtual Generated Column和Stored Generated Column，前者只将Generated Column保存在数据字典中（表的元数据），并不会将这一列数据持久化到磁盘上；后者会将Generated Column持久化到磁盘上，而不是每次读取的时候计算所得。很明显，后者存放了可以通过已有数据计算而得的数据，需要更多的磁盘空间，与实际存储一列数据相比并没有优势，因此，MySQL 5.7中，不指定Generated Column的类型，默认是Virtual Column。</p><p>INNODB_CMP，INNODB_CMP_RESET：存储的是关于压缩INNODB信息表的时候的相关信息，详细请见推荐笔记。</p><p>为什么把这些表列为管理相关的表呢，因为我感觉像连接，分区，压缩表，innodb buffer pool等表，我们通过这些表都能很清晰的看到自己数据库的相关功能的状态，特别是我们通过一些变量更容易窥透MySQL的运行状态，方便我们进行管理。</p><h1 id="6：关于表信息和索引信息的一些表"><a href="#6：关于表信息和索引信息的一些表" class="headerlink" title="6：关于表信息和索引信息的一些表"></a>6：关于表信息和索引信息的一些表</h1><p>TABLES，TABLESPACES，INNODB_SYS_TABLES ，INNODB_SYS_TABLESPACES ：</p><p>TABLES这张表毫无疑问了，就是记录的数据库中表的信息，其中包括系统数据库和用户创建的数据库。show table status like ‘test1’\G的来源就是这个表；</p><p>TABLESPACES 却是标注的活跃表空间。 这个表是不提供关于innodb的表空间信息的，对于我们来说并没有太大作用，因为我们生产库是强制INNODB的；</p><p>INNODB_SYS_TABLES 这张表依赖的是SYS_TABLES数据字典中拉取出来的。此表提供了有关表格的格式和存储特性，包括行格式，压缩页面大小位级别的信息（如适用）</p><p>提供的是关于INNODB的表空间信息，其实和SYS_TABLESPACES 中的INNODB信息是一致的。</p><p>STATISTICS：这个表提供的是关于表的索引信息，所有索引的相关信息。</p><p>INNODB_SYS_INDEXES：提供相关INNODB表的索引的相关信息，和SYS_INDEXES 这个表存储的信息基本是一样的，只不过后者提供的是所有存储引擎的索引信息，后者只提供INNODB表的索引信息。</p><p>INNODB_SYS_TABLESTATS：</p><p>这个表就比较重要了，记录的是MySQL的INNODB表信息以及MySQL优化器会预估SQL选择合适的索引信息，其实就是MySQL数据库的统计信息</p><p>这个表的记录是记录在内存当中的，是一个内存表，每次重启后就会重新记录，所以只能记录从上次重启后的数据库统计信息。有了这个表，我们对于索引的维护就更加方便了，我们可以查询索引的使用次数，方便清理删除不常用的索引，提高表的更新插入等效率，节省磁盘空间。</p><p>INNODB_SYS_FIELDS ：这个表记录的是INNODB的表索引字段信息，以及字段的排名</p><p>INNODB_FT_CONFIG :这张表存的是全文索引的信息</p><p>INNODB_FT_DEFAULT_STOPWORD：这个表存放的是stopword 的信息,是和全文索引匹配起来使用的，和innodb的 INFORMATION_SCHEMA.INNODB_FT_DEFAULT_STOPWORD 是相同的，这个STOPWORD必须是在创建索引之前创建，而且必须指定字段为varchar。stopword 也就是我们所说的停止词，全文检索时，停止词列表将会被读取和检索，在不同的字符集和排序方式下，会造成命中失败或者找不到此数据，这取决于停止词的不同的排序方式。我们可以使用这个功能筛选不必要字段。</p><p>INNODB_FT_INDEX_TABLE：这个表存储的是关于INNODB表有全文索引的索引使用信息的，同样这个表也是要设置innodb_ft_aux_table以后才能够使用的，一般情况下是空的</p><p>INNODB_FT_INDEX_CACHE ：这张表存放的是插入前的记录信息，也是为了避免DML时候昂贵的索引重组</p><h1 id="7：关于MySQL优化相关的一些表"><a href="#7：关于MySQL优化相关的一些表" class="headerlink" title="7：关于MySQL优化相关的一些表"></a>7：关于MySQL优化相关的一些表</h1><p>OPTIMIZER_TRACE ：提供的是优化跟踪功能产生的信息.</p><p>PROFILING：SHOW PROFILE可以深入的查看服务器执行语句的工作情况。以及也能帮助你理解执行语句消耗时间的情况。一些限制是它没有实现的功能，不能查看和剖析其他连接的语句，以及剖析时所引起的消耗。</p><p>SHOW PROFILES显示最近发给服务器的多条语句，条数根据会话变量profiling_history_size定义，默认是15，最大值为100。设为0等价于关闭分析功能。详细信息请见MySQL profile</p><p>INNODB_FT_BEING_DELETED,INNODB_FT_DELETED: INNODB_FT_BEING_DELETED 这张表是INNODB_FT_DELETED的一个快照,只在OPTIMIZE TABLE 的时候才会使用。</p><h1 id="8：关于MySQL事物和锁的相关的一些表"><a href="#8：关于MySQL事物和锁的相关的一些表" class="headerlink" title="8：关于MySQL事物和锁的相关的一些表"></a>8：关于MySQL事物和锁的相关的一些表</h1><p>INNODB_LOCKS:现在获取的锁，但是不含没有获取的锁，而且只是针对INNODB的。</p><p>INNODB_LOCK_WAITS：系统锁等待相关信息，包含了阻塞的一行或者多行的记录，而且还有锁请求和被阻塞改请求的锁信息等。</p><p>INNODB_TRX：包含了所有正在执行的的事物相关信息（INNODB），而且包含了事物是否被阻塞或者请求锁。</p><p>我们通过这些表就能够很方便的查询出来未结束的事物和被阻塞的进程</p>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
